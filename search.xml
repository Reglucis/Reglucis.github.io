<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>è´å¶æ–¯æ»¤æ³¢å™¨ç³»åˆ—(5) - ä¸€ç»´å¡å°”æ›¼æ»¤æ³¢</title>
      <link href="/2025/09/01/2_3.1-D%20Kalman%20FIlter/"/>
      <url>/2025/09/01/2_3.1-D%20Kalman%20FIlter/</url>
      
        <content type="html"><![CDATA[<h1 id="kalman-filter">Kalman Filter</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># %matplotlib widget</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> MyFilter.FilterPerformance <span class="keyword">as</span> FP</span><br><span class="line"><span class="keyword">import</span> MyFilter.UserLib <span class="keyword">as</span> UserLib</span><br><span class="line"><span class="keyword">import</span> MyFilter.BayesFilter <span class="keyword">as</span> BayesFilter</span><br><span class="line"></span><br><span class="line">figsize=(<span class="number">25</span>, <span class="number">5</span>)</span><br></pre></td></tr></table></figure><h2 id="å¼•è¨€">1 å¼•è¨€</h2><p>The game is on.</p><p>æœ€å¼€å§‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨ä¸Šä¸€æ—¶åˆ»çš„ä¿¡æ¯ä½œä¸ºæœ¬æ—¶åˆ»çš„å…ˆéªŒä¿¡æ¯(MA);å†åæ¥æˆ‘ä»¬å°†ä¸Šä¸€æ—¶åˆ»çš„ä¿¡æ¯é€šè¿‡æ¨¡å‹é¢„æµ‹å‡ºæœ¬æ—¶åˆ»çš„ä¿¡æ¯ï¼Œè¿›è€Œä½¿ç”¨é¢„æµ‹ä¸æµ‹é‡çš„æ®‹å·®æ¥å¯¹æ¨¡å‹è¿›è¡Œæ›´æ–°ã€‚æ€»ä¹‹ï¼Œæˆ‘ä»¬ä½¿ç”¨å„ç§å„æ ·çš„çš„æ–¹æ³•æ¥å°½å¯èƒ½æå–æµ‹é‡çš„å…¨éƒ¨ä¿¡æ¯ã€‚<br />ä½†è¿™é‡Œå…¶å®æœ‰ä¸ªé—®é¢˜ï¼Œåœ¨é¢„æµ‹/è§‚æµ‹æ—¶è·å¾—çš„ä¿¡æ¯æˆ‘ä»¬éƒ½è®¤ä¸ºå…¶æ˜¯ä¸€ä¸ªä¸€èˆ¬å˜é‡ï¼Œè€Œééšæœºå˜é‡ã€‚è¿™ç§æ–¹æ³•å…¶å®ä¸¢æ‰äº†ä¸€äº›ä¿¡æ¯(æ–¹å·®)ï¼Œè€Œå¡å°”æ›¼æ»¤æ³¢å™¨åˆ™å°†è¿™äº›ä¿¡æ¯è€ƒè™‘äº†è¿›æ¥ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é‡‡æ ·å‚æ•°</span></span><br><span class="line">SampleFre = <span class="number">10</span></span><br><span class="line">TotalTime = <span class="number">10</span>          <span class="comment"># é‡‡æ ·æ—¶é—´ ä¸æ¨èå¤§äº10, å¢åŠ ç‚¹æ•°è¯·å¢å¤§é‡‡æ ·ç‡</span></span><br><span class="line">Step = <span class="number">1</span>/SampleFre</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹å‚æ•°</span></span><br><span class="line">Model_accel = <span class="number">3</span></span><br><span class="line">Model_initialSpeed = <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### ä»¿çœŸ ###</span></span><br><span class="line">ModelValue, ActualValue, MeasureValue = UserLib.Model.Generative(Step, TotalTime, <span class="keyword">lambda</span> x: Model_accel * x + Model_initialSpeed)</span><br></pre></td></tr></table></figure><h2 id="éšæœºæ¨¡å‹">éšæœºæ¨¡å‹</h2><h3 id="é¢„æµ‹æ¨¡å‹">é¢„æµ‹æ¨¡å‹</h3><p>åœ¨ g-h filter ä¸­æˆ‘ä»¬æ‰€ä½¿ç”¨çš„æ¨¡å‹ä¸º</p><blockquote><p><span class="math display">$$\begin{align}   \nonumber    v_{n+1} &amp;= v_{n} + \Delta t \dot{v}_{n} \\   \nonumber    \dot{v}_{n} &amp;= \dot{v}_{n}\end{align}$$</span></p></blockquote><p>ä½†æˆ‘ä»¬åœ¨ç¬¬ä¸€èŠ‚çš„å†…å®¹ä¸­å°±å·²ç»çŸ¥é“äº†ï¼Œç”±äºå¤šç§å› ç´ çš„å½±å“ï¼Œå…¶åŠ é€Ÿåº¦çš„å™ªå£°åˆ†å¸ƒw (white)æ˜¯æ ‡å‡†æ­£æ€åˆ†å¸ƒ <spanclass="math inline"><em>Ï•</em>â€„âˆ¼â€„<em>N</em>(0,1)</span> çš„ <spanclass="math inline"><em>Î³</em></span> å€ã€‚æ‰€ä»¥æ›´å‡†ç¡®çš„å†™æ³•åº”è¯¥æ˜¯</p><p>$$ \end{align} $$</p><blockquote><p>å¼ä¸­ç¬¦å· <spanclass="math inline"><em>vÌ‡</em><sub><em>n</em>â€…+â€…1,â€†<em>n</em></sub></span>è¡¨ç¤ºåœ¨ <span class="math inline"><em>n</em></span> æ—¶åˆ»å¯¹ <spanclass="math inline"><em>n</em>â€…+â€…1</span> æ—¶åˆ»é€Ÿåº¦å¯¼æ•°çš„ä¼°è®¡ã€‚</p></blockquote><p>å¾ˆç›´è§‚å¯¹å§ï¼Œå› ä¸ºæˆ‘ä»¬åªå¯¹ç»“æœè¿›è¡Œé¢„æµ‹ï¼Œä½†æ¨¡å‹çš„ä¸ç²¾ç¡®(æ—¢åŒ…æ‹¬å»ºæ¨¡æ—¶çš„ä¸ç²¾ç¡®åˆåŒ…å«è¿‡ç¨‹å™ªå£°)å¿…ç„¶ä¼šä½¿é¢„æµ‹ç»“æœå‡†ç¡®æ€§ä¸‹é™ã€‚éšç€æ—¶é—´æ¨ç§»ï¼Œè¿™ç§ä¸ç¡®å®šæ€§è¶Šæ¥è¶Šå¤§ï¼Œæœ€ç»ˆä½¿é¢„æµ‹ç»“æœå½»åº•å‘æ•£ã€‚</p><p>å°†ä¸Šè¿°è¿‡ç¨‹çš„é€’æ¨å¼å†™å‡º <span class="math display">$$\begin{align}    &amp;\left\{ \begin{matrix}        \begin{align}            \nonumber    \hat{\dot{v}}_{n+1, n} &amp;= \hat{\dot{v}}_{n,n}\\              \nonumber    {^a} \sigma^2_{n+1, n} &amp;= {^a} \sigma^2_{n,n} + \gamma^2        \end{align}    \end{matrix} \right.    \\    &amp;\left\{ \begin{matrix}        \begin{align}            \nonumber    \hat{v}_{n+1, n} &amp;= \hat{v}_{n, n} + \Deltat \hat{\dot{v}}_{n,n}\\              \nonumber    {^v} \sigma^2_{n+1, n} &amp;= {^v} \sigma^2_{n,n} + \Delta t^2  ({^a} \sigma^2_{n, n})^2        \end{align}    \end{matrix} \right.\end{align}$$</span></p><blockquote><p>å¼ä¸­ç¬¦å· <spanclass="math inline"><sup><em>a</em></sup><em>Ïƒ</em><sub><em>n</em>â€…+â€…1,â€†<em>n</em></sub><sup>2</sup></span>è¡¨ç¤ºåœ¨ <span class="math inline"><em>n</em></span> æ—¶åˆ»å¯¹ <spanclass="math inline"><em>n</em>â€…+â€…1</span> æ—¶åˆ»çš„åŠ é€Ÿåº¦æ–¹å·®çš„ä¼°è®¡ã€‚</p></blockquote><h3 id="æ›´æ–°æ¨¡å‹">æ›´æ–°æ¨¡å‹</h3><p>åˆšåˆšå·²ç»åˆ†æè¿‡äº†ï¼Œé¢„æµ‹æ˜¯ä¸å‡†ç¡®çš„ï¼Œæœ€ç»ˆä¼šä½¿å¯¼è‡´ç³»ç»ŸçŠ¶æ€çš„å‘æ•£ã€‚æ‰€ä»¥éœ€è¦è§‚æµ‹ï¼Œè§‚æµ‹ä½¿æ–°æ¯è¿›å…¥ç³»ç»Ÿï¼Œä»è€Œä½¿ç³»ç»Ÿçš„æ–¹å·®å‡å°ï¼Œä¿æŒæ”¶æ•›ã€‚<br />å¯¹è§‚æµ‹å»ºæ¨¡å¦‚ä¸‹ <spanclass="math display"><em>z</em><sub><em>n</em></sub>â€„=â€„<em>h</em><em>x</em><sub><em>n</em></sub>â€…+â€…<em>r</em></span></p><blockquote><p>è¿™é‡Œæ˜¯è¾ƒä¸€èˆ¬çš„å†™æ³•ï¼Œ<spanclass="math inline"><em>h</em></span>æ˜¯ç³»æ•°ï¼Œ<spanclass="math inline"><em>r</em></span>æ˜¯æŸç§é«˜æ–¯å™ªå£°ã€‚(æ¯”å¦‚ï¼Œé€šè¿‡è§‚æµ‹é‡‡æ ·ç”µé˜»(<spanclass="math inline"><em>h</em></span>)çš„ç”µå‹(<spanclass="math inline"><em>z</em></span>)å¾—åˆ°ç”µæµ(<spanclass="math inline"><em>x</em></span>))</p></blockquote><p>è¿™æ ·å°±å¾—åˆ°äº†è§‚æµ‹çš„æ¨¡å‹ã€‚ç°åœ¨æˆ‘ä»¬æ˜¯å°†ä¸¤ä¸ªä¸åŒå‚æ•°çš„æ­£æ€åˆ†å¸ƒç»“åˆåœ¨ä¸€èµ·ï¼Œé‚£æ€æ ·ç»“åˆå‘¢ï¼Ÿ<span class="math display">$$\begin{align}    \nonumber &amp;\because \mathtt{estimate} = (1 - \alpha_n) \cdot\mathtt{prediction} + \alpha_n \cdot \mathtt{measurement}\\    \nonumber &amp;\therefore \left\{ \begin{matrix}        \begin{align}            \nonumber   \hat{v}_{n,n} &amp;= (1 - \alpha_n) \cdot\hat{v}_{n,n-1} + \alpha_n \cdot z_n\\            \nonumber   {^v} \sigma^2_{n, n} &amp;= (1 - \alpha_n)^2\cdot {^v} \sigma^2_{n, n-1} + \alpha_n^2 \cdot {^r} \sigma^2_{n}        \end{align}    \end{matrix} \right.\end{align}$$</span></p><p>æˆ‘ä»¬çš„ç›®çš„æ˜¯å¾—åˆ°æœ€ä¼˜çš„ä¼°è®¡å€¼ï¼Œä¹Ÿå°±æ˜¯æ‰¾åˆ°ä½¿æ–¹å·®æœ€å°çš„å‚æ•° <spanclass="math inline"><em>Î±</em><sub><em>n</em></sub></span>ï¼Œæ‰€ä»¥æœ‰<br /><span class="math display">$$    \frac{d\ {^v} \sigma^2_{n, n}}{d\alpha_n} = 2\alpha_n \cdot {^r}\sigma^2_{n} - 2(1-\alpha_n) \cdot {^v} \sigma^2_{n,n-1} = 0$$</span> è§£å¾— <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">\alpha_n = \frac&#123;&#123;^v&#125; \sigma^2_&#123;n,n-1&#125;&#125;&#123;&#123;^v&#125; \sigma^2_&#123;n,n-1&#125; + &#123;^r&#125; \sigma^2_&#123;n&#125;&#125;</span><br><span class="line">$$</span><br></pre></td></tr></table></figure> å°†ç»“æœå¸¦å›ï¼Œè§£å‡ºæœ€ä¼˜ä¼°è®¡çš„æ–¹å·® <spanclass="math display"><sup><em>v</em></sup><em>Ïƒ</em><sub><em>n</em>,â€†<em>n</em></sub><sup>2</sup>â€„=â€„(1âˆ’<em>Î±</em><sub><em>n</em></sub>)â€…â‹…â€…<sup><em>v</em></sup><em>Ïƒ</em><sub><em>n</em>,â€†<em>n</em>â€…âˆ’â€…1</sub><sup>2</sup></span></p><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å°±å·²ç»å®Œå…¨æ¨å¯¼å‡ºäº†ä¸€ç»´å¡å°”æ›¼æ»¤æ³¢å™¨ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">KalmanFilter</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, x0, xdot, w, r</span>):</span><br><span class="line">        <span class="variable language_">self</span>.estimate = x0</span><br><span class="line">        <span class="variable language_">self</span>.dot = xdot</span><br><span class="line">        <span class="variable language_">self</span>.px = <span class="number">0.5</span></span><br><span class="line">        <span class="variable language_">self</span>.pxdot = <span class="number">0.5</span></span><br><span class="line">        <span class="variable language_">self</span>.w = w</span><br><span class="line">        <span class="variable language_">self</span>.r = r</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">self, measurement, dt</span>):</span><br><span class="line">        <span class="comment"># é¢„æµ‹æ­¥</span></span><br><span class="line">        <span class="variable language_">self</span>.estimate = <span class="variable language_">self</span>.estimate + <span class="variable language_">self</span>.dot * dt</span><br><span class="line">        <span class="variable language_">self</span>.dot = <span class="variable language_">self</span>.dot</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.px = <span class="variable language_">self</span>.px + <span class="variable language_">self</span>.pxdot * dt * dt</span><br><span class="line">        <span class="variable language_">self</span>.pxdot = <span class="variable language_">self</span>.pxdot + <span class="variable language_">self</span>.w</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ›´æ–°æ­¥</span></span><br><span class="line">        <span class="variable language_">self</span>.k = <span class="variable language_">self</span>.px / (<span class="variable language_">self</span>.px + <span class="variable language_">self</span>.r)</span><br><span class="line">        <span class="variable language_">self</span>.estimate = <span class="variable language_">self</span>.estimate + <span class="variable language_">self</span>.k * (measurement - <span class="variable language_">self</span>.estimate)</span><br><span class="line">        <span class="variable language_">self</span>.px = (<span class="number">1</span> - <span class="variable language_">self</span>.k) * <span class="variable language_">self</span>.px</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ›´æ–°ä¼°è®¡</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.estimate</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">refilter</span>(<span class="params">self, Measurement_sequence, dt</span>):</span><br><span class="line">        filter_sequence = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Measurement_sequence)):</span><br><span class="line">            filter_sequence.append(<span class="variable language_">self</span>.update(Measurement_sequence[i], dt))</span><br><span class="line">        <span class="keyword">return</span> filter_sequence</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">filter</span> = KalmanFilter(Model_initialSpeed, Model_accel, <span class="number">0.2</span>, <span class="number">1</span>)</span><br><span class="line">FilterValue = <span class="built_in">filter</span>.refilter(MeasureValue, Step)</span><br><span class="line"></span><br><span class="line"><span class="comment">### ç»˜å›¾å±•ç¤º ###</span></span><br><span class="line">plt.figure(figsize=(<span class="number">25</span>, <span class="number">5</span>))</span><br><span class="line">plt.plot(ModelValue, <span class="string">&#x27;.-&#x27;</span>, label=<span class="string">&quot;Model&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(ActualValue, <span class="string">&#x27;*-&#x27;</span>, label=<span class="string">&quot;Actual&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(MeasureValue, <span class="string">&#x27;-&#x27;</span> , label=<span class="string">&quot;Measure&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(FilterValue, <span class="string">&#x27;o-&#x27;</span>, label=<span class="string">&quot;Filter&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;lower right&#x27;</span>) <span class="comment">#ç»˜åˆ¶å›¾ä¾‹</span></span><br><span class="line"></span><br><span class="line">FP.FilterPerformance.analysis(FilterValue, MeasureValue, ActualValue)</span><br></pre></td></tr></table></figure><figure><imgsrc="pic/2_3.1-D%20Kalman%20FIlter_files/2_3.1-D%20Kalman%20FIlter_7_0.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><figure><imgsrc="pic/2_3.1-D%20Kalman%20FIlter_files/2_3.1-D%20Kalman%20FIlter_7_1.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><h2 id="æ€»ç»“">æ€»ç»“</h2><ol type="1"><li><p>åˆå§‹åŒ–<br />åˆå§‹åŒ–éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼Œåˆå§‹çŠ¶æ€å’Œåˆå§‹æ–¹å·®ã€‚åˆå§‹åŒ–å‚æ•°å¯ä»¥ç”±å…¶ä»–çš„ç³»ç»Ÿã€è¿‡ç¨‹æˆ–åŸºäºç»éªŒå’Œç†è®ºçŸ¥è¯†æ‰€å¾—å‡ºçš„åˆç†çš„çŒœæµ‹æ¥è·å¾—ã€‚å³ä½¿åˆå§‹åŒ–å‚æ•°ä¸å¤ªå‡†ç¡®ï¼Œå¡å°”æ›¼æ»¤æ³¢å™¨ä¹Ÿèƒ½æ”¶æ•›åˆ°çœŸå€¼ã€‚</p></li><li><p>å¾ªç¯</p></li></ol><ul><li>é¢„æµ‹ï¼šåˆ©ç”¨ä¸Šä¸€å‘¨æœŸçš„æœ€ä¼˜ä¼°è®¡æ¥è®¡ç®—å‡ºæœ¬å‘¨æœŸçš„é¢„æµ‹å€¼ã€‚</li></ul><span class="math inline">â€Šâ€â€</span> çŠ¶æ€å¤–æ’ï¼š<br />$$ {<p>.</p><span class="math display">$$$\qquad$ åæ–¹å·®å¤–æ’ï¼š  $$</span> {<p>. $$</p><ul><li>æµ‹é‡ï¼šåˆ©ç”¨æœ¬å‘¨æœŸçš„æµ‹é‡æ¥ä½¿æ¨¡å‹æ”¶æ•›ã€‚<br /><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$\qquad$ è®¡ç®—å¡å°”æ›¼å¢ç›Š:  </span><br><span class="line">$$</span><br><span class="line">\alpha_n = \frac&#123;&#123;^v&#125; \sigma^2_&#123;n,n-1&#125;&#125;&#123;&#123;^v&#125; \sigma^2_&#123;n,n-1&#125; + &#123;^r&#125; \sigma^2_&#123;n&#125;&#125;</span><br><span class="line">$$</span><br></pre></td></tr></table></figure> <span class="math inline">â€Šâ€â€</span> çŠ¶æ€æ›´æ–°: <spanclass="math display"><em>vÌ‚</em><sub><em>n</em>,â€†<em>n</em></sub>â€„=â€„(1âˆ’<em>Î±</em><sub><em>n</em></sub>)â€…â‹…â€…<em>vÌ‚</em><sub><em>n</em>,â€†<em>n</em>â€…âˆ’â€…1</sub>â€…+â€…<em>Î±</em><sub><em>n</em></sub>â€…â‹…â€…<em>z</em><sub><em>n</em></sub></span></li></ul><p><span class="math inline">â€Šâ€â€</span> åæ–¹å·®æ›´æ–°: <spanclass="math display"><sup><em>v</em></sup><em>Ïƒ</em><sub><em>n</em>,â€†<em>n</em></sub><sup>2</sup>â€„=â€„(1âˆ’<em>Î±</em><sub><em>n</em></sub>)â€…â‹…â€…<sup><em>v</em></sup><em>Ïƒ</em><sub><em>n</em>,â€†<em>n</em>â€…âˆ’â€…1</sub><sup>2</sup></span></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">bias0    = []</span><br><span class="line">bias1    = []</span><br><span class="line"></span><br><span class="line">search_Lowlimit = <span class="number">0</span></span><br><span class="line">search_Upplimit = <span class="number">2</span></span><br><span class="line">search_Size = <span class="number">200</span></span><br><span class="line"></span><br><span class="line">x = np.outer(np.linspace(search_Lowlimit, search_Upplimit, search_Size), np.ones(search_Size))</span><br><span class="line">y = x.copy().T</span><br><span class="line">z = np.zeros((search_Size, search_Size))</span><br><span class="line">zmax = []</span><br><span class="line">zmaxindex = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(search_Lowlimit, search_Upplimit * search_Size, search_Upplimit):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(search_Lowlimit, search_Upplimit * search_Size, search_Upplimit):</span><br><span class="line">        <span class="built_in">filter</span> = KalmanFilter(Model_initialSpeed, Model_accel, i/search_Size, j/search_Size)</span><br><span class="line">        FilterValue = <span class="built_in">filter</span>.refilter(MeasureValue, Step)</span><br><span class="line">        bias0 = np.mean(<span class="built_in">abs</span>(np.array(MeasureValue) - np.array(ActualValue)))</span><br><span class="line">        bias1 = np.mean(<span class="built_in">abs</span>(np.array(FilterValue) - np.array(ActualValue)))</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">1</span> - (bias1 / bias0)) &lt; <span class="number">0</span>:</span><br><span class="line">            z[<span class="built_in">int</span>(i/search_Size)][<span class="built_in">int</span>(j/search_Size)] = <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            z[<span class="built_in">int</span>(i/search_Upplimit)][<span class="built_in">int</span>(j/search_Upplimit)] = (<span class="number">1</span> - (bias1 / bias0))</span><br><span class="line">        zmax.append(z.<span class="built_in">max</span>())</span><br><span class="line">        zmaxindex.append([i, j])</span><br><span class="line"></span><br><span class="line">a = np.array(zmaxindex[zmax.index(<span class="built_in">max</span>(zmax))])</span><br><span class="line"></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">20</span>, <span class="number">10</span>))</span><br><span class="line">contours = plt.contourf(x, y, z, <span class="number">100</span>, cmap=<span class="string">&#x27;jet&#x27;</span>)</span><br><span class="line">plt.clabel(contours, inline=<span class="literal">True</span>, fontsize=<span class="number">8</span>)</span><br><span class="line">plt.colorbar()</span><br><span class="line">plt.suptitle(<span class="string">f&#x27;Max average deviation reduction ratio:<span class="subst">&#123;np.array(zmax).<span class="built_in">max</span>()*<span class="number">100</span>:<span class="number">.3</span>f&#125;</span>% at <span class="subst">&#123;a/search_Size&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">20</span>, <span class="number">10</span>))</span><br><span class="line">ax = plt.axes(projection=<span class="string">&#x27;3d&#x27;</span>)</span><br><span class="line">ax.plot_surface(x, y, z, alpha=<span class="number">0.6</span>, cmap=<span class="string">&#x27;jet&#x27;</span>)</span><br><span class="line">ax.set_zlabel(<span class="string">&#x27;max average deviation reduction ratio&#x27;</span>)</span><br><span class="line">ax.set_zlim(<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">ax.contour(x, y, z, [i/<span class="number">100</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">int</span>(np.array(zmax).<span class="built_in">max</span>()*<span class="number">100</span>), <span class="number">1</span>)], cmap=<span class="string">&#x27;jet&#x27;</span>)</span><br></pre></td></tr></table></figure><pre><code>&lt;mpl_toolkits.mplot3d.art3d.QuadContourSet3D at 0x7400f9fb4080&gt;</code></pre><figure><imgsrc="pic/2_3.1-D%20Kalman%20FIlter_files/2_3.1-D%20Kalman%20FIlter_9_1.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><figure><imgsrc="pic/2_3.1-D%20Kalman%20FIlter_files/2_3.1-D%20Kalman%20FIlter_9_2.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure>]]></content>
      
      
      <categories>
          
          <category> è´å¶æ–¯æ»¤æ³¢å™¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ»¤æ³¢å™¨ </tag>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è´å¶æ–¯æ»¤æ³¢å™¨ç³»åˆ—(4) - G-H æ»¤æ³¢å™¨</title>
      <link href="/2025/09/01/2_2.g-h%20Filter/"/>
      <url>/2025/09/01/2_2.g-h%20Filter/</url>
      
        <content type="html"><![CDATA[<h1 id="g-h-æ»¤æ³¢å™¨">g-h æ»¤æ³¢å™¨</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># %matplotlib widget</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> MyFilter.FilterPerformance <span class="keyword">as</span> FP</span><br><span class="line"><span class="keyword">import</span> MyFilter.UserLib <span class="keyword">as</span> UserLib</span><br><span class="line"></span><br><span class="line">figsize=(<span class="number">25</span>, <span class="number">5</span>)</span><br></pre></td></tr></table></figure><h2 id="å¼•è¨€">1 å¼•è¨€</h2><p>æœ‰äº†è´å¶æ–¯æ€æƒ³åæˆ‘ä»¬å†å›å¤´æ¥çœ‹ä¹‹å‰ä½¿ç”¨çš„æ»¤æ³¢å™¨ - <strong>CAFilter</strong>:<br /><span class="math display">$$\hat{x} = \frac{n-1}{n} \hat{x}_{last}+ \frac{1}{n}x_n$$</span> <span class="math inline">â€Šâ€â€</span> <spanclass="math inline"><em>xÌ‚</em><sub><em>l</em><em>a</em><em>s</em><em>t</em></sub></span>å°±æ˜¯æˆ‘ä»¬çš„å…ˆéªŒä¿¡æ¯ï¼Œä¸”éšç€æ¬¡æ•°å¢åŠ ï¼Œæˆ‘ä»¬è¶Šæ¥è¶Šç›¸ä¿¡å…ˆéªŒä¿¡æ¯(æƒé‡åœ¨æé™æƒ…å†µä¸‹ä¸º1 ); æ–°çš„æµ‹é‡å€¼ä¸º <spanclass="math inline"><em>x</em><sub><em>n</em></sub></span> ,æ¯æ¬¡è§‚æµ‹çš„æ–°æ¯è¶Šæ¥è¶Šå°‘ï¼Œæˆ‘ä»¬å¯¹è§‚æµ‹çš„ä¿¡ä»»ç¨‹åº¦é€æ¸ä¸‹é™(æƒé‡åœ¨æé™æƒ…å†µä¸‹ä¸º0 )ã€‚</p><ul><li><strong>SMA Filter</strong>: <span class="math display">$$\hat{x} = \hat{x}_{last} + \frac{1}{n} \cdot (x_M - x_{M-n})$$</span></li></ul><p><span class="math inline">â€Šâ€â€</span> åœ¨ SMAä¸­ï¼Œå…ˆéªŒä¿¡æ¯ä¾æ—§æ˜¯ä¹‹å‰æµ‹é‡å¹³å‡å€¼ã€‚ä½†æ¯æ¬¡éƒ½ä¸å†ä¿¡ä»»é˜Ÿåˆ—ä¸­æœ€æœ«ç«¯çš„æ•°æ®ï¼Œå¹¶å°†æ–°æ•°æ®åŠ å…¥é˜Ÿåˆ—ä¸­ã€‚</p><ul><li><strong>WMA Filter</strong>:</li></ul><p><span class="math inline">â€Šâ€â€</span> WMA ä¸ SMAç›¸ç±»ä¼¼ï¼Œåªä¸è¿‡å…¶æ›´ç›¸ä¿¡è¾ƒæ–°çš„æ•°æ®ã€‚(å…¶å® WMA æ˜¯ä¸ªåŒå±‚çš„ SMA ,æƒé‡æ˜¯ä¸€ä¸ªæ¨è¾‰ä¸‰è§’)</p><ul><li><p><strong>EMA Filte</strong>r: <spanclass="math display">lim<sub><em>n</em>â€„â†’â€„âˆ</sub><em>xÌ‚</em><sub><em>n</em>â€…+â€…1</sub>â€„=â€„(1âˆ’<em>Î±</em>)â€…â‹…â€…<em>xÌ‚</em><sub><em>n</em></sub>â€…+â€…<em>Î±</em>â€…â‹…â€…<em>x</em><sub><em>n</em>â€…+â€…1</sub></span><span class="math inline">â€Šâ€â€</span> EMAå¯¹äºå…ˆéªŒæ–°æ¯çš„ä¿¡ä»»ç¨‹åº¦æ˜¯ä¸€ä¸ªå›ºå®šçš„å¸¸æ•° (1-), å¹¶å¯¹æ–°æ¯ç»™äºˆä»¥æ’å®šçš„ä¿¡ä»»åº¦ã€‚(æ— åä¼°è®¡å˜›ï¼Œä¿¡ä»»åº¦å¿…é¡»æ˜¯äº’è¡¥çš„)</p></li><li><p><strong>DEMA Filter</strong>:</p></li></ul><p><span class="math inline">â€Šâ€â€</span>è¿™ä¸ªä¸ä¼šï¼Œä»–å¦ˆçš„åˆ°åº•ä¸ºä»€ä¹ˆçº¿æ€§æ¨¡å‹çš„ y æˆªè·æ˜¯ <spanclass="math inline">$(2\hat{x} - \hat{\hat{x}})$</span> å•Šï¼Ÿï¼Ÿï¼Ÿç‰¹æ„å»ç¿»äº† 1961å¹´å¸ƒæœ—å¹³æ»‘çš„è®ºæ–‡ï¼ŒåŸä½œè€…ç›´æ¥æ³¨æ„åˆ°ï¼Œè¡Œæˆ‘çï¼Œæˆ‘æ³¨æ„åŠ›æ¶£æ•£ï¼Œç®—ä½ ç‰›é€¼ğŸ¤¡ã€‚çº¿æ€§æ¨¡å‹çš„æ•ˆæœä¹Ÿå¤ªå¥½äº†â€¦å›å­¦æ ¡æ‹¿è‰çº¸ç®—ä¸€ä¸‹å†è¯´å§ã€‚</p><ul><li><strong>Adam Filter</strong>:</li></ul><p><span class="math inline">â€Šâ€â€</span> Adamåˆ™æ˜¯åˆ©ç”¨æŒ‡æ•°æ»¤æ³¢å¹³æ»‘é¢„æµ‹æ•°æ®çš„ä¸€é˜¶çŸ©(<spanclass="math inline"><em>E</em><em>X</em></span>)ä¸äºŒé˜¶çŸ©(<spanclass="math inline"><em>D</em><em>X</em></span>)ï¼Œä½¿ç”¨å¹³æ»‘åçš„çŸ©ä½œä¸ºå…ˆéªŒä¿¡æ¯è¿›è¡Œå›å½’åˆ†æè®¡ç®—å‡ºæœ¬æ¬¡çš„é¢„æµ‹å€¼ï¼›å†ä½¿ç”¨è§‚æµ‹å€¼çš„æ®‹å·®å¯¹çŸ©è¿›è¡Œæ›´æ–°å¹¶åˆ©ç”¨æ¢¯åº¦ä¸‹é™å¯¹é¢„æµ‹å€¼è¿›è¡ŒçŸ«æ­£ã€‚</p><p>å…¶å®å³ä½¿é¢‘åŸŸæ€§èƒ½å¥½çš„æ»¤æ³¢å™¨ (FIRã€IIR) ä¹Ÿå¯ä»¥ç”¨è¿™ç§æ€æƒ³æ¥çœ‹å¾…(ä»æ•°ç”µçš„è§’åº¦çœ‹çš„è¯ï¼šï¼ˆæŠ‘åˆ¶å™ªå£°=&gt;æŠ‘åˆ¶é«˜é¢‘æˆåˆ†=&gt;å•ä¸€ç‚¹ä¸å¯èƒ½æœ‰é¢‘ç‡ä¿¡æ¯=&gt;ä¿å­˜ä¹‹å‰çš„ç‚¹ï¼‰å¾—ï¼Œä»ç»„åˆé€»è¾‘å˜æˆæ—¶åºé€»è¾‘äº†ï¼Œè€Œå¯„å­˜å™¨å­˜å‚¨çš„å°±æ˜¯å…ˆéªŒä¿¡æ¯)ã€‚ä½†æ˜¯ä¸åŒçš„æ˜¯å¤§å¤šæ•°ä¿¡å·å¤„ç†çš„æ•™æéƒ½æ˜¯é¢å‘ç”µå­ä¿¡æ¯å·¥ç¨‹çš„å­¦ç”Ÿï¼Œè¿™äº›äººæ›´åœ¨æ„å¦‚ä½•åœ¨ä¸Šå¸è§†è§’å»æ›´å¥½çš„å¤„ç†æ•´ä¸ªä¿¡å·(åœ¨æ„é¢‘åŸŸæ€§èƒ½ï¼Œæ¯”å¦‚å¦‚ä½•å¤„ç†ä¸€é¦–æ­Œæ›²çš„éŸ³é¢‘ä¿¡æ¯)ï¼›ä½†æˆ‘ä»¬å´å¾ˆåœ¨æ„å®æ—¶æ€§(æ—¶åŸŸæ€§èƒ½ï¼Œæ€»ä¸èƒ½è®©ä¼ æ„Ÿå™¨å…ˆè¿è¡Œä¸€éè®°å½•å¥½ä¿¡å·å†æ¥å¤„ç†å§ï¼Ÿæ–°æ¦‚å¿µåˆ»èˆŸæ±‚å‰‘ï¼Ÿ)ã€‚åœ¨æ€§èƒ½é€‰æ‹©ä¸Šçš„åˆ†æ­§ï¼Œè‡´ä½¿æˆ‘ä»¬å‡ ä¹ä¸ä¼šåŒæ—¶é€‰ç”¨ä¸¤ç±»æ»¤æ³¢å™¨ã€‚<del>(ä½ é—®æˆ‘ä¸ºå•¥åŒæ—¶å­¦ï¼Œç­”æ›°ï¼šæˆ‘æ˜¯ç”µæ°”å·¥ç¨‹çš„ï¼Œå§¥å§¥(ç”µä¿¡)ä¸äº²èˆ…èˆ…(è‡ªåŠ¨åŒ–)ä¸çˆ±ï¼Œè‡ªå·±å­¦å®Œæ‰çŸ¥é“æŠ€èƒ½æ ‘ç‚¹æ­ªäº†ğŸ¤•)</del></p><p>ä»æœ¬èŠ‚å¼€å§‹ï¼Œæˆ‘ä»¬å°†ä¼šå°†ç³»ç»Ÿæ¨¡å‹å¼•å…¥æ»¤æ³¢å™¨ï¼Œä»è€Œè¿›ä¸€æ­¥æå‡æ»¤æ³¢å™¨æ€§èƒ½ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é‡‡æ ·å‚æ•°</span></span><br><span class="line">SampleFre = <span class="number">10</span></span><br><span class="line">TotalTime = <span class="number">10</span>          <span class="comment"># é‡‡æ ·æ—¶é—´ ä¸æ¨èå¤§äº10, å¢åŠ ç‚¹æ•°è¯·å¢å¤§é‡‡æ ·ç‡</span></span><br><span class="line">Step = <span class="number">1</span>/SampleFre</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹å‚æ•°</span></span><br><span class="line">Model_accel = <span class="number">2</span></span><br><span class="line">Model_initialSpeed = <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### ä»¿çœŸ ###</span></span><br><span class="line">ModelValue, ActualValue, MeasureValue = UserLib.Model.Generative(Step, TotalTime, <span class="keyword">lambda</span> x: Model_accel * x + Model_initialSpeed)</span><br></pre></td></tr></table></figure><h2 id="ç³»ç»Ÿå»ºæ¨¡">2 ç³»ç»Ÿå»ºæ¨¡</h2><h2 id="ä»¿çœŸå»ºæ¨¡">2.1 ä»¿çœŸå»ºæ¨¡</h2><p>æˆ‘ä»¬ä¾ç„¶é‡‡ç”¨åŒ€é€Ÿè¿åŠ¨æ¨¡å‹ï¼Œåªä¸è¿‡è¿™æ¬¡ä½¿ç”¨ lambdaè¡¨è¾¾å¼å°†æ¨¡å‹ä¼ å…¥å°è£…å¥½çš„ç”Ÿæˆå‡½æ•°ã€‚ç°åœ¨æ¥å¥½å¥½çœ‹çœ‹æˆ‘ä»¬çš„ä»¿çœŸæ¨¡å‹éƒ½æœ‰ä»€ä¹ˆå§ã€‚&gt; <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">lambda</span> x: Model_accel * x + Model_initialSpeed</span><br></pre></td></tr></table></figure></p><p>ç”±å¾®åˆ†å­¦åŸºæœ¬å¸¸è¯†å¯çŸ¥ï¼Œå½“ <spanclass="math inline"><em>d</em><em>t</em>â€„â†’â€„0</span> æ—¶, è‹¥å‡½æ•°å¯å¾®åˆ™<span class="math inline"><em>d</em><em>y</em></span>ä¸ºçº¿æ€§ä¸»éƒ¨ã€‚è¿™å‘Šè¯‰æˆ‘ä»¬ï¼Œåªè¦é‡‡æ ·ç‡å¤Ÿé«˜ï¼Œä¸€åˆ‡æ¨¡å‹éƒ½æ˜¯çº¿æ€§çš„<del>åŠ›å¤§ç –é£</del>ã€‚ä½†æ˜¯ç°å®æƒ…å†µä¸å¯èƒ½æ˜¯å®Œç¾çš„çº¿æ€§æ¨¡å‹ï¼Œæ‰€ä»¥è¿™é‡Œç”¨æ³°å‹’å¤šé¡¹å¼çš„äºŒé˜¶ã€ä¸‰é˜¶é¡¹<spanclass="math inline">(0.0317*<em>x</em>**2)â€…âˆ’â€…(0.00223*<em>x</em>**3)</span>,æ¥æ¨¡æ‹Ÿæ¨¡å‹çš„éçº¿æ€§ã€‚è€Œé¡¹ <spanclass="math inline">(0.312*(<em>n</em><em>p</em>.<em>s</em><em>i</em><em>n</em>(<em>n</em><em>p</em>.<em>p</em><em>i</em>*<em>x</em>)+<em>n</em><em>p</em>.<em>s</em><em>i</em><em>n</em>(6*<em>n</em><em>p</em>.<em>p</em><em>i</em>*<em>x</em>)+<em>n</em><em>p</em>.<em>s</em><em>i</em><em>n</em>(12*<em>n</em><em>p</em>.<em>p</em><em>i</em>*<em>x</em>)))</span>åˆ™æ¨¡æ‹ŸæŸç§å¤–å› å¯¼è‡´çš„ç³»ç»Ÿå›ºæœ‰éœ‡è¡ï¼Œæ¯”å¦‚è¯´å°è½¦è½´æ‰¿å®‰è£…ä¸å…±è½´ä¹‹ç±»çš„ã€‚ &gt;<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">temp += (<span class="number">0.0317</span> * x**<span class="number">2</span>) - (<span class="number">0.00223</span> * x**<span class="number">3</span>) </span><br><span class="line">     + (<span class="number">0.312</span> * (np.sin(np.pi*x) + np.sin(<span class="number">6</span>*np.pi*x) + np.sin(<span class="number">12</span>*np.pi*x)))</span><br></pre></td></tr></table></figure></p><p>å½“åœ¨æ—¶é—´ä¸­æ®µï¼Œç»™äºˆä¸€ä¸ªé˜¶<del>è¹²</del>è·ƒä¿¡å·ï¼Œæ¨¡æ‹Ÿçªç„¶åˆ¹è½¦æˆ–æ’å‡»äº§ç”Ÿçš„ç¬é—´å˜åŒ–ã€‚</p><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> x &gt; totalTime/<span class="number">2</span>:</span><br><span class="line">    temp -= model_func(totalTime/<span class="number">3</span>)</span><br></pre></td></tr></table></figure></blockquote><p>æœ€åå†ä½¿ç”¨ <span class="math inline"><em>N</em>(0ï¼Œ0.2)</span>æ¥è¡¨å¾è¿‡ç¨‹å™ªå£°ï¼Œæ¯”å¦‚åœ°é¢çš„å´å²–ï¼›å’Œæ ‡å‡†æ­£æ€åˆ†å¸ƒ <spanclass="math inline"><em>N</em>(0ï¼Œ1)</span> æ¥è¡¨å¾æµ‹é‡å™ªå£°ã€‚</p><h2 id="é¢„æµ‹å»ºæ¨¡">2.2 é¢„æµ‹å»ºæ¨¡</h2><p>ä½¿ç”¨ç®€å•çš„è¿åŠ¨å­¦æ–¹ç¨‹æ¥å†™å‡ºæ—¶åˆ» n åˆ° n+1é€’æ¨å…³ç³»å¼ã€‚(è¿™é‡Œä¹Ÿæ¨èå°†å¯¼æ•°ç¬¦å·ä» <spanclass="math inline"><em>v</em>â€²</span> æ”¹æˆ <spanclass="math inline"><em>vÌ‡</em></span>,ä¸ºå•¥ï¼ŸçœŸå¹¸è¿ï¼Œçœ‹æ¥ä½ è¿˜æ²¡è§è¿‡å†™å››ä¸ªè§’æ ‡çš„ç¬¦å·ï¼Œåˆ°æ—¶å€™å°±çŸ¥é“ä¸ºå•¥è¦æŠŠå¯¼æ•°ç¬¦å·æ”¾åˆ°å¤´é¡¶é‡Œäº†ğŸ˜­)<span class="math display">$$\begin{align}   \nonumber    v_{n+1} &amp;= v_{n} + \Delta t \dot{v}_{n} \\   \nonumber    \dot{v}_{n} &amp;= \dot{v}_{n}\end{align}$$</span></p><p>è®©æˆ‘ä»¬å†™çš„æ›´ç®€æ´ä¸€ç‚¹</p><p><span class="math display">$$    \begin{bmatrix}    {v}_{n+1} \\ \dot{v}_{n+1}      \end{bmatrix}    =    \begin{bmatrix}    1 &amp; \Delta t\\    0 &amp; 1    \end{bmatrix}    \begin{bmatrix}    {v}_{n} \\ \dot{v}_{n}      \end{bmatrix}$$</span></p><p>å…¶ä¸­å‘é‡ <span class="math inline">$\begin{bmatrix} {v}_{n} \\\dot{v}_{n} \end{bmatrix}$</span>æ˜¯æˆ‘ä»¬å¯¹è¢«æ§å¯¹è±¡(plant)æ‰€æ„Ÿå…´è¶£çš„ç‰©ç†é‡, ç§°ä¹‹ä¸ºçŠ¶æ€å˜é‡(state)ã€‚</p><p>å¥½ï¼Œç°åœ¨æˆ‘ä»¬å°±å¯ä»¥æ ¹æ®ä¸Šä¸€æ—¶åˆ»çš„ç³»ç»ŸçŠ¶æ€ä»è€ŒçŒœå‡ºæœ¬æ—¶åˆ»ç³»ç»Ÿçš„çŠ¶æ€äº†(å…ˆéªŒä¿¡æ¯)ã€‚ç„¶ååƒä¹‹å‰çš„é‚£äº›æ»¤æ³¢å™¨ä¸€æ ·ï¼Œé€šè¿‡æŸç§æ¯”ä¾‹æ¥å°†å…ˆéªŒä¿¡æ¯ä¸åéªŒä¿¡æ¯(æµ‹é‡å€¼)ç»“åˆåœ¨ä¸€èµ·ã€‚</p><p><spanclass="math display"><code>e</code><code>s</code><code>t</code><code>i</code><code>m</code><code>a</code><code>t</code><code>e</code>â€„=â€„(1âˆ’<em>Î±</em>)â€…â‹…â€…<code>p</code><code>r</code><code>e</code><code>d</code><code>i</code><code>c</code><code>t</code><code>i</code><code>o</code><code>n</code>â€…+â€…<em>Î±</em>â€…â‹…â€…<code>m</code><code>e</code><code>a</code><code>s</code><code>u</code><code>r</code><code>e</code><code>m</code><code>e</code><code>n</code><code>t</code></span></p><p>æ ¹æ®åˆšåˆšçš„æ€è·¯å®ç°æ»¤æ³¢å™¨ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TestFilter</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, alpha, dot, init</span>):</span><br><span class="line">        <span class="variable language_">self</span>.alpha = alpha</span><br><span class="line">        <span class="variable language_">self</span>.dot = dot</span><br><span class="line">        <span class="variable language_">self</span>.estimate = init</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">self, measurement, dt</span>):</span><br><span class="line">        <span class="comment"># é¢„æµ‹æ­¥</span></span><br><span class="line">        prediction = <span class="variable language_">self</span>.estimate + <span class="variable language_">self</span>.dot * dt</span><br><span class="line">        <span class="variable language_">self</span>.dot = <span class="variable language_">self</span>.dot</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ•°æ®èåˆ(è´å¶æ–¯)</span></span><br><span class="line">        <span class="variable language_">self</span>.estimate = (<span class="number">1</span> - <span class="variable language_">self</span>.alpha) * prediction + <span class="variable language_">self</span>.alpha * measurement</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.estimate</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">refilter</span>(<span class="params">self, Measurement_sequence, dt</span>):</span><br><span class="line">        filter_sequence = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Measurement_sequence)):</span><br><span class="line">            filter_sequence.append(<span class="variable language_">self</span>.update(Measurement_sequence[i], dt))</span><br><span class="line">        <span class="keyword">return</span> filter_sequence</span><br></pre></td></tr></table></figure><p>æ¼‚äº®ï¼Œèµ¶ç´§æ¥è¯•è¯•æ•ˆæœ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">filter</span> = TestFilter(<span class="number">0.5</span>, Model_accel, Model_initialSpeed)</span><br><span class="line">FilterValue = <span class="built_in">filter</span>.refilter(MeasureValue, Step)</span><br><span class="line"></span><br><span class="line"><span class="comment">### ç»˜å›¾å±•ç¤º ###</span></span><br><span class="line">plt.figure(figsize=(<span class="number">25</span>, <span class="number">5</span>))</span><br><span class="line">plt.plot(ModelValue, <span class="string">&#x27;.-&#x27;</span>, label=<span class="string">&quot;Model&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(ActualValue, <span class="string">&#x27;*-&#x27;</span>, label=<span class="string">&quot;Actual&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(MeasureValue, <span class="string">&#x27;-&#x27;</span>, label=<span class="string">&quot;Measure&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(FilterValue, <span class="string">&#x27;o-&#x27;</span>, label=<span class="string">&quot;Filter&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;lower right&#x27;</span>) <span class="comment">#ç»˜åˆ¶å›¾ä¾‹</span></span><br><span class="line"></span><br><span class="line">FP.FilterPerformance.analysis(FilterValue, MeasureValue, ActualValue)</span><br></pre></td></tr></table></figure><figure><img src="pic/2_2.g-h%20Filter_files/2_2.g-h%20Filter_8_0.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><figure><img src="pic/2_2.g-h%20Filter_files/2_2.g-h%20Filter_8_1.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">bias0    = []</span><br><span class="line">bias1    = []</span><br><span class="line">redratio = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>, <span class="number">1</span>):</span><br><span class="line">    <span class="built_in">filter</span> = TestFilter(i/<span class="number">100</span>, Model_accel, Model_initialSpeed)</span><br><span class="line">    FilterValue = <span class="built_in">filter</span>.refilter(MeasureValue, Step)</span><br><span class="line">    bias0.append(np.mean(<span class="built_in">abs</span>(np.array(MeasureValue) - np.array(ActualValue))))</span><br><span class="line">    bias1.append(np.mean(<span class="built_in">abs</span>(np.array(FilterValue) - np.array(ActualValue))))</span><br><span class="line">    redratio.append(<span class="number">1</span> - bias1[-<span class="number">1</span>] / bias0[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">fig = plt.figure(figsize=figsize)</span><br><span class="line">ax = fig.add_subplot(<span class="number">111</span>)</span><br><span class="line">ax.plot([i/<span class="number">100</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, bias1.__len__() + <span class="number">1</span>, <span class="number">1</span>)], bias1, <span class="string">&#x27;-o&#x27;</span>, label=<span class="string">&quot;Mean abs bias&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">ax.legend(loc=<span class="string">&#x27;lower left&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ax2 = ax.twinx()</span><br><span class="line">ax2.plot([i/<span class="number">100</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, redratio.__len__() + <span class="number">1</span>, <span class="number">1</span>)],redratio, <span class="string">&#x27;-ob&#x27;</span>, label=<span class="string">&quot;Reduction ratio&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">ax2.legend(loc=<span class="string">&#x27;lower right&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.suptitle(<span class="string">f&#x27;Max average deviation reduction ratio:<span class="subst">&#123;np.array(redratio).<span class="built_in">max</span>()*<span class="number">100</span>:<span class="number">.3</span>f&#125;</span>% at <span class="subst">&#123;(np.array(redratio).argmax() + <span class="number">1</span>)/<span class="number">100</span>&#125;</span>&#x27;</span>)</span><br><span class="line">plt.plot(np.array(redratio).argmax()/<span class="number">100</span> , np.array(redratio).<span class="built_in">max</span>(), <span class="string">&#x27;*g&#x27;</span>, markersize=<span class="number">10</span>)</span><br><span class="line">plt.axhline(np.array(redratio).<span class="built_in">max</span>(), color=<span class="string">&#x27;r&#x27;</span>)</span><br></pre></td></tr></table></figure><pre><code>&lt;matplotlib.lines.Line2D at 0x7763739bade0&gt;</code></pre><figure><img src="pic/2_2.g-h%20Filter_files/2_2.g-h%20Filter_9_1.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><p>æ•ˆæœç›¸å½“ä¸é”™å¯¹å§!ä½†æ˜¯ä»è¯¯å·®åˆ†æ®µå›¾ä¸­å¯ä»¥å‘ç°,æ»¤æ³¢å™¨å¯¹çªå˜çš„å“åº”å¾ˆç±»ä¼¼äº EMA çš„å“åº”;åˆæˆ–è€…å½“æ¨¡å‹ä¸å‡†ç¡®æ—¶(æ¯”å¦‚æ–œç‡å–ç›¸åæ•°ï¼ŒÉ‘å–0.1)ï¼Œæ»¤æ³¢å™¨æœ‰éå¸¸å¤§çš„æ»åæ€§ã€‚<br />è¿™è‚¯å®šæ˜¯æˆ‘ä»¬ä¸æƒ³è§åˆ°çš„ï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬çš„å°è½¦é€Ÿåº¦é—­ç¯æ§åˆ¶ç³»ç»Ÿå·²ç»è®©å‘åŠ¨æœºä»¥æœ€å¤§åŠŸç‡å¼€å§‹å·¥ä½œäº†ï¼Œåˆšå¼€å§‹éå¸¸ç¬¦åˆæˆ‘ä»¬çš„åŠ é€Ÿåº¦çš„æœŸå¾…ï¼Œä½†éšç€é€Ÿåº¦å¢å¤§ï¼Œç©ºæ°”é˜»åŠ›ä½¿åŠ é€Ÿåº¦ä¸æ–­ä¸‹é™ä½†å‘åŠ¨æœºçš„åŠŸç‡æ— æ³•ç»§ç»­æé«˜(åç¦»äº†æœŸæœ›çš„æ¨¡å‹),æ­¤æ—¶å‘ç”Ÿé€Ÿåº¦æ³¢åŠ¨æˆ‘ä»¬å°±æ— æ³•é«˜æ•ˆçš„è§‚æµ‹ã€‚<br />æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><h2 id="æ›´æ–°æ¨¡å‹">2.3 æ›´æ–°æ¨¡å‹</h2><p>å‡å¦‚æ¨¡å‹å¾ˆå®Œç¾çš„å·¥ä½œä¸€æ®µæ—¶é—´ä¹‹åï¼Œç”±äºæŸäº›å½±å“æ¨¡å‹ä¸å†å‡†ç¡®äº†é‚£ä¹ˆæˆ‘ä»¬è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿemmmmé‚£å°±æƒ³åŠæ³•æ›´æ–°æ¨¡å‹å‘—ã€‚ (å•¥ï¼Ÿä½ è¯´æ›´åŠ ç›¸ä¿¡æµ‹é‡å€¼ï¼Œæƒ³åŠæ³•ä¿®æ”¹ <spanclass="math inline"><em>Î±</em></span>?è·‘åäº†ï¼Œéº»æºœå›æ¥ã€‚é‚£å«å¡å°”æ›¼æ»¤æ³¢å™¨ï¼Œæ˜¯ä¸‹èŠ‚çš„å†…å®¹ğŸ˜‹)<br />ä¸å¦¨æŠŠæˆ‘ä»¬æ‰‹ä¸Šæ‹¥æœ‰çš„ä¿¡æ¯åˆ—å‡ºæ¥: <spanclass="math inline"><em>vÌ‚</em>,â€†<em>vÌ‡</em>,â€†<em>d</em><em>t</em></span>å†åŠ ä¸Šæœ¬æ¬¡æµ‹é‡å€¼ Zã€‚å¦‚æœä»ç¨³æ€è¿›å…¥æš‚æ€çš„è¯ä¼šæœ‰ä»€ä¹ˆæ ·å­çš„ç‰¹å¾å‘¢ï¼Ÿä¸å¦¨çœ‹çœ‹ä¸Šé¢çš„è¯¯å·®å›¾ã€‚å¾ˆæ˜¾ç„¶çªå˜å‘ç”Ÿæ—¶è¯¯å·®ä¼šæœ‰ä¸€ä¸ªæå¤§çš„å°–å³°ã€‚æˆ–è€…æ¢ä¸€ç§è¯´æ³•ï¼Œå½“æˆ‘ä»¬çš„å…ˆéªŒä¿¡æ¯ä¸å†å‡†ç¡®æ—¶ï¼Œä¾èµ–æ¨¡å‹çš„â€æƒ¯æ€§â€ä¼šä½¿é¢„æµ‹å€¼ä¸æµ‹é‡å€¼äº§ç”Ÿä¸€ä¸ªæå¤§çš„è¯¯å·®ã€‚<br />æ›´è¿›ä¸€æ­¥çš„è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ®‹å·®(æˆ‘ä¹ æƒ¯å°†æ®‹å·®çš„ç»å¯¹å€¼ç§°ä¸ºè¯¯å·®)æ¥å¯¹ <spanclass="math inline"><em>vÌ‡</em></span> è¿›è¡ŒæŸç§æ›´æ–°ã€‚æ¥ä¸‹æ¥çœ‹æˆ‘è¡¨æ¼”<br /><span class="math display">$$\begin{align}    \nonumber       \mathtt{estimate} &amp;= (1 - \alpha) \cdot\mathtt{prediction} + \alpha \cdot \mathtt{measurement}\\                    \hat{v}_{n,n} &amp;= (1 - \alpha) \cdot\hat{v}_{n,n-1} + \alpha \cdot z_n\\    \nonumber       \hat{v}_{n,n} - \hat{v}_{n,n-1} &amp;= (1 - \alpha-1) \cdot \hat{v}_{n,n-1} + \alpha \cdot z_n\\    \nonumber       (\hat{v}_{n,n} - \hat{v}_{n-1,n-1})-(\hat{v}_{n,n-1} - \hat{v}_{n-1,n-1}) &amp;=  \alpha \cdot (z_n -\hat{v}_{n,n-1}) \\                    \hat{\dot{v}}_{n,n} - \hat{\dot{v}}_{n,n-1} &amp;=\alpha \cdot \frac {(z_n - \hat{v}_{n,n-1})}{dt} \\\end{align}$$</span> (1) å’Œ (2)å³æ˜¯æˆ‘ä»¬çš„çŠ¶æ€æ›´æ–°æ–¹å·®ï¼Œæ¨å¯¼è¿‡ç¨‹ä¸­ä¸ºäº†è¡¨ç¤ºé€»è¾‘çš„è¿ç»­æ€§å¹¶æ²¡æœ‰æ›´æ”¹å‚æ•°ç¬¦å·ã€‚ä½†æ˜¯å¯ä»¥æ˜æ˜¾æ³¨æ„åˆ°è¿™é‡Œçš„èåˆå‚æ•°ä¸åº”è¯¥é€‰æ‹©ç›¸åŒçš„ï¼Œå› ä¸ºæˆ‘ä»¬ä¼ æ„Ÿå™¨ç›´æ¥æµ‹é‡çš„æ˜¯é€Ÿåº¦ï¼Œèåˆé€Ÿåº¦æ—¶å‚æ•°ä¸ä¼ æ„Ÿå™¨çš„ç²¾ç¡®åº¦æœ‰å…³ï¼›è€Œæ›´æ–°åŠ é€Ÿåº¦æ—¶åªä¸ç²¾å¯†åº¦æœ‰å…³ã€‚</p><blockquote><ul><li>æ­£ç¡®åº¦ (correctness of measurement):æŒ‡æµ‹é‡ç»“æœä¸çœŸå€¼çš„åç¦»ç¨‹åº¦ï¼Œè¡¨å¾äº†ç³»ç»Ÿè¯¯å·®çš„å¤§å°ã€‚(æ•°æ®æ˜¯å¦æœ‰å)<br /></li><li>ç²¾å¯†åº¦ (precision of measurement):æµ‹é‡è¯»æ•°é‡å¤ä¸€è‡´çš„ç¨‹åº¦ï¼Œè¡¨å¾äº†éšæœºè¯¯å·®çš„å¤§å°ã€‚(æ•°æ®æ•£å¸ƒæƒ…å†µ)<br /></li><li>ç²¾ç¡®åº¦ (accuracy of measurement):æŒ‡æµ‹é‡ç»“æœä¸çœŸå€¼ç¬¦åˆä¸€è‡´çš„ç¨‹åº¦ï¼Œè¡¨å¾ç³»ç»Ÿè¯¯å·®å’Œéšæœºè¯¯å·®çš„ç»¼åˆå¤§å°ã€‚<br /><p align="right">â€”â€”â€”â€”ã€Šç”µæ°”æµ‹é‡ã€‹ç¬¬ä¸€ç« </p>æ‰€ä»¥è®©ä½ ä»¬å¥½å¥½å­¦è¯¾å†…çŸ¥è¯†å˜›ï¼Œæ€æƒ³è¿œæ¯”å¾—åˆ†æ›´é‡è¦</li></ul></blockquote><p>æ•´ç†ä¸€ä¸‹ï¼Œå†™å‡ºæ–¹ç¨‹ç»„</p><p><span class="math display">$$\left\{    \begin{matrix}        \begin{align}            \nonumber   \hat{v}_{n,n} &amp;= \hat{v}_{n,n-1} + \alpha\cdot (z_n - \hat{v}_{n,n-1})\\            \nonumber   \hat{\dot{v}}_{n,n} &amp;= \hat{\dot{v}}_{n,n-1}+ \beta \cdot \frac {(z_n - \hat{v}_{n,n-1})}{dt} \\        \end{align}    \end{matrix}\right.$$</span></p><p>ç°åœ¨å¯ä»¥å†™å‡ºå®Œæ•´ç‰ˆçš„ g-h æ»¤æ³¢å™¨äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ghFilter</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, alpha, beta, dot, init</span>):</span><br><span class="line">        <span class="variable language_">self</span>.alpha = alpha</span><br><span class="line">        <span class="variable language_">self</span>.beta = beta</span><br><span class="line">        <span class="variable language_">self</span>.dot = dot</span><br><span class="line">        <span class="variable language_">self</span>.estimate = init</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">self, measurement, dt</span>):</span><br><span class="line">        <span class="comment"># é¢„æµ‹æ­¥</span></span><br><span class="line">        prediction = <span class="variable language_">self</span>.estimate + <span class="variable language_">self</span>.dot * dt</span><br><span class="line">        <span class="variable language_">self</span>.dot = <span class="variable language_">self</span>.dot</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ›´æ–°æ­¥</span></span><br><span class="line">        residual = measurement - prediction</span><br><span class="line">        <span class="variable language_">self</span>.dot = <span class="variable language_">self</span>.dot + <span class="variable language_">self</span>.beta * (residual) / dt</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ•°æ®èåˆ(è´å¶æ–¯)</span></span><br><span class="line">        <span class="variable language_">self</span>.estimate = (<span class="number">1</span> - <span class="variable language_">self</span>.alpha) * prediction + <span class="variable language_">self</span>.alpha * measurement</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.estimate</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">refilter</span>(<span class="params">self, Measurement_sequence, dt</span>):</span><br><span class="line">        filter_sequence = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Measurement_sequence)):</span><br><span class="line">            filter_sequence.append(<span class="variable language_">self</span>.update(Measurement_sequence[i], dt))</span><br><span class="line">        <span class="keyword">return</span> filter_sequence</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">filter</span> = ghFilter(<span class="number">0.478</span>, <span class="number">0.002</span>, Model_accel, Model_initialSpeed)</span><br><span class="line">FilterValue = <span class="built_in">filter</span>.refilter(MeasureValue, Step)</span><br><span class="line"></span><br><span class="line"><span class="comment">### ç»˜å›¾å±•ç¤º ###</span></span><br><span class="line">plt.figure(figsize=(<span class="number">25</span>, <span class="number">5</span>))</span><br><span class="line">plt.plot(ModelValue, <span class="string">&#x27;.-&#x27;</span>, label=<span class="string">&quot;Model&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(ActualValue, <span class="string">&#x27;*-&#x27;</span>, label=<span class="string">&quot;Actual&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(MeasureValue, <span class="string">&#x27;-&#x27;</span>, label=<span class="string">&quot;Measure&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(FilterValue, <span class="string">&#x27;o-&#x27;</span>, label=<span class="string">&quot;Filter&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;lower right&#x27;</span>) <span class="comment">#ç»˜åˆ¶å›¾ä¾‹</span></span><br><span class="line"></span><br><span class="line">FP.FilterPerformance.analysis(FilterValue, MeasureValue, ActualValue)</span><br></pre></td></tr></table></figure><figure><img src="pic/2_2.g-h%20Filter_files/2_2.g-h%20Filter_13_0.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><figure><img src="pic/2_2.g-h%20Filter_files/2_2.g-h%20Filter_13_1.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">bias0    = []</span><br><span class="line">bias1    = []</span><br><span class="line"></span><br><span class="line">searchSize = <span class="number">100</span></span><br><span class="line">x = np.outer(np.linspace(<span class="number">0</span>, <span class="number">1</span>, searchSize), np.ones(searchSize))</span><br><span class="line">y = x.copy().T</span><br><span class="line">z = np.zeros((searchSize, searchSize))</span><br><span class="line">zmax = []</span><br><span class="line">zmaxindex = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, searchSize, <span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, searchSize, <span class="number">1</span>):</span><br><span class="line">        <span class="built_in">filter</span> = ghFilter(i/searchSize, j/searchSize, Model_accel, Model_initialSpeed)</span><br><span class="line">        FilterValue = <span class="built_in">filter</span>.refilter(MeasureValue, Step)</span><br><span class="line">        bias0 = np.mean(<span class="built_in">abs</span>(np.array(MeasureValue) - np.array(ActualValue)))</span><br><span class="line">        bias1 = np.mean(<span class="built_in">abs</span>(np.array(FilterValue) - np.array(ActualValue)))</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">1</span> - (bias1 / bias0)) &lt; <span class="number">0</span>:</span><br><span class="line">            z[i][j] = <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            z[i][j] = (<span class="number">1</span> - (bias1 / bias0))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        zmax.append(z.<span class="built_in">max</span>())</span><br><span class="line">        zmaxindex.append([i, j])</span><br><span class="line"></span><br><span class="line">a = np.array(zmaxindex[zmax.index(<span class="built_in">max</span>(zmax))])</span><br><span class="line">z2 = np.zeros((searchSize, searchSize))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>((a[<span class="number">0</span>] - <span class="number">5</span>)*np.sqrt(searchSize)), <span class="built_in">int</span>((a[<span class="number">0</span>] + <span class="number">5</span>)*np.sqrt(searchSize)), <span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>((a[<span class="number">1</span>] - <span class="number">5</span>)*np.sqrt(searchSize)), <span class="built_in">int</span>((a[<span class="number">1</span>] + <span class="number">5</span>)*np.sqrt(searchSize)), <span class="number">1</span>):</span><br><span class="line">        <span class="built_in">filter</span> = ghFilter(i/searchSize ** <span class="number">1.5</span>, j/searchSize ** <span class="number">1.5</span>, Model_accel, Model_initialSpeed)</span><br><span class="line">        FilterValue = <span class="built_in">filter</span>.refilter(MeasureValue, Step)</span><br><span class="line">        bias0 = np.mean(<span class="built_in">abs</span>(np.array(MeasureValue) - np.array(ActualValue)))</span><br><span class="line">        bias1 = np.mean(<span class="built_in">abs</span>(np.array(FilterValue) - np.array(ActualValue)))</span><br><span class="line">        zmax.append(z2.<span class="built_in">max</span>())</span><br><span class="line">        zmaxindex.append([i, j])</span><br><span class="line">        </span><br><span class="line">a = np.array(zmaxindex[zmax.index(<span class="built_in">max</span>(zmax))])</span><br><span class="line"></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">20</span>, <span class="number">10</span>))</span><br><span class="line">ax = plt.axes(projection=<span class="string">&#x27;3d&#x27;</span>)</span><br><span class="line">ax.plot_surface(x, y, z)</span><br><span class="line">ax.set_xlabel(<span class="string">&#x27;alpha&#x27;</span>)</span><br><span class="line">ax.set_ylabel(<span class="string">&#x27;beta&#x27;</span>)</span><br><span class="line">ax.set_zlabel(<span class="string">&#x27;max average deviation reduction ratio&#x27;</span>)</span><br><span class="line">ax.set_zlim(<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">plt.suptitle(<span class="string">f&#x27;Max average deviation reduction ratio:<span class="subst">&#123;np.array(zmax).<span class="built_in">max</span>()*<span class="number">100</span>:<span class="number">.3</span>f&#125;</span>% at <span class="subst">&#123;a/<span class="number">1000</span>&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ax.contour(x, y, z, [i/<span class="number">100</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">int</span>(np.array(zmax).<span class="built_in">max</span>()*<span class="number">100</span>), <span class="number">1</span>)], cmap=<span class="string">&#x27;jet&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2><p><ahref="https://github.com/rlabbe/Kalman-and-Bayesian-Filters-in-Python">Kalmanand Bayesian Filters in Python</a></p>]]></content>
      
      
      <categories>
          
          <category> è´å¶æ–¯æ»¤æ³¢å™¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ»¤æ³¢å™¨ </tag>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è´å¶æ–¯æ»¤æ³¢å™¨ç³»åˆ—(3) - è´å¶æ–¯å­¦æ´¾</title>
      <link href="/2025/09/01/2_1.%E8%B4%9D%E5%8F%B6%E6%96%AF%E5%AD%A6%E6%B4%BE/"/>
      <url>/2025/09/01/2_1.%E8%B4%9D%E5%8F%B6%E6%96%AF%E5%AD%A6%E6%B4%BE/</url>
      
        <content type="html"><![CDATA[<h1 id="è´å¶æ–¯å­¦æ´¾">è´å¶æ–¯å­¦æ´¾</h1><h2 id="å¼•è¨€">1 å¼•è¨€</h2><blockquote>æ¦‚ç‡è®ºåªä¸è¿‡æ˜¯æŠŠå¸¸è¯†ç”¨æ•°å­¦å…¬å¼è¡¨è¾¾äº†å‡ºæ¥ã€‚<p align="right">â€”â€”â€”â€”æ‹‰æ™®æ‹‰æ–¯</div></blockquote><div data-align="center"><table><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><thead><tr class="header"><th><img src="https://imgs.xkcd.com/comics/frequentists_vs_bayesians.png" width="351" height="532"></th><th></th></tr></thead><tbody></tbody></table></div><h2 id="è´å¶æ–¯å®šç†bayes-theorem">2 è´å¶æ–¯å®šç†ï¼ˆBayes Theoremï¼‰</h2><h3 id="ä¾‹å­">2.1 ä¾‹å­</h3><p>å…ˆæ¥åšä¸ªæœ‰å¥–ç«çŒœï¼š<br />&gt; Steveéå¸¸å®³ç¾è€Œä¸”æ€§æ ¼å­¤åƒ»ï¼Œè™½ç„¶æ€»æ˜¯ä¹äºåŠ©äººï¼Œä½†å¯¹å‘¨å›´çš„äººæˆ–ç°å®ä¸–ç•Œå‡ ä¹ä¸æ„Ÿå…´è¶£ï¼Œä»–æ˜¯ä¸€ä¸ªæ¸©é¡ºè€Œåˆäº•äº•æœ‰æ¡ï¼ˆmeekand tidyï¼‰çš„äººï¼Œéœ€è¦äº‹æƒ…æœ‰æ¡ç†ä¸”ç»“æ„æ¸…æ™°ï¼Œå¹¶ä¹äºé’»ç ”ç»†èŠ‚ã€‚<br />&gt; è¯·é—® â€œSteve æ˜¯ä¸ªå›¾ä¹¦ç®¡ç†å‘˜â€ å’Œ â€œSteve æ˜¯ä¸ªå†œæ°‘â€è¿™ä¸¤ç§è¯´æ³•å“ªç§å¯èƒ½æ€§æ›´å¤§ï¼Ÿ</p><p>5</p><p>4</p><p>3</p><p>2</p><p>1</p><p>è¿™ä¸ªä¾‹å­æ˜¯å¿ƒç†å­¦å®¶ã€è¯ºè´å°”ç»æµå­¦å¥–è·å¾—è€… Daniel Kahneman å’Œ AmosTversky å‘è¡¨äºã€ŠScienceã€‹ä¸Šçš„æ–‡ç« ã€ŠJudgment under Uncertainty:Heuristics andBiasesã€‹çš„ä¾‹å­(<del>é£˜äº†ï¼Œéƒ½æ•¢è¯»ã€Šscienceã€‹äº†ï¼Œä¹Ÿæ˜¯å¥½èµ·æ¥äº†</del>)ã€‚æ ¹æ®Kahneman å’Œ Tversky çš„å®éªŒç»“æœï¼Œå½“äººä»¬çŸ¥é“ Steveæ˜¯â€œä¸€ä¸ªæ¸©é¡ºè€Œåˆäº•äº•æœ‰æ¡çš„äººâ€åï¼Œå¤§å¤šæ•°äººéƒ½ä¼šè¯´ä»–æ›´æœ‰å¯èƒ½æ˜¯å›¾ä¹¦é¦†ç®¡ç†å‘˜ï¼Œæ¯•ç«Ÿä¸å†œæ°‘ç›¸æ¯”ï¼Œè¿™äº›ç‰¹å¾æ›´ç¬¦åˆå›¾ä¹¦é¦†ç®¡ç†å‘˜çš„å½¢è±¡ã€‚ä½†å®é™…ä¸Šè¿™æ˜¯é”™è¯¯çš„ã€éç†æ€§çš„ã€‚Why?</p><p>é—®é¢˜çš„å…³é”®ä¸æ˜¯å›¾ä¹¦ç®¡ç†å‘˜æˆ–äººä»¬çš„å½¢è±¡å¦‚ä½•ï¼Œè€Œæ˜¯åœ¨åˆ¤æ–­æ—¶äººä»¬å¹¶æ²¡æœ‰å°†å†œæ°‘ä¸å›¾ä¹¦ç®¡ç†å‘˜çš„æ¯”ä¾‹è€ƒè™‘è¿›å»ã€‚</p><blockquote><ul><li>2020å¹´ç¬¬ä¸ƒæ¬¡å…¨å›½äººå£æ™®æŸ¥ï¼šå±…ä½åœ¨ä¹¡æ‘çš„äººå£ä¸º 509787562äººï¼›ã€ŠåŒ—äº¬å¸ˆèŒƒå¤§å­¦å­¦æŠ¥ï¼ˆç¤¾ä¼šç§‘å­¦ç‰ˆï¼‰ã€‹2021 å¹´ç¬¬ 6æœŸã€Šä¸­å›½å†œæ°‘è§„æ¨¡é—®é¢˜çš„ä¸åŒåˆ¤æ–­ã€è®¤çŸ¥è¯¯åŒºä¸æ²»ç†ä¼˜åŒ–ã€‹ï¼š2020å¹´å†œä¸šåŠ³åŠ¨è€…äººæ•° 1.77 äº¿äººã€‚<br /></li><li>ã€Šæ™ºç ”å¹´æ¦œï¼š2023å¹´ä¸­å›½å„åœ°åŒºå…¬å…±å›¾ä¹¦é¦†æ•°é‡æ’è¡Œæ¦œå•TOP31ã€‹ï¼š2023å¹´å…¨å›½å…±å»ºæœ‰ 3246 ä¸ªå…¬å…±å›¾ä¹¦é¦†ã€‚</li></ul></blockquote><p>æ ¹æ®ä¸Šè¿°èµ„æ–™æˆ‘ä»¬å‡è®¾æ¯ä¸ªå›¾ä¹¦é¦†éƒ½æœ‰ 100 åå·¥ä½œäººå‘˜ï¼Œé‚£ä¹ˆå…¶æ¯”ä¾‹çº¦ä¸º<spanclass="math inline">1.77â€…Ã—â€…10<sup>7</sup>â€„:â€„3246â€„=â€„5452.86â€„:â€„1</span>ï¼Œæˆ‘ä»¬å–æ¯”ä¾‹ä¸º<span class="math inline">50000â€„:â€„10</span>ã€‚(è®ºæ–‡ä¸­ä½¿ç”¨çš„æ¯”ä¾‹ä¸º<spanclass="math inline">20â€„:â€„1</span>)<br />å¦‚æœç¬¦åˆä¹‹å‰æè¿°ç‰¹å¾çš„å†œæ°‘æ¯”ä¾‹ä¸º <span class="math inline">1%</span>ï¼Œè€Œç¬¦åˆæè¿°çš„å›¾ä¹¦ç®¡ç†å‘˜æ¯”ä¾‹ä¸º <span class="math inline">90%</span>,æˆ‘ä»¬å¯ä»¥å¾—åˆ° <spanclass="math display">50000â€…Ã—â€…0.01â€„:â€„10â€…Ã—â€…0.9â€„=â€„500â€„:â€„9</span>ä½ çœ‹ï¼Œâ€œSteve æ˜¯ä¸ªå›¾ä¹¦ç®¡ç†å‘˜â€ è¿™ä¸€è¯´æ³•çš„æ­£ç¡®çš„å¯èƒ½æ€§åªæœ‰ <spanclass="math inline">1.77%</span> ã€‚</p><p>äº‹å®ä¸Šæˆ‘ä»¬å¹¶ä¸æœŸæœ›æ‰€æœ‰è¢«é—®è¿™ä¸ªé—®é¢˜çš„äººéƒ½æœ‰å‡†ç¡®çš„å…³äºå†œæ°‘ã€å›¾ä¹¦é¦†ç®¡ç†å‘˜ä»¥åŠä»–ä»¬çš„æ€§æ ¼ç‰¹ç‚¹çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œä½†é—®é¢˜æ˜¯äººä»¬æ˜¯å¦æœ‰è€ƒè™‘è¿‡è¿™ä¸ªæ¯”ä¾‹ï¼Ÿä»è€Œè‡³å°‘èƒ½å¤Ÿè¿›è¡Œä¸€ä¸ªç²—ç•¥çš„ä¼°è®¡ã€‚ç†æ€§ä¸æ˜¯è¯´çŸ¥é“äº‹å®ï¼Œè€Œæ˜¯è®¤è¯†åˆ°å“ªäº›å› ç´ æ˜¯æœ‰å…³çš„ã€‚</p><p>å¦‚æœä½ èƒ½ç†è§£è¿™æ ·çš„æƒ³æ³•ï¼Œå³ <strong>â€œçœ‹åˆ°è¯æ®â€ é™åˆ¶äº† â€œæ¦‚ç‡ç©ºé—´â€åå†è€ƒè™‘æ¯”ä¾‹</strong>ï¼Œé‚£ä¹ˆæ­å–œä½ å·²ç»ç†è§£äº†è´å¶æ–¯å®šç†çš„ç²¾é«“ã€‚æˆ–è®¸ä½ è¦ä¼°è®¡çš„æ•°å­—å„ä¸ç›¸åŒï¼Œä½†é‡è¦çš„æ˜¯ä½ å¦‚ä½•å°†è¿™äº›æ•°å­—ç»„åˆèµ·æ¥æ ¹æ®è¯æ®æ¥æ›´æ–°ä½ çš„çœ‹æ³•ã€‚</p><h3 id="å®šä¹‰">2.2 å®šä¹‰</h3><p>è®¾äº‹ä»¶ç»„ <spanclass="math inline"><em>A</em><sub>1</sub>,â€†<em>A</em><sub>2</sub>,â€†â‹¯<em>A</em><sub><em>n</em></sub></span>ä¸ºæ ·æœ¬ç©ºé—´ <span class="math inline"><em>Î©</em></span>çš„ä¸€ä¸ªå®Œå¤‡äº‹ä»¶ç»„ï¼Œä¸” <spanclass="math inline"><em>P</em>(<em>A</em><sub><em>i</em></sub>)â€„&gt;â€„0</span>,<span class="math inline"><em>B</em></span> ä¸ºæ»¡è¶³ <spanclass="math inline"><em>P</em>(<em>B</em>)â€„&gt;â€„0</span> çš„ä»»ä¸€äº‹ä»¶ï¼Œåˆ™<span class="math display">$$P(A \mid B)=\frac{P(A) P(B \mid A)}{P(B)}$$</span> å†™æˆæ ‡å‡†å½¢å¼ <span class="math display">$$P\left(A_{i} \mid B\right)=\frac{P\left(A_{i}\right) P\left(B \midA_{i}\right)}{\sum_{i=1}^{n} P\left(A_{i}\right) P\left(B \midA_{i}\right)}$$</span> ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç§° - <spanclass="math inline"><em>P</em>(<em>A</em>|<em>B</em>)</span> æ˜¯å·²çŸ¥<span class="math inline"><em>B</em></span> å‘ç”Ÿåï¼Œ<spanclass="math inline"><em>A</em></span> çš„æ¡ä»¶æ¦‚ç‡ï¼Œä¹Ÿç§°ä½œ <spanclass="math inline"><em>A</em></span> çš„åéªŒæ¦‚ç‡ã€‚ - <spanclass="math inline"><em>P</em>(<em>A</em>)</span> æ˜¯ <spanclass="math inline"><em>A</em></span> çš„å…ˆéªŒæ¦‚ç‡ã€‚ - <spanclass="math inline"><em>P</em>(<em>B</em>|<em>A</em>)</span> æ˜¯å·²çŸ¥<span class="math inline"><em>A</em></span> å‘ç”Ÿåï¼Œ<spanclass="math inline"><em>B</em></span> çš„æ¡ä»¶æ¦‚ç‡ã€‚ä¹Ÿå¯ç§°ä¸º <spanclass="math inline"><em>B</em></span> çš„åéªŒæ¦‚ç‡ã€‚æŸäº›æ–‡çŒ®åˆç§°å…¶ä¸ºåœ¨ç‰¹å®š<span class="math inline"><em>B</em></span> æ—¶ï¼Œ<spanclass="math inline"><em>A</em></span> çš„ä¼¼ç„¶æ€§ï¼Œå› ä¸º $P(B|A)=L(A|B) $ã€‚- <span class="math inline"><em>P</em>(<em>B</em>)</span> æ˜¯ <spanclass="math inline"><em>B</em></span> çš„å…ˆéªŒæ¦‚ç‡ã€‚</p><p>å•¥ï¼Ÿçœ‹ä¸æ‡‚ï¼Ÿè«æ…Œè¿™ä¸è¿˜æœ‰æˆ‘æˆ‘ï¼Œä¸”å¬æˆ‘å¨“å¨“é“æ¥ã€‚ï¼ˆæ¦‚ç‡è®ºç¬¬äºŒç« æ¡ä»¶æ¦‚ç‡ä¹‹åå°±æ˜¯è¿™èŠ‚å†…å®¹ğŸ¤­ï¼‰</p><h3 id="ç›´è§‚ç†è§£ä¸€">2.3 ç›´è§‚ç†è§£ï¼ˆä¸€ï¼‰</h3><p>å›åˆ°å¼€ç¯‡çš„ä¾‹å­ä¸­ã€‚é—®é¢˜å¯ä»¥è½¬åŒ–ä¸º â€œç¬¦åˆæè¿°çš„ Steve æ˜¯å›¾ä¹¦ç®¡ç†å‘˜çš„æ¦‚ç‡<spanclass="math inline"><em>P</em>(<em>A</em><sub>1</sub>|<em>B</em>)</span>â€å’Œ â€œç¬¦åˆæè¿°çš„ Steve æ˜¯å†œæ°‘çš„æ¦‚ç‡ <spanclass="math inline"><em>P</em>(<em>A</em><sub>2</sub>|<em>B</em>)</span>â€å“ªä¸€ä¸ªæ›´å¤§ï¼Ÿ<br />- è®©æˆ‘ä»¬å†æ‹ä¸€ä¸‹é—®é¢˜çš„é€»è¾‘(é€†å‘):æˆ‘ä»¬è¿›è¡Œäº†ä¸€æ¬¡è§‚æµ‹/è¯•éªŒï¼Œæ€ä¹ˆè¯´éƒ½å¥½ï¼Œæ€»ä¹‹æˆ‘ä»¬æ‹¿åˆ°äº†æ–°çš„ä¿¡æ¯ â€œSteveçš„ç‰¹å¾â€ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æƒ³è¦å»æ¨ç®— <strong><em>â€œå½“ Steve ç¬¦åˆç‰¹å¾( <spanclass="math inline"><em>B</em></span> )æ—¶ï¼Œä»–æ˜¯ä¸ªå›¾ä¹¦ç®¡ç†å‘˜( <spanclass="math inline"><em>A</em><sub>1</sub></span> )çš„æ¦‚ç‡ <spanclass="math inline"><em>P</em>(<em>A</em><sub>1</sub>|<em>B</em>)</span>â€</em></strong>ã€‚<br />- æˆ–è€…æ¢ä¸ªæ–¹å‘(æ­£å‘): æˆ‘ä»¬è®¡ç®—äº‹ä»¶ <strong><em>â€œSteveæ˜¯ä¸ªç¬¦åˆæè¿°çš„å›¾ä¹¦ç®¡ç†å‘˜çš„æ¦‚ç‡ <spanclass="math inline"><em>P</em>(<em>A</em><sub>1</sub><em>B</em>)</span>â€</em></strong>å°±åº”è¯¥ç­‰ä»·äº <strong><em>â€œå‡è®¾ Steve æ˜¯ä¸ªå›¾ä¹¦ç®¡ç†å‘˜ <spanclass="math inline"><em>P</em>(<em>A</em><sub>1</sub>)</span>â€ å¹¶ä¸”â€œå›¾ä¹¦ç®¡ç†å‘˜ç¬¦åˆæè¿° <spanclass="math inline"><em>P</em>(<em>B</em>|<em>A</em><sub>1</sub>)</span>çš„æ¦‚ç‡â€</em></strong> ã€‚</p><p>é€»è¾‘æ¸…æ™°åå°±å¯ä»¥å†™å‡ºå…¬å¼äº† <span class="math display">$$P(A_1|B) = \frac{P(A_1B)}{P(B)} = \frac{P(A_1)P(B|A_1)}{P(B)}$$</span> &gt; è¿™é‡Œç¬¬ä¸€ä¸ªç­‰å·æ˜¯æ¡ä»¶æ¦‚ç‡å…¬å¼ï¼Œä¹Ÿå°±æ˜¯è¯´ P(B)æ˜¯ä½œä¸ºå½’ä¸€åŒ–ç³»æ•°å­˜åœ¨çš„ï¼Œè¿™ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆä¼šæœ‰å…¨æ¦‚ç‡å…¬å¼çš„å­˜åœ¨ã€‚å¦‚æœå½“æ—¶æ²¡å­¦æ˜ç™½å¯ä»¥çœ‹ä¸‹ä¸€éƒ¨åˆ†(å…¶å®è‡ªå·±ç”»ç”»Venn å›¾å°±çŸ¥é“äº†)ã€‚</p><p>å“‡å“¦!éå¸¸Amazingå•Š!ç«Ÿç„¶æ˜¯è´å¶æ–¯å…¬å¼è€¶ã€‚</p><p>åˆ°è¿™é‡Œå°±å¯ä»¥å¯¹å„ç§åè¯æœ‰ä¸ªç›´è§‚çš„æ„Ÿè§‰äº†ã€‚ -å…ˆéªŒæ¦‚ç‡å°±æ˜¯åœ¨æ£€éªŒå‘ç”Ÿä»¥å‰(è·å¾—æ–°çš„ä¿¡æ¯ä¹‹å‰)ï¼Œæˆ‘ä»¬å·²ç»æŒæ¡çš„ä¿¡æ¯ã€‚æœ¬ä¾‹ä¸­å°±æ˜¯â€œSteve æ˜¯ä¸ªå›¾ä¹¦ç®¡ç†å‘˜çš„æ¦‚ç‡ <spanclass="math inline"><em>P</em>(<em>A</em><sub>1</sub>)</span>â€ã€‚ -åéªŒæ¦‚ç‡å°±æ˜¯åœ¨æ£€éªŒå‘ç”Ÿä»¥å(è·å¾—æ–°çš„ä¿¡æ¯ä¹‹å)ï¼Œæˆ‘ä»¬å¯¹æ—§ä¿¡æ¯è¿›è¡Œçš„æ›´æ–°ã€‚æœ¬ä¾‹ä¸­å°±æ˜¯â€œç¬¦åˆæè¿°çš„ Steve æ˜¯å›¾ä¹¦ç®¡ç†å‘˜çš„æ¦‚ç‡ <spanclass="math inline"><em>P</em>(<em>A</em><sub>1</sub>|<em>B</em>)</span>â€ã€‚-ä¼¼ç„¶æ¦‚ç‡å°±æ˜¯å½“æ£€éªŒå‘ˆç°æŸç§ç»“æœæ—¶ï¼Œæˆ‘ä»¬å¯¹æ£€éªŒå‚æ•°çš„ä¼°è®¡æ­£ç¡®çš„å¯èƒ½æ€§ã€‚æœ¬ä¾‹ä¸­å°±æ˜¯â€œå‡è®¾å‚æ•°æ˜¯â€™å›¾ä¹¦ç®¡ç†å‘˜â€™çš„æƒ…å†µä¸‹ï¼Œæ£€éªŒç»“æœä¸ºâ€™ç¬¦åˆæè¿°â€™æ—¶ï¼Œæˆ‘ä»¬çš„å‡è®¾æ­£ç¡®çš„å¯èƒ½æ€§â€ï¼›æˆ–è€…è¯´â€œå›¾ä¹¦ç®¡ç†å‘˜ç¬¦åˆæè¿°çš„æ¦‚ç‡ <spanclass="math inline"><em>P</em>(<em>B</em>|<em>A</em><sub>1</sub>)</span>â€ã€‚</p><blockquote><p>æˆ‘çŸ¥é“ä¼¼ç„¶æ¦‚ç‡å’Œå‰ä¸¤ä¸ªç›¸æ¯”å¾ˆæŠ½è±¡ï¼Œå› ä¸ºä»–ä»¬çš„åº•å±‚é€»è¾‘æ˜¯ä¸åŒçš„ã€‚å…ˆéªŒä¸åéªŒæ¦‚ç‡å±äºâ€æ¦‚ç‡è®ºâ€ï¼Œè€Œâ€ä¼¼ç„¶æ€§â€åˆ™æ¥è‡ªä¸â€æ•°ç†ç»Ÿè®¡â€ã€‚(ç»™å‡ºå‡ ä¸ªå…³é”®è¯ï¼šæå¤§ä¼¼ç„¶æ€æƒ³ï¼Œè´¹èˆå°”ä¿¡æ¯)<br />è´å¶æ–¯ä¼°è®¡å’Œæå¤§ä¼¼ç„¶ä¼°è®¡çš„åŒºåˆ«æ˜¯ï¼šæå¤§ä¼¼ç„¶ä¼°è®¡ä¸­è¦ä¼°è®¡çš„å‚æ•°æ˜¯ä¸ªä¸€èˆ¬å˜é‡ï¼Œè€Œè´å¶æ–¯ä¼°è®¡ä¸­è¦ä¼°è®¡çš„å‚æ•°æ˜¯ä¸ªéšæœºå˜é‡ã€‚</p></blockquote><h3 id="ç›´è§‚ç†è§£äºŒ">2.4 ç›´è§‚ç†è§£ï¼ˆäºŒï¼‰</h3><p>ç°åœ¨å†æ¬¡å›åˆ°ä¾‹å­ä¸­ï¼Œä½¿ç”¨å¤å…¸æ¦‚å‹çš„æ–¹æ³•å†æ‹ä¸€éï¼š<br />å†œæ°‘æœ‰ <span class="math inline">50000</span> äººï¼Œå…¶ä¸­ <spanclass="math inline">1%</span> ç¬¦åˆæè¿°ï¼Œæ‰€ä»¥ç¬¦åˆæè¿°çš„å°±æ˜¯ <spanclass="math inline">50000â€…*â€…1%â€„=â€„500</span> äººï¼›å›¾ä¹¦ç®¡ç†å‘˜æœ‰ <spanclass="math inline">10</span> äººï¼Œå…¶ä¸­ <spanclass="math inline">90%</span> ç¬¦åˆæè¿°ï¼Œæ‰€ä»¥ç¬¦åˆæè¿°çš„å°±æ˜¯ <spanclass="math inline">10â€…*â€…90%â€„=â€„9</span> äººã€‚<br />æ‰€ä»¥ç¬¦åˆæè¿°çš„æ—¶ï¼Œæ˜¯å›¾ä¹¦ç®¡ç†å‘˜çš„æ¦‚ç‡å³ä¸º <span class="math display">$$\begin{align}    \nonumber   P(A_1|B) &amp;= \frac{(A_1) \times P(B|A_1)}{(A_1)\times P(B|A_1) +  (A_2) \times P(B|A_2)}\\    \nonumber            &amp;= \frac{10 \times 0.9}{10 \times 0.9 + 500\times 0.01}\\    \nonumber            &amp;= \frac{9}{9 + 500}\end{align}$$</span></p><p>æ‰€ä»¥è´å¶æ–¯å®šç†æ˜¯åœ¨è¯´ï¼šä½ æœ‰ä¸€äº›å‡è®¾(åƒæ˜¯â€œSteveæ˜¯ä¸ªå›¾ä¹¦ç®¡ç†å‘˜â€)ï¼ŒåŒæ—¶ä½ å¾—åˆ°äº†ä¸€äº›è¯æ®(æ¯”å¦‚ Steveæ˜¯ä¸ªæ¸©é¡ºè€Œåˆå¹¶å¹¶æœ‰æ¡çš„äºº), ç„¶ä¹ä½ æƒ³çŸ¥é“åœ¨ â€œä½ å¾—åˆ°çš„è¯æ®æ˜¯çœŸçš„â€ çš„æ¡ä»¶ä¸‹â€œä½ çš„å‡è®¾æˆç«‹â€ çš„æ¦‚ç‡ã€‚</p><h2 id="è´å¶æ–¯å­¦æ´¾-v.s.-é¢‘ç‡å­¦æ´¾">3 è´å¶æ–¯å­¦æ´¾ V.S. é¢‘ç‡å­¦æ´¾</h2><p>è´å¶æ–¯æ¨æ–­æ–¹æ³•çš„å…³é”®æ˜¯ä»»ä½•æ¨æ–­éƒ½å¿…é¡»ä¸”åªé¡»æ ¹æ®åéªŒåˆ†å¸ƒï¼Œè€Œä¸èƒ½å†æ¶‰åŠæ ·æœ¬åˆ†å¸ƒã€‚<br />è´å¶æ–¯å­¦æ´¾ä¸é¢‘ç‡å­¦æ´¾äº‰è®ºçš„ç„¦ç‚¹åœ¨äºå…ˆéªŒåˆ†å¸ƒã€‚è´å¶æ–¯å­¦æ´¾è®¤ä¸ºå…ˆéªŒåˆ†å¸ƒå¯ä»¥æ˜¯ä¸»è§‚çš„ï¼Œå®ƒä¸éœ€è¦æœ‰é¢‘ç‡è§£é‡Šã€‚è€Œé¢‘ç‡å­¦æ´¾åˆ™è®¤ä¸ºï¼Œåªæœ‰åœ¨å…ˆéªŒåˆ†å¸ƒæœ‰ä¸€ç§ä¸ä¾èµ–ä¸»è§‚çš„æ„ä¹‰ï¼Œä¸”èƒ½æ ¹æ®é€‚å½“çš„ç†è®ºæˆ–ä»¥å¾€çš„ç»éªŒå†³å®šæ—¶ï¼Œæ‰å…è®¸åœ¨ç»Ÿè®¡æ¨æ–­ä¸­ä½¿ç”¨å…ˆéªŒåˆ†å¸ƒï¼Œå¦åˆ™å°±ä¼šä¸§å¤±å®¢è§‚æ€§ã€‚<br />ï¼ˆä½†è¿™æ ·çš„è¯å…¶å®æœ‰ä¸ªæ‚–è®ºï¼šé¢‘ç‡å­¦æ´¾è¿›è¡Œé‡å¤å®éªŒæ—¶è®¤ä¸ºæ¯æ¬¡å®éªŒéƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œå¦‚æœæœ‰<spanclass="math inline"><em>P</em>(<em>A</em><em>B</em>)â€„=â€„<em>P</em>(<em>A</em>)<em>P</em>(<em>B</em>)</span>åˆ™äº‹ä»¶ç›¸äº’ç‹¬ç«‹ï¼Œè¿™é‡Œå‡å®šäº†ç‹¬ç«‹å†å»æ£€éªŒç‹¬ç«‹ï¼Œä¹Ÿå¾ˆå¥‡æ€ªã€‚ï¼‰ 1.é¢‘ç‡è®ºå…ˆå»ºç«‹æ— æ•ˆæ¨¡å‹ï¼Œç„¶åè®¡ç®—åœ¨æ­¤æ— æ•ˆæ¨¡å‹çš„å‰æä¸‹å¾—åˆ°ä»å®é™…æ•°æ®ä¸­å¾—æ¥çš„å‚æ•°çš„å¯èƒ½æ€§ï¼Œå‡å¦‚è¿™ä¸ªå¯èƒ½æ€§å¾ˆå°ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºæ— æ•ˆæ¨¡å‹ä¸æˆç«‹ï¼Œä»è€Œé€‰æ‹©å¤‡æ‹©æ¨¡å‹ï¼ˆå‡è®¾æ£€éªŒï¼‰ï¼›è€Œè´å¶æ–¯è®ºå…³æ³¨äºåœ¨å½“å‰æ•°æ®çš„å‰æä¸‹ï¼ŒæŸä¸ªæ¨¡å‹æˆç«‹çš„æ¦‚ç‡ï¼Œå¾—åˆ°çš„æ˜¯å…·ä½“çš„æ¦‚ç‡å€¼ï¼Œè€Œè¯¥æ¦‚ç‡å€¼ä¸ç”¨äºå¯¹æŸä¸ªå‡è¯´çš„åˆ¤æ–­ã€‚<br />2.é¢‘ç‡è®ºå¯¹æ¦‚ç‡çš„è§£é‡Šæ˜¯ï¼šä¸€ä¸ªäº‹ä»¶åœ¨ä¸€æ®µè¾ƒé•¿çš„æ—¶é—´å†…å‘ç”Ÿçš„é¢‘ç‡ï¼›è´å¶æ–¯è®ºå¯¹æ¦‚ç‡çš„è§£é‡Šæ˜¯äººä»¬å¯¹æŸäº‹ä»¶æ˜¯å¦å‘ç”Ÿçš„è®¤å¯ç¨‹åº¦ã€‚<br />3.è´å¶æ–¯è®ºå–„äºåˆ©ç”¨è¿‡å»çš„çŸ¥è¯†å’ŒæŠ½æ ·æ•°æ®ï¼Œè€Œé¢‘ç‡è®ºä»…ä»…åˆ©ç”¨æŠ½æ ·æ•°æ®ã€‚å› æ­¤è´å¶æ–¯æ¨è®ºä¸­å‰ä¸€æ¬¡å¾—åˆ°çš„åéªŒæ¦‚ç‡åˆ†å¸ƒå¯ä»¥ä½œä¸ºåä¸€æ¬¡çš„å…ˆéªŒæ¦‚ç‡ã€‚<br />4.å¯¹ç½®ä¿¡åŒºé—´çš„ä¸åŒè§£é‡Šï¼šé¢‘ç‡è®ºä¸­95%ç½®ä¿¡åŒºé—´è§£é‡Šä¸ºï¼š100æ¬¡æŠ½æ ·è®¡ç®—å¾—åˆ°çš„100ä¸ªç½®ä¿¡åŒºé—´ä¸­æœ‰95ä¸ªåŒ…å«äº†æ€»ä½“å‚æ•°ï¼Œ5ä¸ªæ²¡æœ‰ï¼Œè€Œä¸èƒ½è§£é‡Šæˆåœ¨ä¸€æ¬¡æŠ½æ ·ä¸­æœ‰95%çš„å¯èƒ½æ€§åŒ…å«æ€»ä½“å‚æ•°ã€‚è¿™æ˜¯ç”±äºç»å…¸ç»Ÿè®¡ä¸­æ€»ä½“çš„å‚æ•°æ˜¯è¢«å½“ä½œä¸€ä¸ªæ’å®šå€¼çš„ï¼Œä¸èƒ½ä»æ¦‚ç‡çš„è§’åº¦è§£é‡Šï¼›è´å¶æ–¯è®ºçš„ç½®ä¿¡åŒºé—´æ°å¥½å¯ä»¥è§£é‡Šæˆæ¦‚ç‡çš„å½¢å¼ï¼Œå› ä¸ºè´å¶æ–¯åˆ†æä¸­ï¼Œæ€»ä½“å‚æ•°æ˜¯ä¸ªéšæœºå˜é‡ï¼Œè€Œéæ’å®šå€¼ã€‚</p><p>è´å¶æ–¯çš„å¥½å¤„åœ¨äºè´å¶æ–¯çš„æ¨æ–­é—®é¢˜ç›¸å¯¹ç®€å•ï¼Œç‚¹ä¼°è®¡ï¼ŒåŒºé—´ä¼°è®¡å’Œå‡è®¾æ£€éªŒå…¨éƒ¨å¯ä»¥ç”±åéªŒåˆ†å¸ƒå¾—åˆ°ï¼Œå°¤å…¶æ˜¯è®¡ç®—æœºæŠ€æœ¯çš„å‘å±•å’ŒMCMC (Markov Chain Monte Carlo)æ–¹æ³•çš„å‡ºç°æä¾›äº†ä»åéªŒåˆ†å¸ƒç›´æ¥æŠ½æ ·çš„é€”å¾„,ä½¿å¾—éå…±è½­åéªŒåˆ†å¸ƒçš„ä½¿ç”¨å’Œè®¡ç®—æˆä¸ºå¯èƒ½ã€‚</p><h2 id="åè®°">4 åè®°</h2><p>å…¶å® Kahneman å’Œ Tversky è¿˜æœ‰ä¸€ä¸ªå®éªŒï¼Œå’Œ Steveçš„é‚£ä¸ªéå¸¸ç›¸ä¼¼ã€‚åœ¨è¿™ä¸ªå®éªŒä¸­ï¼Œä»–ä¿©æè¿°äº†ä¸€ä¸ªè™šæ„çš„å¥³äººï¼Œå« Lindaï¼ŒLinda31å²ã€å•èº«ã€å¦ç‡ã€è€Œä¸”éå¸¸èªæ˜ï¼Œä¸»ä¿®å“²å­¦ï¼Œä½œä¸ºä¸€åå­¦ç”Ÿï¼Œå¥¹éå¸¸å…³å¿ƒæ­§è§†å’Œç¤¾ä¼šå…¬å¹³é—®é¢˜ï¼Œè€Œä¸”è¿˜å‚åŠ åæ ¸æ¸¸è¡Œç¤ºå¨æ´»åŠ¨ã€‚</p><p>å½“äººä»¬å¬åˆ°è¿™æ ·ä¸€ä¸ªæè¿°åï¼Œè¢«é—®ä¸‹é¢å“ªä¸€ç§è¯´æ³•æ›´æœ‰å¯èƒ½ï¼šï¼ˆ1ï¼‰Lindaæ˜¯ä¸€ä¸ªé“¶è¡Œå‡ºçº³å‘˜ï¼›ï¼ˆ2ï¼‰Lindaæ˜¯ä¸€ä¸ªé“¶è¡Œå‡ºçº³å‘˜åŒæ—¶ä¹Ÿæ˜¯å¥³æƒè¿åŠ¨ä¸­çš„ä¸€ä¸ªç§¯æåˆ†å­ã€‚85%çš„å‚ä¸è€…è¯´åè€…æ›´æœ‰å¯èƒ½ï¼Œå°½ç®¡â€œæ˜¯é“¶è¡Œå‡ºçº³å‘˜åŒæ—¶ä¹Ÿæ˜¯å¥³æƒè¿åŠ¨ä¸­çš„ä¸€ä¸ªç§¯æåˆ†å­â€æ˜¯â€œé“¶è¡Œå‡ºçº³å‘˜â€çš„ä¸€ä¸ªå­é›†ã€‚</p><h2 id="å‚è€ƒæ–‡çŒ®">5 å‚è€ƒæ–‡çŒ®</h2><p><ahref="https://www.science.org/doi/10.1126/science.185.4157.1124">AmosTversky, Daniel Kahneman ,Judgment under Uncertainty: Heuristics andBiases.Science185,1124-1131(1974).DOI:10.1126/science.185.4157.1124</a></p>]]></content>
      
      
      <categories>
          
          <category> è´å¶æ–¯æ»¤æ³¢å™¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ»¤æ³¢å™¨ </tag>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è´å¶æ–¯æ»¤æ³¢å™¨ç³»åˆ—(2) - æ»‘åŠ¨æ»¤æ³¢</title>
      <link href="/2025/09/01/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2/"/>
      <url>/2025/09/01/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2/</url>
      
        <content type="html"><![CDATA[<h1 id="æ»‘åŠ¨æ»¤æ³¢">1 æ»‘åŠ¨æ»¤æ³¢</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># %matplotlib widget</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> MyFilter.MovingAverageFilter <span class="keyword">as</span> MAF</span><br><span class="line"><span class="keyword">import</span> MyFilter.FilterPerformance <span class="keyword">as</span> FP</span><br><span class="line"><span class="keyword">import</span> MyFilter.UserLib <span class="keyword">as</span> UserLib</span><br><span class="line"></span><br><span class="line">figsize=(<span class="number">25</span>, <span class="number">5</span>)</span><br></pre></td></tr></table></figure><p>åœ¨ç¬¬ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†å¯¹äºé™æ€ç›®æ ‡çš„æµ‹é‡å™ªå£°çš„æŠ‘åˆ¶æ–¹æ³•ã€‚æˆ‘ä»¬è®¤ä¸ºæµ‹é‡è¿‡ç¨‹ä¸­çš„æ‰€æœ‰ä¿¡æ¯éƒ½æ˜¯æœ‰æ•ˆä¸”å¹³æƒçš„ï¼Œæ‰€ä»¥é‡‡å–çš„æœ€ç›´æ¥çš„æ–¹æ³•â€”â€”â€”â€”ç´¯è®¡å¹³å‡ï¼ˆCumulativeAverageï¼‰ã€‚ä½†å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€é¢å¯¹ç€åŠ¨æ€è¿‡ç¨‹çš„æµ‹é‡ï¼Œæ¯”å¦‚æµ‹é‡ä¸€è¾†åŒ€åŠ é€Ÿè¿åŠ¨ä¸­å°è½¦çš„å®æ—¶é€Ÿåº¦ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œä½¿ç”¨ç´¯è®¡å¹³å‡æ¥è¿›è¡Œæ»¤æ³¢æ˜¾ç„¶æ˜¯ä¸å¯é çš„ã€‚Whyï¼Ÿ<br />1. ä»æ•°å­¦æ¨¡å‹ä¸Šæ¥è¯´ï¼ŒCAæ»¤æ³¢å™¨åœ¨å¯¹ç³»ç»Ÿå»ºæ¨¡æ—¶è®¤ä¸ºå…¶æ˜¯å®Œå…¨ä¸å˜çš„ â€”â€”â€”â€”&gt;åŒä¸€æ»¤æ³¢å™¨å¯¹ä¸åŒæ¨¡å‹çš„æ‰€è¡¨ç°å‡ºçš„æ€§èƒ½æ˜¯ä¸åŒçš„ã€‚ 2.ä»æ€§èƒ½åˆ†æä¸Šæ¥è¯´ï¼Œæ»¤æ³¢å™¨çš„æ€§èƒ½å¯ä»¥åˆ†ä¸ºé™æ€æ€§èƒ½(å¯¹å™ªå£°çš„æŠ‘åˆ¶èƒ½åŠ›)ä¸åŠ¨æ€æ€§èƒ½(å¯¹çœŸå€¼å˜åŒ–çš„è·Ÿè¸ªèƒ½åŠ›)â€”â€”â€”â€”&gt; é€‰æ‹©æ»¤æ³¢å™¨æ—¶åº”ç»¼åˆè€ƒè™‘ã€‚</p><blockquote><p>å¦‚æœåœ¨æˆ‘è‡ªå·±æµ…è–„çš„çŸ¥è¯†èŒƒå›´å†…å¯¹æ‰€æœ‰æ»¤æ³¢å™¨çš„å·¥ä½œåŸç†è¿›è¡Œåˆ†æçš„è¯åº”è¯¥æ˜¯â€”â€”â€”â€”è¿ç”¨åˆç†çš„æ•°å­¦æ–¹æ³•å¯¹ä¿¡æ¯è¿›è¡Œæå–ä¸èåˆã€‚<br />æ¯æ¬¡æµ‹é‡çš„ç»“æœéƒ½å¯ä»¥è§†ä¸º<spanclass="math inline"><em>çœŸ</em><em>å€¼</em>â€…+â€…<em>å™ª</em><em>å£°</em></span>å¯¹äºå•ä¸€ç»“æœçš„è¯æˆ‘ä»¬æ— æ³•åŒºåˆ†æ¯ç§æˆåˆ†æ‰€å çš„æ¯”ä¾‹(æˆ‘ä»¬æ‰€æ‹¥æœ‰çš„ä¿¡æ¯å¤ªå°‘äº†)ã€‚ä½†æ˜¯ï¼Œæ¯ä¸€æ¬¡æ–°çš„æµ‹é‡éƒ½ä¼šå¸¦æ¥æ–°çš„ä¿¡æ¯(æ–°æ¯åºåˆ—)ï¼Œåˆ©ç”¨åˆç†çš„æ•°å­¦æ–¹æ³•å°†å…¶ä¸­çš„ä¿¡æ¯æå–å‡ºæ¥çš„è¿‡ç¨‹ä¾¿æ˜¯æ»¤æ³¢ã€‚ä»è¿‡å»çš„æ•°æ®ä¸­æå–å‡ºä¿¡æ¯ï¼Œå†ä¸æ–°æ¯è¿›è¡Œèåˆï¼Œä»è€Œå¾—åˆ°ä¸€ä¸ªæ›´å¯é çš„æ•°å€¼ã€‚<br />&gt;æœ¬æ•™ç¨‹å¤§å¤šè®¨è®ºæ»¤æ³¢å™¨çš„æ—¶åŸŸæ€§èƒ½è€Œéé¢‘åŸŸæ€§èƒ½ï¼Œä¸€èˆ¬æ¥è¯´æ»¤æ³¢å™¨çš„æ—¶åŸŸæ€§èƒ½ä¸é¢‘åŸŸæ€§èƒ½æ˜¯äº’æ–¥çš„ã€‚è€Œæˆ‘å†™è¿™ä¸ªæ•™ç¨‹çš„åˆè¡·æ˜¯å¸Œæœ›æ–°ç”Ÿèƒ½å¤Ÿå¯¹ä¼ æ„Ÿå™¨çš„æ•°æ®(åŠ é€Ÿåº¦ã€è§’é€Ÿåº¦ã€ç£åœºå’Œç”µå‹ç­‰ç­‰ç‰©ç†é‡)è¿›è¡Œæœ‰æ•ˆæå–ï¼Œè€Œéå¯¹é¢‘åŸŸä¸Šçš„ä¿¡å·è¿›è¡Œåˆ†ç¦»ï¼Œæ•…FIRä¸IIRæ»¤æ³¢å™¨ä¸åšé‡ç‚¹è®¨è®ºã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### æ¨¡å‹å‚æ•° ###</span></span><br><span class="line"><span class="comment"># é‡‡æ ·å‚æ•°</span></span><br><span class="line">SampleFre = <span class="number">10</span></span><br><span class="line">TotalTime = <span class="number">10</span>          <span class="comment"># é‡‡æ ·æ—¶é—´ ä¸æ¨èå¤§äº10, å¢åŠ ç‚¹æ•°è¯·å¢å¤§é‡‡æ ·ç‡</span></span><br><span class="line">Step = <span class="number">1</span>/SampleFre</span><br><span class="line">SampleNum = SampleFre * TotalTime</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹å‚æ•°</span></span><br><span class="line">Model_accel = <span class="number">3</span></span><br><span class="line">Model_initialSpeed = <span class="number">5</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ModelValue, ActualValue, MeasureValue = UserLib.Model.Generative(Step, TotalTime, <span class="keyword">lambda</span> x: Model_accel * x + Model_initialSpeed)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### ç»˜å›¾å±•ç¤º ###</span></span><br><span class="line">plt.figure(figsize=figsize)</span><br><span class="line">plt.plot(ModelValue, <span class="string">&#x27;.-&#x27;</span>, label=<span class="string">&quot;Model&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(ActualValue, <span class="string">&#x27;*-&#x27;</span>, label=<span class="string">&quot;Actual&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(MeasureValue, <span class="string">&#x27;o-&#x27;</span>, label=<span class="string">&quot;Measure&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;lower right&#x27;</span>) <span class="comment">#ç»˜åˆ¶å›¾ä¾‹</span></span><br></pre></td></tr></table></figure><pre><code>&lt;matplotlib.legend.Legend at 0x780ad035ea50&gt;</code></pre><figure><imgsrc="pic/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_files/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_5_1.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><p>OKæˆ‘ä»¬ç°åœ¨å·²ç»è·å¾—äº†å¯ä»¥ç”¨æ¥ä»¿çœŸçš„æ¨¡å‹ï¼Œå¯ä»¥å¾ˆç›´è§‚çš„çœ‹åˆ°å™ªå£°çš„å½±å“å¯¹å§ã€‚ä½†åœ¨ç°å®ä¸­æˆ‘ä»¬æ ¹æœ¬ä¸å¯èƒ½è·å¾—çœŸå®çš„æ¨¡å‹ï¼Œæˆ‘ä»¬åªèƒ½çœ‹åˆ°æµ‹é‡å€¼ï¼Œæ‰€ä»¥åœ¨å·¥ç¨‹åº”ç”¨æˆ‘ä»¬è·å¾—çš„æ•°æ®å¤§æ¦‚æ˜¯è¿™ä¸ªæ ·å­çš„ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">plt.figure(figsize=figsize)</span><br><span class="line"></span><br><span class="line"><span class="comment"># def linear_regression(x, y): </span></span><br><span class="line"><span class="comment">#     N = len(x)</span></span><br><span class="line"><span class="comment">#     sumx = sum(x)</span></span><br><span class="line"><span class="comment">#     sumy = sum(y)</span></span><br><span class="line"><span class="comment">#     sumx2 = sum(x**2)</span></span><br><span class="line"><span class="comment">#     sumxy = sum(x*y)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#     A = np.asmatrix([[N, sumx], [sumx, sumx2]])</span></span><br><span class="line"><span class="comment">#     b = np.array([sumy, sumxy])</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#     return np.linalg.solve(A, b)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # ç»˜åˆ¶æ‹Ÿåˆç›´çº¿</span></span><br><span class="line"><span class="comment"># b, k = linear_regression(np.arange(0, np.size(MeasureValue)), MeasureValue)</span></span><br><span class="line"><span class="comment"># plt.plot(range(0, np.size(MeasureValue)), [k * x + b for x in range(0, np.size(MeasureValue))], &#x27;ro-&#x27;) </span></span><br><span class="line"><span class="comment"># plt.title(&quot;y = &#123;&#125; + &#123;&#125;x&quot;.format(b, k)) </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»˜åˆ¶å¸¦è¯¯å·®çº¿çš„æµ‹é‡æ•°æ®</span></span><br><span class="line">plt.errorbar(<span class="built_in">range</span>(<span class="number">0</span>, np.size(MeasureValue)), MeasureValue, yerr=np.std(MeasureValue), fmt=<span class="string">&#x27;bo&#x27;</span>, capthick=<span class="number">2</span>, capsize=<span class="number">10</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>&lt;ErrorbarContainer object of 3 artists&gt;</code></pre><figure><imgsrc="pic/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_files/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_7_1.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><p>é€šå¸¸æˆ‘ä»¬æ˜¯æ— æ³•ç¡®å®šç³»ç»Ÿçš„æ¨¡å‹çš„ã€‚åœ¨å›¾ä¸­æˆ‘ä»¬å¯ä»¥æ„Ÿè§‰åˆ°æ˜¯ä¸Šå‡è¶‹åŠ¿ï¼Œä½†å¦‚ä½•æŒ‰ç…§ä»€ä¹ˆè¶‹åŠ¿ä¸Šå‡æˆ‘ä»¬æ˜¯æ— æ³•ç¡®å®šçš„ã€‚ä¹Ÿè®¸ä½ å¯èƒ½ä¼šæƒ³ç”¨æœ€å°äºŒä¹˜æ³•æ‹Ÿåˆä¸€ä¸‹ä¸å°±èƒ½çŸ¥é“ç³»ç»Ÿçš„å¤§æ¦‚æƒ…å†µäº†ï¼Ÿå–æ¶ˆä¸Šæ–¹çš„æ³¨é‡Šï¼Œè¿è¡Œï¼Œå®Œç¾ï¼ç³»ç»Ÿçš„å‚æ•°åŸºæœ¬è¢«æˆåŠŸè¾¨è¯†å‡ºæ¥äº†ã€‚ä½†ä½ å¿½ç•¥äº†ä¸€ä¸ªå‰ææ¡ä»¶ï¼Œä¸Šæ–¹çš„æœ€å°äºŒä¹˜æ˜¯ä¸€å…ƒçº¿æ€§å›å½’ï¼Œä¹Ÿå°±æ˜¯è¯´<strong>å¼•å…¥äº†ä¸€ä¸ªå‰ææ¡ä»¶</strong>:è¿™æ˜¯ä¸€ä¸ªçº¿æ€§ç³»ç»Ÿã€‚è¿™ä¸ªå‰ææ¡ä»¶æ‰€æºå¸¦çš„ä¿¡æ¯é‡æ˜¯ååˆ†å·¨å¤§çš„ï¼Œå› æ­¤ç³»ç»Ÿæ‰èƒ½è¢«è¿‘ä¹å®Œç¾çš„è¾¨è¯†å‡ºæ¥ã€‚<br />åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥å¤§è‡´ç»™æ¥ä¸‹æ¥è¦è®²çš„æ»¤æ³¢å™¨åˆ†ä¸ºä¸¤ç±»ï¼š 1.ä¸çŸ¥é“æ¨¡å‹ï¼Œå•çº¯é€šè¿‡æŸç§å½¢å¼ä¸Šçš„ä½é€šæ»¤æ³¢å™¨æ¥å¯¹å™ªå£°è¿›è¡ŒæŠ‘åˆ¶ã€‚ 2.å‡å®šæ¨¡å‹æ˜¯çº¿æ€§çš„(æˆ–é€šè¿‡æŸç§æ–¹æ³•ä½¿æ•°æ®å˜ä¸ºçº¿æ€§åˆ†å¸ƒçš„)ï¼Œåœ¨æ¨¡å‹çš„åŸºç¡€ä¸Šå¯¹å™ªå£°è¿›è¡ŒæŠ‘åˆ¶ã€‚</p><h3 id="ç®€å•æ»‘åŠ¨æ»¤æ³¢sma-simple-moving-average">1.1 ç®€å•æ»‘åŠ¨æ»¤æ³¢(SMA,Simple Moving Average)</h3><h4 id="ä»‹ç»">1.1.1 ä»‹ç»</h4>é‚£ä¹ˆåœ¨å¹³å‡æ»¤æ³¢çš„æ¡†æ¶å†…ï¼Œå¦‚ä½•æ”¹å˜CAæ»¤æ³¢å™¨ä½¿ä¹‹å…·æœ‰æ›´å¥½çš„åŠ¨æ€æ€§èƒ½å‘¢ï¼Ÿæœ€æœ´ç´ çš„æƒ³æ³•ï¼ŒæŠŠä»¥å‰çš„æ•°æ®ä¸¢äº†ä¸å°±å¥½äº†ï¼Ÿä½ è¯´å¾—å¯¹ï¼Œæå¯¹ï¼Œæ­å–œä½ å‘ç°äº†æ»‘åŠ¨æ»¤æ³¢ã€‚<br />ç³»ç»Ÿä¸€ç‚¹çš„è¯´æ³•åº”è¯¥æ˜¯ï¼Œå¯¹äºç³»ç»Ÿå½“å‰çš„çŠ¶æ€ï¼Œæ—©æœŸæµ‹é‡å¾—åˆ°çš„æ•°æ®æ˜¯é”™è¯¯çš„ï¼Œå­˜åœ¨è¾ƒå¤§åå·®ï¼Œæä¾›äº†é”™è¯¯çš„ä¿¡æ¯ï¼Œç”¨é”™è¯¯çš„ä¿¡æ¯å½“ç„¶ä¼šå¾—åˆ°é”™è¯¯çš„ç»“è®ºï¼›è€Œæ¯”è¾ƒæ–°çš„æ•°æ®é‡Œé¢åŒ…å«çš„ä¿¡æ¯ç›¸å¯¹å‡†ç¡®ï¼Œä½¿ç”¨å‡†ç¡®çš„ä¿¡æ¯æ‰èƒ½å¾—åˆ°å‡†ç¡®çš„ç»“æœã€‚<br />è€Œå°†ä»¥å‰çš„æ•°æ®ä¸¢æ‰è¿™ä¸ªè¿‡ç¨‹ï¼Œåœ¨æ•°å­¦ä¸Šçœ‹æ¥æ˜¯ä¸€ä¸ªåŠ æƒè¿‡ç¨‹ï¼Œæ—©æœŸçš„æ•°æ®æ˜¯ä¸é‡è¦çš„ï¼Œå› æ­¤å…·æœ‰æƒå€¼â€™0â€™;è¿‘æœŸçš„æ•°æ®æ˜¯å¹³ç­‰é‡è¦çš„ï¼Œæ•…å…·æœ‰ç›¸åŒçš„æƒå€¼â€˜<spanclass="math inline">1/<em>n</em></span>â€™ã€‚ &gt;è¿™ä¸ªè¿‡ç¨‹å®é™…ä¸Šæ˜¯ä¸€ä¸ªå·ç§¯è¿‡ç¨‹ï¼Œæˆ‘ä»¬æ‰€è¯´çš„æƒå€¼çš„åˆ†å¸ƒå¯¹åº”ç€å·ç§¯æ ¸çš„æ„é€ ã€‚è¿™é‡Œå‘å¤ªæ·±ï¼Œä¸åšå±•å¼€ï¼Œä½†å¼ºçƒˆå»ºè®®å¼„æ¸…æ¥šã€‚&gt;<div align=center><blockquote><p><img src="https://upload.wikimedia.org/wikipedia/commons/b/b9/Convolution_of_spiky_function_with_box2.gif" width="941" height="250" /></p></div></blockquote><p>å¯¹ä¸€ä¸ªå·ç§¯æ ¸é•¿åº¦ä¸º n çš„ SMA æ»¤æ³¢å™¨ï¼Œå…¶æ•°å­¦å½¢å¼åº”è¯¥ä¸º <spanclass="math display">$$\hat{x} = \frac{1}{n} \cdot \sum_{i=0}^{n-1}x_{N-i}$$</span> å¼ä¸­ N ä¸ºå½“å‰é‡‡æ ·åºåˆ—é•¿åº¦(å½“å‰æ—¶åˆ»)ã€‚ä½¿ç”¨çªçœ¼æ³•å†™å‡ºé€’æ¨å…¬å¼<span class="math display">$$\hat{x} = \hat{x}_{last} + \frac{1}{n} \cdot (x_M - x_{M-n})$$</span></p><h4 id="python-å®ç°">1.1.2 python å®ç°</h4><p>SMA class åœ¨ python ä¸­çš„å®ç°å¦‚ä¸‹ <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SimpleMovingAverageFilter</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, window_size</span>):</span><br><span class="line">        <span class="variable language_">self</span>.window_size = window_size</span><br><span class="line">        <span class="variable language_">self</span>.window = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">self, new_value</span>):</span><br><span class="line">        <span class="variable language_">self</span>.window.append(new_value)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(<span class="variable language_">self</span>.window) &gt; <span class="variable language_">self</span>.window_size:</span><br><span class="line">            <span class="variable language_">self</span>.window.pop(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sum</span>(<span class="variable language_">self</span>.window) / <span class="built_in">len</span>(<span class="variable language_">self</span>.window)</span><br></pre></td></tr></table></figure> &gt;ä»…ä¾›å‚è€ƒï¼Œä»æ²¡å­¦è¿‡ pythonï¼Œå°±æ˜¯å‡­ç€æ„Ÿè§‰éšæ‰‹å†™å†™+é¢å‘è°·å“¥ç¼–ç¨‹ã€‚æŠŠé¢å‘å¯¹è±¡è¯­è¨€å½“é¢å‘è¿‡ç¨‹å†™ï¼Œä¸‘é™‹è‡³æğŸ˜“ã€‚#### 1.1.3 æ€§èƒ½åˆ†æ</p><p>è™½ç„¶ä¹‹å‰ä¸€ç›´åœ¨çŒè¾“æ€§èƒ½åŒ…å«ä¸¤éƒ¨åˆ†ï¼ˆåŠ¨æ€+é™æ€ï¼‰ï¼Œä½†åœ¨åˆ†ææ—¶åˆ†å¼€æµ‹è¯•æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚å› ä¸ºå¯¹äºå™ªå£°æ¥è¯´ï¼Œä¸€å®šæ˜¯æ»¤æ³¢æ ¸é•¿åº¦è¶Šé•¿æ•ˆæœè¶Šå¥½ï¼ŒåŒæ—¶åŠ¨æ€æ€§èƒ½ä¹Ÿåœ¨ä¸‹é™ã€‚è¿™ä¸¤éƒ¨åˆ†æ„æˆäº†ä¸€ä¸ªæœ‰æœºæ•´ä½“ï¼Œæ— æ³•ç‹¬ç«‹å»åˆ¤æ–­ï¼›è¿™ä¸¤ä¸ªæŒ‡æ ‡é™¤äº†ç†è®ºä¸Šå­˜åœ¨çš„æ„ä¹‰ä¹‹å¤–ï¼Œæ›´å¤šçš„æ˜¯åœ¨æ¨ªå‘æ¯”è¾ƒæ—¶æä¾›ä¸€ç§å‚ç…§ï¼Œå³æ»¤æ³¢å™¨a åœ¨ä»€ä¹ˆå‚æ•°ä¸‹ä¸æ»¤æ³¢å™¨ bè¿‘ä¼¼ç›¸ç­‰ã€‚æ•…åœ¨ç‹¬ç«‹åˆ†æçš„éƒ¨åˆ†ä¸­ä¸ä¼šåˆ†åˆ«è®¨è®ºé™æ€/åŠ¨æ€æ€§èƒ½ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">moveFilter = MAF.SimpleMovingAverageFilter(<span class="number">5</span>)</span><br><span class="line">FilterValue = moveFilter.refilter(MeasureValue)</span><br><span class="line"></span><br><span class="line"><span class="comment">### ç»˜å›¾å±•ç¤º ###</span></span><br><span class="line">plt.figure(figsize=figsize)</span><br><span class="line">plt.plot(ModelValue, <span class="string">&#x27;.-&#x27;</span>, label=<span class="string">&quot;Model&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(ActualValue, <span class="string">&#x27;*-&#x27;</span>, label=<span class="string">&quot;Actual&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(MeasureValue, <span class="string">&#x27;-&#x27;</span>, label=<span class="string">&quot;Measure&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(FilterValue, <span class="string">&#x27;o-&#x27;</span>, label=<span class="string">&quot;Filter&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;lower right&#x27;</span>) <span class="comment">#ç»˜åˆ¶å›¾ä¾‹</span></span><br><span class="line"></span><br><span class="line">FP.FilterPerformance.analysis(FilterValue, MeasureValue, ActualValue)</span><br></pre></td></tr></table></figure><figure><imgsrc="pic/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_files/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_11_0.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><figure><imgsrc="pic/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_files/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_11_1.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><p>ç»è¿‡æ»¤æ³¢å™¨åï¼Œå™ªå£°å—åˆ°äº†æ˜æ˜¾çš„æŠ‘åˆ¶ï¼Œå¯¹ç›®æ ‡ä¹Ÿæœ‰è¾ƒå¥½çš„è·Ÿè¸ªèƒ½åŠ›ã€‚æ¥ä¸‹æ¥è¿›è¡Œè¿›ä¸€æ­¥çš„åˆ†æã€‚é¦–å…ˆåˆ†ææ»¤æ³¢æ ¸é•¿åº¦å¯¹å™ªå£°æŠ‘åˆ¶èƒ½åŠ›çš„å½±å“ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">bias0    = []</span><br><span class="line">bias1    = []</span><br><span class="line">redratio = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">20</span>):</span><br><span class="line">    moveFilter = MAF.SimpleMovingAverageFilter(i)</span><br><span class="line">    FilterValue = moveFilter.refilter(MeasureValue)</span><br><span class="line">    bias0.append(np.mean(<span class="built_in">abs</span>(np.array(MeasureValue) - np.array(ActualValue))))</span><br><span class="line">    bias1.append(np.mean(<span class="built_in">abs</span>(np.array(FilterValue) - np.array(ActualValue))))</span><br><span class="line">    redratio.append(<span class="number">1</span> - bias1[-<span class="number">1</span>] / bias0[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">fig = plt.figure(figsize=figsize)</span><br><span class="line">ax = fig.add_subplot(<span class="number">111</span>)</span><br><span class="line">ax.plot(<span class="built_in">range</span>(<span class="number">1</span>, np.size(bias1)+<span class="number">1</span>), bias1, <span class="string">&#x27;-o&#x27;</span>, label=<span class="string">&quot;Mean abs bias&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">ax.legend(loc=<span class="string">&#x27;lower left&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ax2 = ax.twinx()</span><br><span class="line">ax2.plot(<span class="built_in">range</span>(<span class="number">1</span>, np.size(redratio)+<span class="number">1</span>), redratio, <span class="string">&#x27;-ob&#x27;</span>, label=<span class="string">&quot;Reduction ratio&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">ax2.legend(loc=<span class="string">&#x27;lower right&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.suptitle(<span class="string">f&#x27;Max average deviation reduction ratio:<span class="subst">&#123;np.array(redratio).<span class="built_in">max</span>()*<span class="number">100</span>:<span class="number">.3</span>f&#125;</span>% at <span class="subst">&#123;np.array(redratio).argmax() + <span class="number">1</span>&#125;</span>&#x27;</span>)</span><br><span class="line">plt.plot(np.array(redratio).argmax() + <span class="number">1</span>, np.array(redratio).<span class="built_in">max</span>(), <span class="string">&#x27;*g&#x27;</span>, markersize=<span class="number">10</span>)</span><br><span class="line">plt.axhline(np.array(redratio).<span class="built_in">max</span>(), color=<span class="string">&#x27;r&#x27;</span>)</span><br></pre></td></tr></table></figure><pre><code>&lt;matplotlib.lines.Line2D at 0x780acafcbb90&gt;</code></pre><figure><imgsrc="pic/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_files/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_13_1.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><blockquote><p>(è¿™é‡Œå¹¶æ²¡æœ‰å¤šæ¬¡å®éªŒæ¥å¾—åˆ°æ™®éè§„å¾‹ï¼Œå› ä¸ºæ¯æ¬¡éƒ½é‡æ–°ä»¿çœŸå¯¹æ€§èƒ½è¦æ±‚è¾ƒé«˜ã€‚ä¸å¦¨æ‰‹åŠ¨é‡æ–°è¿è¡Œå‡ æ¬¡ï¼Œ<del>ç»å¯¹ä¸æ˜¯æˆ‘æ‡’å¾—å†™ğŸ˜</del>)</p></blockquote><p>è¿™é‡Œè§„å¾‹å¤§è‡´æ˜¯ï¼š 1. æ»¤æ³¢æ ¸é•¿åº¦[1,7]:å™ªå£°å¤§å°ä¸‹é™ã€‚ä¸”å¸¦æœ‰æ˜æ˜¾çš„è¾¹é™…æ•ˆåº”ï¼Œ1<sub>3å¿«é€Ÿä¸‹é™ï¼Œ4</sub>7ä¸‹é™è¾ƒä¸ºç¼“æ…¢ã€‚2. æ»¤æ³¢æ ¸é•¿åº¦[8,13]ï¼šå™ªå£°åŸºæœ¬ä¸å˜ã€‚åœ¨è¿™æ®µåŒºé—´å†…å™ªå£°å¤§å°åŸºæœ¬ç»´æŒåœ¨å›ºå®šæ°´å¹³å†…ï¼ŒåŸå› æ˜¯æ–°æ¯æ‰€å¸¦æ¥çš„å¯¹å™ªå£°æŠ‘åˆ¶æ•ˆæœå’Œåˆ©ç”¨æ—§æ¨¡å‹å¯¹å‰çŠ¶æ€æ¨æ–­æ‰€äº§ç”Ÿçš„é”™è¯¯ç›¸æŠµæ¶ˆã€‚3. æ»¤æ³¢æ ¸é•¿åº¦[13,~]:å™ªå£°å¤§å°å¢åŠ ã€‚æ¨¡å‹çš„é”™è¯¯ä¿¡æ¯è¿‡å¤šï¼Œä½¿è¯¯å·®å¢å¤§ã€‚ä¹Ÿå¥½ç†è§£ SMAæ»¤æ³¢å™¨åœ¨æé™æƒ…å†µä¸‹å°±æ˜¯ CA æ»¤æ³¢å™¨å˜›ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸Šè¿°è§„å¾‹å¹¶ä¸æ˜¯å›ºå®šçš„ï¼Œå…¶æ½œåœ¨æ¡ä»¶ä¸å…‰æœ‰å™ªå£°çš„æ–¹å·®æ›´æœ‰æ¨¡å‹çš„å‚æ•°ï¼Œåˆ‡å‹¿æ­»è®°ç¡¬èƒŒã€‚<br />å°±åƒä¸Šä¸€èŠ‚ä½¿ç”¨ä¸­å¿ƒæé™å®šç†æ—¶ï¼Œæˆ‘æ—¢æ²¡æœ‰è¯´â€œåˆ—ç»´ï¼æ—å¾·ä¼¯æ ¼ä¸­å¿ƒæé™å®šç†â€ï¼Œä¹Ÿæ²¡æœ‰è¯´â€æ££è«å¼—ï¼æ‹‰æ™®æ‹‰æ–¯ä¸­å¿ƒæé™å®šç†â€ï¼Œè¿™ä¸¤ä¸ªæ•™æä¸Šçš„å®šç†éƒ½è¦æ±‚ç‹¬ç«‹åŒåˆ†å¸ƒï¼Œä½†æˆ‘ä»¬ä½¿ç”¨çš„åˆ™æ˜¯æ›´ä¸€èˆ¬åŒ–çš„ç»“è®ºï¼›åˆæˆ–è€…åˆšåˆšç”¨ä¸€å…ƒçº¿æ€§å›å½’ä¸¾çš„ä¾‹å­ã€‚ä¸è¦è¢«åƒåœ¾å­¦æ ¡çš„è€ƒè¯•å¸¦è·‘åï¼Œä»¥ä¸ºèƒŒèƒŒå°±å®Œäº†ï¼›å·¥ç¨‹åƒæ˜¯ä¸€åœºè§£è°œæ¸¸æˆï¼Œéœ€è¦èä¼šè´¯é€šã€å­¦ä»¥è‡´ç”¨ï¼Œå’±ç©çš„æ˜¯å››ä¸¤æ‹¨åƒæ–¤ã€‚</p><h2 id="åŠ æƒæ»‘åŠ¨æ»¤æ³¢wma-weithed-moving-average">1.2 åŠ æƒæ»‘åŠ¨æ»¤æ³¢(WMA,Weithed Moving Average)</h2><h3 id="ä»‹ç»-1">1.2.1 ä»‹ç»</h3><p>åœ¨ç®€å•æ»‘åŠ¨æ»¤æ³¢ä¸­ï¼Œæˆ‘ä»¬è®¤ä¸ºæ»¤æ³¢æ ¸å†…çš„ä¿¡æ¯æ˜¯åŒç­‰é‡è¦çš„ã€‚è€ŒåŠ æƒæ»‘åŠ¨æ»¤æ³¢åˆ™ç»™äºˆæ»¤æ³¢æ ¸å†…æ•°æ®ä¸åŒçš„æƒå€¼ã€‚ä¸€èˆ¬å¸¸è§çš„æƒå€¼æ„é€ ä¸ºä¸‰è§’å½¢ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">window_size = <span class="number">20</span></span><br><span class="line">kernel = []</span><br><span class="line">normal_Coefficient = window_size * (window_size + <span class="number">1</span>) / <span class="number">2</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(window_size):</span><br><span class="line">    kernel.append(i / normal_Coefficient)</span><br><span class="line"></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">25</span>, <span class="number">5</span>))</span><br><span class="line">ax = fig.add_subplot(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">ax.plot(kernel, <span class="string">&#x27;-o&#x27;</span>, label=<span class="string">&quot;kernel&quot;</span>, markersize=<span class="number">10</span>)</span><br><span class="line">ax.legend(loc=<span class="string">&#x27;lower right&#x27;</span>)</span><br><span class="line">plt.suptitle(<span class="string">&#x27;WMA kernel&#x27;</span>)</span><br></pre></td></tr></table></figure><pre><code>Text(0.5, 0.98, &#39;WMA kernel&#39;)</code></pre><figure><imgsrc="pic/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_files/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_16_1.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><h3 id="python-å®ç°-1">1.2.2 python å®ç°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">WeightedMovingAverageFilter</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, window_size</span>):</span><br><span class="line">        <span class="variable language_">self</span>.window_size = window_size</span><br><span class="line">        <span class="variable language_">self</span>.kernal = []</span><br><span class="line">        <span class="variable language_">self</span>.window = []</span><br><span class="line">        normal_Coefficient = window_size * (window_size + <span class="number">1</span>) / <span class="number">2</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(window_size):</span><br><span class="line">            <span class="variable language_">self</span>.kernal.append((i + <span class="number">1</span>) / normal_Coefficient)       </span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">self, new_value</span>):</span><br><span class="line">        <span class="variable language_">self</span>.window.append(new_value)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(<span class="variable language_">self</span>.window) &gt; <span class="variable language_">self</span>.window_size:</span><br><span class="line">            <span class="variable language_">self</span>.window.pop(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sum</span>([<span class="variable language_">self</span>.window[i] * <span class="variable language_">self</span>.kernal[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="variable language_">self</span>.window))])</span><br></pre></td></tr></table></figure><h3 id="æ€§èƒ½åˆ†æ">1.2.3 æ€§èƒ½åˆ†æ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">moveFilter = MAF.WeightedMovingAverageFilter(<span class="number">5</span>)</span><br><span class="line">FilterValue = moveFilter.refilter(MeasureValue)</span><br><span class="line"></span><br><span class="line"><span class="comment">### ç»˜å›¾å±•ç¤º ###</span></span><br><span class="line">plt.figure(figsize=(<span class="number">25</span>, <span class="number">5</span>))</span><br><span class="line">plt.plot(ModelValue, <span class="string">&#x27;.-&#x27;</span>, label=<span class="string">&quot;Model&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(ActualValue, <span class="string">&#x27;*-&#x27;</span>, label=<span class="string">&quot;Actual&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(MeasureValue, <span class="string">&#x27;-&#x27;</span>, label=<span class="string">&quot;Measure&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(FilterValue, <span class="string">&#x27;o-&#x27;</span>, label=<span class="string">&quot;Filter&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;lower right&#x27;</span>) <span class="comment">#ç»˜åˆ¶å›¾ä¾‹</span></span><br><span class="line"></span><br><span class="line">FP.FilterPerformance.analysis(FilterValue, MeasureValue, ActualValue)</span><br></pre></td></tr></table></figure><p>å¦‚æœåˆå€¼æ²¡æœ‰è®¾ä¸º 0çš„è¯ï¼Œåº”è¯¥å¯ä»¥æ˜æ˜¾æ³¨æ„åˆ°å‰å‡ ä¸ªç‚¹å­˜åœ¨è¿…é€Ÿä¸‹é™çš„å·¨å¤§è¯¯å·®ã€‚è¿™æ˜¯å› ä¸ºæ»¤æ³¢å™¨åˆå§‹åŒ–æ—¶çª—å£å†…éƒ¨å…¨é›¶å¡«å……å¯¼è‡´çš„ï¼Œè¿™æ®µæ—¶é—´è¢«ç§°ä¸ºæ»¤æ³¢å™¨çš„å¯åŠ¨æ—¶é—´/warm-upæ—¶é—´ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">bias0    = []</span><br><span class="line">bias1    = []</span><br><span class="line">redratio = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">20</span>):</span><br><span class="line">    moveFilter = MAF.WeightedMovingAverageFilter(i)</span><br><span class="line">    FilterValue = moveFilter.refilter(MeasureValue)</span><br><span class="line">    bias0.append(np.mean(<span class="built_in">abs</span>(np.array(MeasureValue) - np.array(ActualValue))))</span><br><span class="line">    bias1.append(np.mean(<span class="built_in">abs</span>(np.array(FilterValue) - np.array(ActualValue))))</span><br><span class="line">    redratio.append(<span class="number">1</span> - bias1[-<span class="number">1</span>] / bias0[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">fig = plt.figure(figsize=figsize)</span><br><span class="line">ax = fig.add_subplot(<span class="number">111</span>)</span><br><span class="line">ax.plot(<span class="built_in">range</span>(<span class="number">1</span>, np.size(bias1)+<span class="number">1</span>), bias1, <span class="string">&#x27;-o&#x27;</span>, label=<span class="string">&quot;Mean abs bias&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">ax.legend(loc=<span class="string">&#x27;lower left&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ax2 = ax.twinx()</span><br><span class="line">ax2.plot(<span class="built_in">range</span>(<span class="number">1</span>, np.size(redratio)+<span class="number">1</span>), redratio, <span class="string">&#x27;-ob&#x27;</span>, label=<span class="string">&quot;Reduction ratio&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">ax2.legend(loc=<span class="string">&#x27;lower right&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.suptitle(<span class="string">f&#x27;Max average deviation reduction ratio:<span class="subst">&#123;np.array(redratio).<span class="built_in">max</span>()*<span class="number">100</span>:<span class="number">.3</span>f&#125;</span>% at <span class="subst">&#123;np.array(redratio).argmax() + <span class="number">1</span>&#125;</span>&#x27;</span>)</span><br><span class="line">plt.plot(np.array(redratio).argmax() + <span class="number">1</span>, np.array(redratio).<span class="built_in">max</span>(), <span class="string">&#x27;*g&#x27;</span>, markersize=<span class="number">10</span>)</span><br><span class="line">plt.axhline(np.array(redratio).<span class="built_in">max</span>(), color=<span class="string">&#x27;r&#x27;</span>)</span><br></pre></td></tr></table></figure><pre><code>&lt;matplotlib.lines.Line2D at 0x780ad314a270&gt;</code></pre><figure><imgsrc="pic/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_files/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_20_1.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><h2 id="æŒ‡æ•°æ»‘åŠ¨æ»¤æ³¢ema-exponential-moving-average">1.3æŒ‡æ•°æ»‘åŠ¨æ»¤æ³¢(EMA, Exponential Moving Average)</h2><h3 id="ä»‹ç»-2">1.3.1 ä»‹ç»</h3><h4 id="è¡¨è¾¾å¼çš„æ¨å¯¼">1.3.1.1 è¡¨è¾¾å¼çš„æ¨å¯¼</h4><p>æŒ‡æ•°æ»‘åŠ¨æ»¤æ³¢æ˜¯ä»¥æŒ‡æ•°å½¢å¼æ„é€ å…¶æ»¤æ³¢æ ¸çš„æ»¤æ³¢å™¨ã€‚å„æ•°å€¼çš„åŠ æƒå½±å“åŠ›éšæ—¶é—´è€ŒæŒ‡æ•°å¼é€’å‡ï¼Œè¶Šè¿‘æœŸçš„æ•°æ®åŠ æƒå½±å“åŠ›è¶Šé‡ï¼Œä½†è¾ƒæ—§çš„æ•°æ®ä¹Ÿç»™äºˆä¸€å®šçš„åŠ æƒå€¼ã€‚æ ¹æ®å®šä¹‰ç›´æ¥å†™å‡ºå…¶æƒé‡åºåˆ—<span class="math inline">{<em>w</em><sub><em>i</em></sub>}</span>åŠä¼°å€¼è¡¨è¾¾å¼ <span class="math inline"><em>xÌ‚</em></span> <spanclass="math display">$$w_i = \frac{(1-\alpha)^i}{\sum_{i=0}^n{(1-\alpha)^i}}$$</span> <span class="math display">$$\hat{x}_{n+1} = \frac{(1-\alpha)^0x_{n+1} + (1-\alpha)^1x_{n} +(1-\alpha)^2x_{n-1} + \cdots +(1-\alpha)^nx_{1}}{\sum_{i=0}^n{(1-\alpha)^i}}$$</span> æ³¨æ„åˆ° <span class="math display">$$\lim_{n-&gt;\infty}\sum_{i=0}^n{(1-\alpha)^i} = \lim_{n-&gt;\infty}\frac{1 \cdot (1 - (1-\alpha)^n)}{1 - (1-\alpha)} = \frac {1}{\alpha}$$</span> æ‰€ä»¥åœ¨æé™æƒ…å†µä¸‹ï¼Œä¼°å€¼è¡¨è¾¾å¼å˜ä¸º <span class="math display">$$\begin{align}    \nonumber   \lim_{n\to \infty} \hat{x}_{n+1} &amp;= \alpha \cdot(x_{n+1} + (1-\alpha)^1x_{n} + \cdots + (1-\alpha)^nx_{1})\\    \nonumber   \lim_{n\to \infty} \hat{x}_{n+1} &amp;= \alpha \cdotx_{n+1} + (1-\alpha) \cdot [ \alpha \cdot (x_{n} + (1-\alpha)^1x_{n-1} +\cdots + (1-\alpha)^{n-1}x_{1})]\\    \nonumber   \lim_{n\to \infty} \hat{x}_{n+1} &amp;= \alpha \cdotx_{n+1} + (1-\alpha) \cdot \hat{x}_{n}\\    \nonumber   \lim_{n\to \infty} \hat{x}_{n+1} &amp;= \hat{x}_{n} +\alpha \cdot (x_{n+1} - \hat{x}_{n})\end{align}$$</span> è‡³æ­¤æˆ‘ä»¬å·²ç»å¾—åˆ°äº†å…·æœ‰åº”ç”¨ä»·å€¼çš„æŒ‡æ•°æ»¤æ³¢çš„é€’æ¨è¡¨è¾¾å¼ã€‚ ####1.3.1.2 åŠè¡°æœŸ <span class="math display">$$\begin{align}   \nonumber   1 - (1-\alpha)^k &amp; = \frac{1}{2}\\   \nonumber   (1-\alpha)^k &amp; = \frac{1}{2}\\   \nonumber   k &amp; = -\ln {2} / \ln{(1-\alpha)}\\\end{align}$$</span></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">k = []</span><br><span class="line">com = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>, <span class="number">1</span>):</span><br><span class="line">    k.append(- np.log(<span class="number">2</span>) / np.log(<span class="number">1</span> - i/<span class="number">100</span>))</span><br><span class="line">    com.append((<span class="number">1</span> - i/<span class="number">100</span>) / i/<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">fig = plt.figure(figsize=figsize)</span><br><span class="line">ax = fig.add_subplot(<span class="number">111</span>)</span><br><span class="line">ax.plot([i/<span class="number">100</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>, <span class="number">1</span>)], k, <span class="string">&#x27;.-g&#x27;</span>, label=<span class="string">&quot;k&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">ax.legend(loc=<span class="string">&#x27;lower left&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ax2 = ax.twinx()</span><br><span class="line">ax2.plot([i/<span class="number">100</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>, <span class="number">1</span>)], com, <span class="string">&#x27;*-&#x27;</span>, label=<span class="string">&quot;com&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">ax2.legend(loc=<span class="string">&#x27;lower right&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.grid(<span class="literal">True</span>)</span><br><span class="line">plt.suptitle(<span class="string">&quot;Half-life of EMA &amp; Center of Mass&quot;</span>)</span><br></pre></td></tr></table></figure><pre><code>Text(0.5, 0.98, &#39;Half-life of EMA &amp; Center of Mass&#39;)</code></pre><figure><imgsrc="pic/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_files/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_22_1.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><h4 id="è´¨å¿ƒ-com-center-of-mass">1.3.1.3 è´¨å¿ƒ (COM, Center Of Mass)</h4><p>ç”±è´¨å¿ƒå…¬å¼æœ‰ <span class="math display">$$\frac{\sum_{i=1}^{n} x_{i} m_{i}}{\sum_{i=1}^{n} m_{i}} =\sum_{i=0}^{\infty} i \cdot (1-\alpha)^i = x_{COM}$$</span> ç”±é«˜ä¸­å­¦è¿‡çš„é”™ä½ç›¸å‡æœ‰ <span class="math display">$$\begin{align}    \nonumber   x_{COM} - (1-\alpha) x_{COM} &amp; = \sum_{i=0}^{\infty} i \cdot (1-\alpha)^i - \sum_{i = 1}^{\infty} (i-1) \cdot(1-\alpha)^{i+1}\\    \nonumber   \alpha \cdot x_{COM} &amp; = (1-\alpha) -\lim_{i\to\infty}(i-1) \cdot (1-\alpha)^i\\    \nonumber   x_{COM} &amp; = \frac{(1-\alpha)}{ \alpha}\end{align}$$</span> è´¨å¿ƒè¡¨å¾äº†â€œæ•°æ®çš„é‡å¿ƒâ€,æ˜¾ç„¶è´¨å¿ƒè¶Šå°è¯´æ˜ä¼°è®¡å€¼è¶Šæ¥è¿‘æµ‹é‡å€¼ï¼ŒåŠè¡°æœŸè¶Šå°ã€‚ä½†é—®é¢˜æ˜¯è´¨å¿ƒä¸å¤Ÿç›´è§‚ï¼Œä¸ºäº†è®©å…¶å…·æœ‰æ›´æµ…æ˜¾çš„ç‰©ç†æ„ä¹‰ï¼Œæˆ‘ä»¬å°†å…¶æ˜ å°„ä¸ºSMA æ»¤æ³¢æ ¸é•¿åº¦ L ã€‚<br />å‡å®š SMA ä¸ EMA æ»¤æ³¢æ ¸å…·æœ‰ç›¸åŒè´¨å¿ƒï¼Œåˆ™æœ‰ <span class="math display">$$\begin{align}    \nonumber   x_{COM, EMA} &amp;= x_{COM, SMA}\\    \nonumber   \frac{1-\alpha}{\alpha} &amp;= \frac{L}{2}\\    \nonumber   \alpha &amp;= \frac{2}{L+2}\end{align}$$</span></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">alpha = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">21</span>):</span><br><span class="line">    alpha.append(<span class="number">2</span> / (i + <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">fig = plt.figure(figsize=figsize)</span><br><span class="line">plt.plot(<span class="built_in">range</span>(<span class="number">1</span>, <span class="number">21</span>), alpha, <span class="string">&#x27;-o&#x27;</span>, label=<span class="string">&quot;alpha&quot;</span>, markersize=<span class="number">5</span>)</span><br></pre></td></tr></table></figure><pre><code>[&lt;matplotlib.lines.Line2D at 0x780ad33a0860&gt;]</code></pre><figure><imgsrc="pic/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_files/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_24_1.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><h3 id="python-å®ç°-2">1.3.2 python å®ç°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ExponentialMovingAverageFilter</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, alpha</span>):</span><br><span class="line">        <span class="variable language_">self</span>.alpha = alpha</span><br><span class="line">        <span class="variable language_">self</span>.previous_value = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">self, new_value</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.previous_value <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="variable language_">self</span>.previous_value = new_value</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="variable language_">self</span>.previous_value = <span class="variable language_">self</span>.alpha * new_value + (<span class="number">1</span> - <span class="variable language_">self</span>.alpha) * <span class="variable language_">self</span>.previous_value</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.previous_value</span><br></pre></td></tr></table></figure><h3 id="æ€§èƒ½åˆ†æ-1">1.3.3 æ€§èƒ½åˆ†æ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">moveFilter = MAF.ExponentialMovingAverageFilter(<span class="number">0.5</span>)</span><br><span class="line">FilterValue = moveFilter.refilter(MeasureValue)</span><br><span class="line"></span><br><span class="line"><span class="comment">### ç»˜å›¾å±•ç¤º ###</span></span><br><span class="line">plt.figure(figsize=(<span class="number">25</span>, <span class="number">5</span>))</span><br><span class="line">plt.plot(ModelValue, <span class="string">&#x27;.-&#x27;</span>, label=<span class="string">&quot;Model&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(ActualValue, <span class="string">&#x27;*-&#x27;</span>, label=<span class="string">&quot;Actual&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(MeasureValue, <span class="string">&#x27;-&#x27;</span>, label=<span class="string">&quot;Measure&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(FilterValue, <span class="string">&#x27;o-&#x27;</span>, label=<span class="string">&quot;Filter&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;lower right&#x27;</span>) <span class="comment">#ç»˜åˆ¶å›¾ä¾‹</span></span><br><span class="line"></span><br><span class="line">FP.FilterPerformance.analysis(FilterValue, MeasureValue, ActualValue)</span><br></pre></td></tr></table></figure><figure><imgsrc="pic/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_files/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_26_0.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><figure><imgsrc="pic/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_files/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_26_1.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">bias0    = []</span><br><span class="line">bias1    = []</span><br><span class="line">redratio = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>, <span class="number">1</span>):</span><br><span class="line">    moveFilter = MAF.ExponentialMovingAverageFilter(i/<span class="number">100</span>)</span><br><span class="line">    FilterValue = moveFilter.refilter(MeasureValue)</span><br><span class="line">    bias0.append(np.mean(<span class="built_in">abs</span>(np.array(MeasureValue) - np.array(ActualValue))))</span><br><span class="line">    bias1.append(np.mean(<span class="built_in">abs</span>(np.array(FilterValue) - np.array(ActualValue))))</span><br><span class="line">    redratio.append(<span class="number">1</span> - bias1[-<span class="number">1</span>] / bias0[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">fig = plt.figure(figsize=figsize)</span><br><span class="line">ax = fig.add_subplot(<span class="number">111</span>)</span><br><span class="line">ax.plot([i/<span class="number">100</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>, <span class="number">1</span>)], bias1, <span class="string">&#x27;-o&#x27;</span>, label=<span class="string">&quot;Mean abs bias&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">ax.legend(loc=<span class="string">&#x27;lower left&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ax2 = ax.twinx()</span><br><span class="line">ax2.plot([i/<span class="number">100</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>, <span class="number">1</span>)],redratio, <span class="string">&#x27;-ob&#x27;</span>, label=<span class="string">&quot;Reduction ratio&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">ax2.legend(loc=<span class="string">&#x27;lower right&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.suptitle(<span class="string">f&#x27;Max average deviation reduction ratio:<span class="subst">&#123;np.array(redratio).<span class="built_in">max</span>()*<span class="number">100</span>:<span class="number">.3</span>f&#125;</span>% at <span class="subst">&#123;(np.array(redratio).argmax() + <span class="number">1</span>)/<span class="number">100</span>&#125;</span>&#x27;</span>)</span><br><span class="line">plt.plot(np.array(redratio).argmax()/<span class="number">100</span> , np.array(redratio).<span class="built_in">max</span>(), <span class="string">&#x27;*g&#x27;</span>, markersize=<span class="number">10</span>)</span><br><span class="line">plt.axhline(np.array(redratio).<span class="built_in">max</span>(), color=<span class="string">&#x27;r&#x27;</span>)</span><br></pre></td></tr></table></figure><pre><code>&lt;matplotlib.lines.Line2D at 0x780ad01370b0&gt;</code></pre><figure><imgsrc="pic/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_files/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_27_1.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><h2 id="äºŒé˜¶æŒ‡æ•°æ»‘åŠ¨æ»¤æ³¢dema-double-exponential-moving-average">1.4äºŒé˜¶æŒ‡æ•°æ»‘åŠ¨æ»¤æ³¢(DEMA, Double Exponential Moving Average)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">moveFilter = MAF.DoubleExponentialMovingAverageFilter(<span class="number">0.22</span>)</span><br><span class="line">FilterValue = moveFilter.refilter(MeasureValue)</span><br><span class="line"></span><br><span class="line"><span class="comment">### ç»˜å›¾å±•ç¤º ###</span></span><br><span class="line">plt.figure(figsize=(<span class="number">25</span>, <span class="number">5</span>))</span><br><span class="line">plt.plot(ModelValue, <span class="string">&#x27;.-&#x27;</span>, label=<span class="string">&quot;Model&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(ActualValue, <span class="string">&#x27;*-&#x27;</span>, label=<span class="string">&quot;Actual&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(MeasureValue, <span class="string">&#x27;-&#x27;</span>, label=<span class="string">&quot;Measure&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(FilterValue, <span class="string">&#x27;o-&#x27;</span>, label=<span class="string">&quot;Filter&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;lower right&#x27;</span>) <span class="comment">#ç»˜åˆ¶å›¾ä¾‹</span></span><br><span class="line"></span><br><span class="line">FP.FilterPerformance.analysis(FilterValue, MeasureValue, ActualValue)</span><br></pre></td></tr></table></figure><figure><imgsrc="pic/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_files/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_29_0.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><figure><imgsrc="pic/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_files/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_29_1.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">bias0    = []</span><br><span class="line">bias1    = []</span><br><span class="line">redratio = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>, <span class="number">1</span>):</span><br><span class="line">    moveFilter = MAF.DoubleExponentialMovingAverageFilter(i/<span class="number">100</span>)</span><br><span class="line">    FilterValue = moveFilter.refilter(MeasureValue)</span><br><span class="line">    bias0.append(np.mean(<span class="built_in">abs</span>(np.array(MeasureValue) - np.array(ActualValue))))</span><br><span class="line">    bias1.append(np.mean(<span class="built_in">abs</span>(np.array(FilterValue) - np.array(ActualValue))))</span><br><span class="line">    redratio.append(<span class="number">1</span> - bias1[-<span class="number">1</span>] / bias0[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">fig = plt.figure(figsize=figsize)</span><br><span class="line">ax = fig.add_subplot(<span class="number">111</span>)</span><br><span class="line">ax.plot([i/<span class="number">100</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, bias1.__len__() + <span class="number">1</span>, <span class="number">1</span>)], bias1, <span class="string">&#x27;-o&#x27;</span>, label=<span class="string">&quot;Mean abs bias&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">ax.legend(loc=<span class="string">&#x27;lower left&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ax2 = ax.twinx()</span><br><span class="line">ax2.plot([i/<span class="number">100</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, redratio.__len__() + <span class="number">1</span>, <span class="number">1</span>)],redratio, <span class="string">&#x27;-ob&#x27;</span>, label=<span class="string">&quot;Reduction ratio&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">ax2.legend(loc=<span class="string">&#x27;lower right&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.suptitle(<span class="string">f&#x27;Max average deviation reduction ratio:<span class="subst">&#123;np.array(redratio).<span class="built_in">max</span>()*<span class="number">100</span>:<span class="number">.3</span>f&#125;</span>% at <span class="subst">&#123;(np.array(redratio).argmax() + <span class="number">1</span>)/<span class="number">100</span>&#125;</span>&#x27;</span>)</span><br><span class="line">plt.plot(np.array(redratio).argmax()/<span class="number">100</span> , np.array(redratio).<span class="built_in">max</span>(), <span class="string">&#x27;*g&#x27;</span>, markersize=<span class="number">10</span>)</span><br><span class="line">plt.axhline(np.array(redratio).<span class="built_in">max</span>(), color=<span class="string">&#x27;r&#x27;</span>)</span><br></pre></td></tr></table></figure><pre><code>&lt;matplotlib.lines.Line2D at 0x780acafeacc0&gt;</code></pre><figure><imgsrc="pic/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_files/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_30_1.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><h2 id="é€‚åº”æ€§çŸ©ä¼°è®¡-adam-adaptive-moment-estimation">1.5 é€‚åº”æ€§çŸ©ä¼°è®¡(ADAM, adaptive moment estimation)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">moveFilter = MAF.AdaptivemDmentEstimation(<span class="number">0.96</span>)</span><br><span class="line">FilterValue = moveFilter.refilter(MeasureValue)</span><br><span class="line"></span><br><span class="line"><span class="comment">### ç»˜å›¾å±•ç¤º ###</span></span><br><span class="line">plt.figure(figsize=(<span class="number">25</span>, <span class="number">5</span>))</span><br><span class="line">plt.plot(ModelValue, <span class="string">&#x27;.-&#x27;</span>, label=<span class="string">&quot;Model&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(ActualValue, <span class="string">&#x27;*-&#x27;</span>, label=<span class="string">&quot;Actual&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(MeasureValue, <span class="string">&#x27;-&#x27;</span>, label=<span class="string">&quot;Measure&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(FilterValue, <span class="string">&#x27;o-&#x27;</span>, label=<span class="string">&quot;Filter&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;lower right&#x27;</span>) <span class="comment">#ç»˜åˆ¶å›¾ä¾‹</span></span><br><span class="line"></span><br><span class="line">FP.FilterPerformance.analysis(FilterValue, MeasureValue, ActualValue)</span><br></pre></td></tr></table></figure><figure><imgsrc="pic/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_files/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_32_0.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><figure><imgsrc="pic/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_files/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_32_1.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">bias0    = []</span><br><span class="line">bias1    = []</span><br><span class="line">redratio = []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">20000</span>, <span class="number">1</span>):</span><br><span class="line">    moveFilter = MAF.AdaptivemDmentEstimation(i/<span class="number">10000</span>)</span><br><span class="line">    FilterValue = moveFilter.refilter(MeasureValue)</span><br><span class="line">    bias0.append(np.mean(<span class="built_in">abs</span>(np.array(MeasureValue) - np.array(ActualValue))))</span><br><span class="line">    bias1.append(np.mean(<span class="built_in">abs</span>(np.array(FilterValue) - np.array(ActualValue))))</span><br><span class="line">    redratio.append(<span class="number">1</span> - bias1[-<span class="number">1</span>] / bias0[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">fig = plt.figure(figsize=figsize)</span><br><span class="line">ax = fig.add_subplot(<span class="number">111</span>)</span><br><span class="line">ax.plot([i/<span class="number">10000</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, bias1.__len__() + <span class="number">1</span>, <span class="number">1</span>)], bias1, <span class="string">&#x27;-o&#x27;</span>, label=<span class="string">&quot;Mean abs bias&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">ax.legend(loc=<span class="string">&#x27;lower left&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ax2 = ax.twinx()</span><br><span class="line">ax2.plot([i/<span class="number">10000</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, bias1.__len__() + <span class="number">1</span>, <span class="number">1</span>)],redratio, <span class="string">&#x27;-ob&#x27;</span>, label=<span class="string">&quot;Reduction ratio&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">ax2.legend(loc=<span class="string">&#x27;lower right&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.suptitle(<span class="string">f&#x27;Max average deviation reduction ratio:<span class="subst">&#123;np.array(redratio).<span class="built_in">max</span>()*<span class="number">100</span>:<span class="number">.3</span>f&#125;</span>% at <span class="subst">&#123;(np.array(redratio).argmax() + <span class="number">1</span>)/<span class="number">10000</span>&#125;</span>&#x27;</span>)</span><br><span class="line">plt.plot(np.array(redratio).argmax()/<span class="number">10000</span> , np.array(redratio).<span class="built_in">max</span>(), <span class="string">&#x27;*g&#x27;</span>, markersize=<span class="number">10</span>)</span><br><span class="line">plt.axhline(np.array(redratio).<span class="built_in">max</span>(), color=<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># x = x = np.outer(np.linspace(0, 1, 100), np.ones(100))</span></span><br><span class="line"><span class="comment"># y = x.copy().T</span></span><br><span class="line"><span class="comment"># z = np.zeros((100, 100))</span></span><br><span class="line"><span class="comment"># zz = []</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># for k in range(100, 200, 1):</span></span><br><span class="line"><span class="comment">#     for i in range(1, 100, 1):</span></span><br><span class="line"><span class="comment">#         beta1 = i/100</span></span><br><span class="line"><span class="comment">#         for j in range(1, 100, 1):</span></span><br><span class="line"><span class="comment">#             beta2 = j/100</span></span><br><span class="line"><span class="comment">#             moveFilter = MAF.AdaptivemDmentEstimation(k/100)</span></span><br><span class="line"><span class="comment">#             FilterValue = moveFilter.refilter(MeasureValue)</span></span><br><span class="line"><span class="comment">#             bias0 = np.mean(abs(np.array(MeasureValue) - np.array(ActualValue)))</span></span><br><span class="line"><span class="comment">#             bias1 = np.mean(abs(np.array(FilterValue) - np.array(ActualValue)))</span></span><br><span class="line"><span class="comment">#             z[i][j] = (1 - (bias1 / bias0))</span></span><br><span class="line"><span class="comment">#             zz.append(z.max())</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># fig = plt.figure(figsize=(20, 20))</span></span><br><span class="line"><span class="comment"># ax = plt.axes(projection=&#x27;3d&#x27;)</span></span><br><span class="line"><span class="comment"># ax.plot_surface(x, y, z)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(z.max())</span></span><br><span class="line"><span class="comment"># print(np.array(zz).max())</span></span><br></pre></td></tr></table></figure><pre><code>&lt;matplotlib.lines.Line2D at 0x780ad00ea930&gt;</code></pre><figure><imgsrc="pic/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_files/1_1.%E6%BB%91%E5%8A%A8%E6%BB%A4%E6%B3%A2_33_1.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><h2 id="å‚è€ƒæ–‡çŒ®">2 å‚è€ƒæ–‡çŒ®</h2><p><a href="https://www.lamda.nju.edu.cn/yehj/tsa2022/">Han-Jia Ye. TimeSeries Analysis. 2022</a><br /><a href="https://arxiv.org/pdf/1412.6980">Diederik P. Kingma and JimmyBa, Adam: A Method for Stochastic Optimization[C], 2017,1412(6980)</a><br /><ahref="https://z.library.sh.cn/next/resource/eds/detail?vid=e_ZWRzanNy%23ZWRzanNyLjE2NjgxNA%3D%3D">Brown.Robert G. et al, The Fundamental Theorem of Exponential Smoothing[J],1961, 9(5): 673â€“687</a></p>]]></content>
      
      
      <categories>
          
          <category> è´å¶æ–¯æ»¤æ³¢å™¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ»¤æ³¢å™¨ </tag>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è´å¶æ–¯æ»¤æ³¢å™¨ç³»åˆ—(1) - Hello Filter</title>
      <link href="/2025/09/01/0_1.Hallo%20Filter/"/>
      <url>/2025/09/01/0_1.Hallo%20Filter/</url>
      
        <content type="html"><![CDATA[<h1 id="hallo-filter">Hallo Filter</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> stats</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment"># %matplotlib ipympl</span></span><br><span class="line"><span class="comment"># %matplotlib widget</span></span><br><span class="line"></span><br><span class="line">figsize=(<span class="number">20</span>, <span class="number">5</span>)</span><br></pre></td></tr></table></figure><h3 id="å™ªå£°çš„æ•°å­¦æ¨¡å‹">1 å™ªå£°çš„æ•°å­¦æ¨¡å‹</h3><p>å…ˆæ¥å›æƒ³ä¸€ä¸‹ï¼Œå°å­¦æ•°å­¦é‡Œæµ‹é‡ä¸€ä¸ªç‰©ä½“çš„é•¿åº¦ã€é‡é‡å·´æ‹‰å·´æ‹‰ç­‰ç‰©ç†é‡æ—¶ä¸ºäº†å‡å°è¯¯å·®çš„æ–¹æ³•æ˜¯â€”â€”â€”â€”å¤šæ¬¡æµ‹é‡å–å¹³å‡å€¼ã€‚æ‰€ä»¥å¤šæ¬¡æµ‹é‡å–å¹³å‡å€¼æ˜¯æ€ä¹ˆå‡å°è¯¯å·®çš„å‘¢ï¼Ÿ</p><h4 id="å™ªå£°å»ºæ¨¡">1.1 å™ªå£°å»ºæ¨¡</h4><p><strong>ä¸­å¿ƒæé™å®šç†</strong>å‘Šè¯‰æˆ‘ä»¬:åªè¦éšæœºå˜é‡ç›¸äº’ç‹¬ç«‹ï¼Œæ¯ä¸ªéšæœºå˜é‡å¯¹å’Œçš„å½±å“éƒ½æ˜¯å¾®å°çš„ï¼Œå“ªæ€•å®ƒä»¬çš„åˆ†å¸ƒç±»å‹ä¸åŒï¼Œå…¶å’Œæ ‡å‡†åŒ–åéƒ½æœ‰æ ‡å‡†æ­£æ€çš„æé™åˆ†å¸ƒã€‚è¯å¥è¯è¯´ï¼ŒæŸä¸€äº‹ä»¶å—åˆ°è®¸å¤šç›¸äº’ç‹¬ç«‹ä¸”å¾®å°çš„éšæœºå› ç´ å½±å“ï¼Œæ€»çš„å½±å“å°±å¯ä»¥çœ‹ä½œæœä»æˆ–è¿‘ä¼¼æœä»æ­£æ€åˆ†å¸ƒã€‚<br />ä¸å¦¨æ¥ä»¿çœŸä¸€ä¸‹ï¼Œä¸‹è¿°ä»£ç æµ‹è¯•è®¡ç®—äº† 50000 æ¬¡éšæœºäº‹ä»¶ï¼Œæ¯æ¬¡éšæœºäº‹ä»¶å‡ä¸º100 æ¬¡å¹³å‡åˆ†å¸ƒçš„éšæœºå˜é‡ä¹‹å’Œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»˜åˆ¶æ ‡å‡†æ­£æ€åˆ†å¸ƒæ›²çº¿</span></span><br><span class="line">u = <span class="number">0</span></span><br><span class="line">sig = math.sqrt(<span class="number">1</span>)</span><br><span class="line">x = np.linspace(u - <span class="number">3</span>*sig, u + <span class="number">3</span>*sig)</span><br><span class="line">y = np.exp(-(x - u) ** <span class="number">2</span> / (<span class="number">2</span> * sig ** <span class="number">2</span>)) / (math.sqrt(<span class="number">2</span>*math.pi)*sig)</span><br><span class="line">plt.figure(figsize=figsize)</span><br><span class="line">plt.plot(x, y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸­å¿ƒæé™å®šç†ä»¿çœŸ</span></span><br><span class="line">a = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50000</span>):</span><br><span class="line">    a.append(np.<span class="built_in">sum</span>(np.random.uniform(<span class="number">10</span>, <span class="number">20</span>, <span class="number">100</span>)))</span><br><span class="line">a = (a - np.average(a)) / np.std(a)</span><br><span class="line">plt.hist(a, <span class="number">100</span>, density=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><figure><img src="pic/0_1.Hallo%20Filter_files/0_1.Hallo%20Filter_3_1.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><p>éå¸¸amazingå•Šï¼å‡åŒ€åˆ†å¸ƒçš„éšæœºäº‹ä»¶é¢‘ç‡åˆ†å¸ƒç›´æ–¹å›¾ç«Ÿç„¶è¢«æ ‡å‡†æ­£æ€åˆ†å¸ƒå‡½æ•°å®Œç¾çš„åŒ…ç»œäº†ã€‚<br />è¿™ä¾¿æ˜¯æ­£æ€åˆ†å¸ƒåœ¨ç”Ÿæ´»ä¸­å¦‚æ­¤å¸¸è§çš„åŸå› ã€‚ç»§ç»­ä»¥æµ‹é‡è¯¯å·®ä¸ºä¾‹ï¼Œå…¶å—åˆ°è®¸å¤šç›¸äº’ç‹¬ç«‹éšæœºå› ç´ çš„å½±å“ï¼Œå¦‚æµ‹é‡ç¯å¢ƒæ¸©åº¦ã€æ¹¿åº¦ï¼Œæµ‹é‡å·¥å…·çš„ç²¾å¯†ç¨‹åº¦ä»¥åŠæµ‹é‡è€…çš„å¿ƒç†å› ç´ ã€æµ‹é‡çš„æ€åº¦ç­‰çš„å½±å“ï¼Œè€Œæ¯ç§å½±å“éƒ½ä¸å ä¸»è¦åœ°ä½ï¼Œé‚£ä¹ˆå®ƒä»¬æ€»å’Œé€ æˆçš„æ€»è¯¯å·®å°±è¿‘ä¼¼åœ°æœä»æ­£æ€åˆ†å¸ƒã€‚</p><h4 id="å¤šæ¬¡æµ‹é‡çš„ä½œç”¨">1.2 å¤šæ¬¡æµ‹é‡çš„ä½œç”¨</h4><p>ç°åœ¨æˆ‘ä»¬çŸ¥é“è¯¯å·®åœ¨æ•°å­¦ä¸Šçš„æ¨¡å‹äº†ï¼Œä½†å¤šæ¬¡æµ‹é‡ä¸ºä»€ä¹ˆèƒ½å‡å°è¯¯å·®å‘¢ï¼Ÿ(ä¸¥è°¨ä¸€ç‚¹çš„è¯åº”è¯¥æ˜¯æŠŠé—®é¢˜è½¬åŒ–ä¸ºï¼šè¯æ˜è‹¥å¹²æ­£æ€åˆ†å¸ƒéšæœºå˜é‡å‡å€¼çš„æ–¹å·®æ¯”æ¯ä¸ªå•ç‹¬çš„éšæœºå˜é‡éƒ½è¦å°ã€‚ç„¶åå¤šç»´éšæœºå˜é‡ç§¯åˆ†å‡ºæ¥æ–¹å·®ã€‚ä½†æˆ‘æ‡’ğŸ¤“)<br />å‡è®¾æµ‹é‡æ˜¯ä¸€ä¸ªéšæœºè¯•éªŒï¼Œé‚£ä¹ˆå¤šæ¬¡æµ‹é‡ç»“æœæ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚ç”±æ­£æ€åˆ†å¸ƒçš„æ€§è´¨å¯çŸ¥ï¼Œç›¸äº’ç‹¬ç«‹çš„æ­£æ€åˆ†å¸ƒä¹‹å’Œä»ç„¶æ˜¯æ­£æ€åˆ†å¸ƒï¼Œäºæ˜¯æˆ‘ä»¬æœ‰<span class="math display">$$\begin{align}                                       \nonumber   Y=\sum{X_i}&amp;\sim(\sum{\mu_i},\sum{\sigma_i^2})\\         \nonumber   Y&amp;\sim(n\mu,n\sigma^2)\\                           \nonumber   \hat{X}=Y/n&amp;\sim(\mu,\frac{\sigma^2}{n})                  \end{align}                                     $$</span>ä¸éš¾çœ‹å‡ºï¼Œæ–¹å·®ä¸æ¬¡æ•°æˆåæ¯”ã€‚æ‰€ä»¥ï¼Œéšæµ‹é‡æ¬¡æ•°çš„å¢åŠ æ–¹å·®ä¼šå¿«é€Ÿä¸‹é™ã€‚å¦‚æœä½ è§‰å¾—ä¸å¤Ÿç›´è§‚çš„è¯ä¸å¦¨ç”¨æ¦‚ç‡æ¥æè¿°ï¼Œç”±åˆ‡æ¯”é›ªå¤«ä¸ç­‰å¼<span class="math display">$$P\{|X-E(X)| \geq \varepsilon\} \leq \frac{D(X)}{\varepsilon^{2}}$$</span> å¯çŸ¥ï¼Œäº‹ä»¶ â€œéšæœºå˜é‡ X å…³äºå…¶æœŸæœ›äº§ç”Ÿäº†åå·® Îµâ€å‘ç”Ÿçš„æ¦‚ç‡ä¸Šé™ä¸º <span class="math display">$$P=\frac{D(X)}{\varepsilon^{2}} = \frac{1}{n} \cdot\frac{\sigma^2}{\varepsilon^{2}}$$</span> å¯è§ï¼Œå‘ç”Ÿåå·®çš„æ¦‚ç‡çš„æ¦‚ç‡ä¸Šé™ä¹Ÿæ˜¯æˆåæ¯”ä¸‹é™çš„ã€‚ä¸å¦¨ä»¤ <spanclass="math inline"><em>n</em>â€„=â€„<em>k</em>/<em>Îµ</em><sup>2</sup></span>äºæ˜¯æœ‰ <span class="math display">$$P= \frac{\sigma^2}{k}$$</span> è¿™å°±æ˜¯è¯´ï¼Œå½“å®éªŒæ¬¡æ•°ä¸º <spanclass="math inline">$\frac{k}{Îµ^2}$</span> æ—¶ï¼Œéšæœºå˜é‡ Xå…³äºå…¶æœŸæœ›äº§ç”Ÿäº†åå·® Îµä¸º $ $</p><blockquote><p><em>(PS:è¿™éƒ¨åˆ†å…¨æ˜¯æ¦‚ç‡è®ºä¸æ•°ç†ç»Ÿè®¡è¯¾æœ¬ä¸Šçš„ä¸œè¥¿ï¼Œç”šè‡³æ²¡ä»»ä½•å½¢å¼å˜åŒ–ï¼Œå®Œå…¨å°±æ˜¯å®šä¹‰ã€‚è¿™è¦æ˜¯éƒ½çœ‹ç€åƒåŠ›çš„è¯ï¼Œå»ºè®®é‡ä¿®ã€‚)</em></p></blockquote><blockquote><p>ä»ç›´è§‚æ„Ÿè§‰ä¸Šæ¥è¯´çš„è¯ï¼Œæ¯æ¬¡æµ‹é‡éƒ½åŒ…å«äº†â€œä¿¡æ¯â€ã€‚æ¯ä¸€æ¬¡æ–°çš„æµ‹é‡éƒ½ä»£è¡¨äº†â€œæ–°æ¯â€çš„è¿›å…¥ï¼Œå¤šæ¬¡æµ‹é‡ä½¿å¾—ç³»ç»Ÿçš„ä¿¡æ¯å¢å¤šï¼Œä¸ç¡®å®šæ€§ä¸‹é™ï¼Œä»è€Œä½¿å¾—æ–°æ¯çš„ä¿¡æ¯ç†µé™ä½ã€‚åœ¨è¿™ä¸ªè§’åº¦ä¸Šå€’æ˜¯å¾ˆå®¹æ˜“ç†è§£ä¸ºä»€ä¹ˆå¤šæ¬¡æµ‹é‡çš„è¾¹é™…æ•ˆåº”ä¼šååˆ†æ˜¾è‘—äº†ã€‚</p></blockquote><h3 id="æ»¤æ³¢å™¨åˆä½“éªŒ">2 æ»¤æ³¢å™¨åˆä½“éªŒ</h3><h4 id="æ»¤æ³¢å™¨ä»¿çœŸ">2.1 æ»¤æ³¢å™¨ä»¿çœŸ</h4><p>å¯¹äºä¸€ä¸ªé™æ€ç³»ç»Ÿæ¥è¯´ï¼Œä¹Ÿæ²¡ä»€ä¹ˆèŠ±é‡Œèƒ¡å“¨çš„ç©æ³•ï¼Œæš´åŠ›æ±‚å¹³å‡å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### æ¨¡å‹å‚æ•° ###</span></span><br><span class="line"><span class="comment"># é‡‡æ ·å‚æ•°</span></span><br><span class="line">SampleFre = <span class="number">10</span></span><br><span class="line">TotalTime = <span class="number">10</span></span><br><span class="line">Step = <span class="number">1</span>/SampleFre</span><br><span class="line">SampleNum = SampleFre * TotalTime</span><br><span class="line"></span><br><span class="line"><span class="comment">#è§‚æµ‹åºåˆ—</span></span><br><span class="line">ActualValue = []        <span class="comment">#å®é™…å€¼</span></span><br><span class="line">MeasureValue = []       <span class="comment">#æµ‹é‡å€¼</span></span><br><span class="line">FilterValue = []        <span class="comment">#æ»¤æ³¢å€¼</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### ä»¿çœŸ ###</span></span><br><span class="line">x = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> x &lt; TotalTime:</span><br><span class="line">    temp = <span class="number">1</span>                                <span class="comment">#å®é™…å€¼</span></span><br><span class="line">    ActualValue.append(temp)</span><br><span class="line"></span><br><span class="line">    temp = np.random.normal(temp, <span class="number">1</span>)      <span class="comment">#æµ‹é‡å€¼ </span></span><br><span class="line">    MeasureValue.append(temp)</span><br><span class="line"></span><br><span class="line">    FilterValue.append(np.average(MeasureValue)) <span class="comment">#æ»¤æ³¢å€¼</span></span><br><span class="line"></span><br><span class="line">    x += Step</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### ç»˜å›¾å±•ç¤º ###</span></span><br><span class="line">plt.figure(figsize=figsize)</span><br><span class="line">plt.plot(ActualValue, <span class="string">&#x27;*-&#x27;</span>, label=<span class="string">&quot;Actual&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(MeasureValue, <span class="string">&#x27;o-&#x27;</span>, label=<span class="string">&quot;Measure&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(FilterValue, <span class="string">&#x27;.-&#x27;</span>, label=<span class="string">&quot;Filter&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;lower right&#x27;</span>) <span class="comment">#ç»˜åˆ¶å›¾ä¾‹</span></span><br></pre></td></tr></table></figure><pre><code>&lt;matplotlib.legend.Legend at 0x75e3610402c0&gt;</code></pre><figure><img src="pic/0_1.Hallo%20Filter_files/0_1.Hallo%20Filter_8_1.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><p>emmmmmm æ•ˆæœä¸é”™â€¦å§ï¼Ÿ<br />éšç€æ¬¡æ•°çš„å¢å¤šâ€æ„Ÿè§‰â€è¯¯å·®è¶Šæ¥è¶Šå°äº†ï¼Œä½†è¯¥æ€ä¹ˆç”¨æ•°å­¦è¯­è¨€æè¿°å‘¢ï¼Ÿ<br />&gt; 1.äº‹ç‰©çš„å¥½åã€å¤šå°‘ç­‰ç­‰ï¼Œéƒ½æ˜¯å®šæ€§åˆ†æï¼Œæ˜¯æœ‰æ½œåœ¨å‚è€ƒæ ‡å‡†çš„ï¼Œå•ç‹¬è®¨è®ºæ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚ä½œä¸ºå·¥ç¨‹å¸ˆï¼Œæˆ‘ä»¬éœ€è¦å°†å®šæ€§åˆ†æè½¬åŒ–ä¸ºå®šé‡åˆ†æï¼Œå…·ä½“çš„å»åˆ†ææŸç§äº‹ç‰©çš„æ€§èƒ½ã€‚<br />è®°å¾—é«˜ä¸­å­¦é›†åˆæ—¶è€å¸ˆä¸¾çš„ä¸€ä¸ªä¾‹å­ï¼šâ€œæŠŠæ‰€æœ‰é«˜ä¸ªå­çš„äººè®°ä½œä¸€ä¸ªé›†åˆâ€ï¼Œè¿™ç§è¯´æ³•æ˜¯é”™è¯¯çš„ã€‚å› ä¸ºé«˜æ˜¯ä¸€ä¸ªç›¸å¯¹è¯ï¼Œæ­£ç¡®çš„è¯´æ³•åº”è¯¥æ˜¯æ‰€æœ‰èº«é«˜å¤§äº180cm çš„äººè®°ä½œä¸€ä¸ªé›†åˆã€‚<br />&gt; 2.ä»»ä½•æ”¹è¿›éƒ½ä¸€å®šä¼šå¼•å…¥æ–°çš„ç¼ºç‚¹ï¼Œä½†å¾€å¾€æˆ‘ä»¬åªå…³æ³¨æŸä¸€æ–¹é¢çš„æ€§èƒ½ï¼Œåœ¨å¦ä¸€æ–¹é¢ä¸Šçš„ç¼ºç‚¹æ˜¯å¯ä»¥è¢«å¿½ç•¥çš„ã€‚æ‰€ä»¥åœ¨å·¥ç¨‹ä¸Šåƒä¸‡ä¸è¦æœ‰å¼ºè€…æ’å¼ºçš„æƒ³æ³•ï¼Œè€Œæ˜¯è¦æ ¹æ®æƒ…å†µå…·ä½“åˆ†æåé€‰æ‹©æœ€ä¼˜çš„è§£æ³•ã€‚</p><h4 id="æ»¤æ³¢å™¨æ€§èƒ½çš„åˆ†æ">2.2 æ»¤æ³¢å™¨æ€§èƒ½çš„åˆ†æ</h4>å†å›åˆ°æ¦‚ç‡è®ºçš„å†…å®¹ï¼Œæœ‰è¿™ä¹ˆä¸€ä¸ªé‡ï¼Œå®ƒå¯ä»¥æè¿°ä¸¤ä¸ªå…·æœ‰ç›¸ç­‰æœŸæœ›äº‹ä»¶çš„ç¨³å®šæ€§ï¼Œä»–å°±æ˜¯â€”â€”â€”â€”<del>äºŒé˜¶ä¸­å¿ƒè·</del>ï¼Œäººè¯ï¼šæ–¹å·®ã€‚&gt; 1) ç”¨åå·®æ¥æè¿°ï¼š<spanclass="math inline"><em>X</em>â€…âˆ’â€…<em>E</em>(<em>X</em>)</span> â€”â€“&gt;åå·®å­˜åœ¨æ­£è´Ÿ &gt; 2) æ¶ˆå»ç¬¦å·ï¼š<spanclass="math inline">|<em>X</em>âˆ’<em>E</em>(<em>X</em>)|</span>â€”(ä½¿å…¶ä¾¿äºæ•°å­¦å¤„ç†)â€”&gt; <spanclass="math inline">(<em>X</em>âˆ’<em>E</em>(<em>X</em>))<sup>2</sup></span>&gt; 3) æ³¨æ„åˆ°å¤„ç†åä»æ˜¯éšæœºå˜é‡è€Œéæ•°å­—ç‰¹å¾ï¼Œäºæ˜¯ <spanclass="math inline"><em>E</em>[(<em>X</em>âˆ’<em>E</em>(<em>X</em>))<sup>2</sup>]</span>ï¼Œç§°å…¶ä¸ºæ–¹å·®ã€‚&gt; 4)åœ¨å·¥ç¨‹ä¸Šï¼Œæ–¹å·®çš„é‡çº²ä¸ºéšæœºå˜é‡é‡çº²çš„å¹³æ–¹ï¼Œä¸ä¾¿äºä½¿ç”¨ï¼Œä¹ æƒ¯ä¸Šå–å…¶ç®—æ•°å¹³æ–¹æ ¹ï¼Œç§°ä¸ºæ ‡å‡†å·®æˆ–å‡æ–¹å·®ã€‚&gt;<p align="right">â€”â€”â€”â€”ã€Šèªå“‹è–®æ•©æ¯£æ±œã€‹æ²ƒÂ·å…¹åŸºè°¢å¾·</p><p>ä¸Šé¢å·²ç»è¯´è¿‡äº†ï¼Œå–å¹³æ–¹çš„æ„ä¹‰åªæ˜¯ä¸ºäº†ä¾¿äºæ•°å­¦å¤„ç†è€Œå·²ã€‚æ¯•ç«Ÿ abs(x)ä¸æ˜¯ä¸€ä¸ªåˆç­‰å‡½æ•°ï¼Œä½† <span class="math inline">$\sqrt{x^2}$</span>å´æ˜¯åˆç­‰å‡½æ•°ã€‚åœ¨åº”ç”¨ä¸­ç›´æ¥ç”¨åå·®çš„ç»å¯¹å€¼æ¥æè¿°å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#è§‚æµ‹åºåˆ—</span></span><br><span class="line">ActualValue = []        <span class="comment">#å®é™…å€¼</span></span><br><span class="line">MeasureValue = []       <span class="comment">#æµ‹é‡å€¼</span></span><br><span class="line">err0 = []                <span class="comment">#è¯¯å·®</span></span><br><span class="line">err1 = []                <span class="comment">#è¯¯å·®</span></span><br><span class="line">std0 = []                <span class="comment">#æ ‡å‡†å·®</span></span><br><span class="line">std1 = []                <span class="comment">#æ ‡å‡†å·®</span></span><br><span class="line">FilterValue = []        <span class="comment">#æ»¤æ³¢å€¼</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### ä»¿çœŸ ###</span></span><br><span class="line">x = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> x &lt; TotalTime:</span><br><span class="line">    trueValue = <span class="number">1</span></span><br><span class="line">    ActualValue.append(trueValue)</span><br><span class="line"></span><br><span class="line">    temp = np.random.normal(trueValue, <span class="number">10</span>)      <span class="comment">#æµ‹é‡å€¼ </span></span><br><span class="line">    MeasureValue.append(temp)</span><br><span class="line">    err0.append(np.<span class="built_in">abs</span>(temp - trueValue))   <span class="comment">#è¯¯å·®</span></span><br><span class="line"></span><br><span class="line">    temp = np.average(MeasureValue)         <span class="comment">#æ»¤æ³¢å€¼</span></span><br><span class="line">    FilterValue.append(temp)</span><br><span class="line">    std0.append(np.std(MeasureValue)/np.sqrt(np.size(MeasureValue)) * stats.t.isf(<span class="number">0.025</span>, np.size(err0)))<span class="comment"># 95%ç½®ä¿¡åŒºé—´</span></span><br><span class="line"></span><br><span class="line">    err1.append(np.<span class="built_in">abs</span>(temp - ActualValue[-<span class="number">1</span>]))   <span class="comment">#è¯¯å·®</span></span><br><span class="line">    std1.append(np.std(MeasureValue)/np.sqrt(np.size(MeasureValue)) * stats.t.isf(<span class="number">0.025</span>, np.size(err1)))<span class="comment"># 95%ç½®ä¿¡åŒºé—´</span></span><br><span class="line"></span><br><span class="line">    x += Step</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### ç»˜å›¾å±•ç¤º ###</span></span><br><span class="line">plt.figure(figsize=figsize)</span><br><span class="line">plt.plot(ActualValue, <span class="string">&#x27;*-&#x27;</span>, label=<span class="string">&quot;Actual&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.plot(MeasureValue, <span class="string">&#x27;o-&#x27;</span>, label=<span class="string">&quot;Measure&quot;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.errorbar(<span class="built_in">range</span>(<span class="number">0</span>, np.size(FilterValue)), FilterValue, yerr=std0, label=<span class="string">&quot;Filter&quot;</span>, fmt=<span class="string">&#x27;.-&#x27;</span>, capthick=<span class="number">2</span>, capsize=<span class="number">10</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;lower right&#x27;</span>) <span class="comment">#ç»˜åˆ¶å›¾ä¾‹</span></span><br><span class="line"></span><br><span class="line">plt.figure(figsize=figsize)</span><br><span class="line">plt.plot(err0, <span class="string">&#x27;*-&#x27;</span>, label=<span class="string">&quot;Measure Error&quot;</span>)</span><br><span class="line">plt.errorbar(<span class="built_in">range</span>(<span class="number">0</span>, np.size(err1)), err1, yerr=std1, label=<span class="string">&quot;Filter Error&quot;</span>, fmt=<span class="string">&#x27;.-&#x27;</span>, capthick=<span class="number">2</span>, capsize=<span class="number">10</span>)</span><br><span class="line">plt.plot([<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, np.size(err1))], <span class="string">&#x27;-&#x27;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;lower right&#x27;</span>) <span class="comment">#ç»˜åˆ¶å›¾ä¾‹</span></span><br></pre></td></tr></table></figure><pre><code>&lt;matplotlib.legend.Legend at 0x75e3603e63f0&gt;</code></pre><figure><img src="pic/0_1.Hallo%20Filter_files/0_1.Hallo%20Filter_11_1.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><figure><img src="pic/0_1.Hallo%20Filter_files/0_1.Hallo%20Filter_11_2.png"alt="png" /><figcaption aria-hidden="true">png</figcaption></figure><p>å¤šè¿è¡Œå‡ æ¬¡åï¼Œå¤§è‡´å¯ä»¥æ€»ç»“æˆï¼š<br />- å‰æœŸä¸€èˆ¬æ”¶æ•›è¾ƒå¿«ã€‚ - è¯¯å·®çš„ç»å¯¹å€¼å¹¶ä¸æ€»æ˜¯ä¸€ç›´å‡å°çš„ã€‚</p><h4 id="é€’æ¨å½¢å¼">2.3 é€’æ¨å½¢å¼</h4><p><span class="math display">$$\begin{align}    \nonumber   \bar{x} &amp; = \frac{\sum_{i=1}^{n}{x_i}}{n}\\    \nonumber   \bar{x} &amp; =\frac{\sum_{i=1}^{n-1}{x_i}}{n-1} \cdot\frac{n-1}{n} + \frac{x_n}{n}\\    \nonumber   \bar{x} &amp; = \frac{\bar{x}_{last} \cdot (n-1) +x_n}{n}\\    \nonumber   \bar{x} &amp; = \bar{x}_{last} +\frac{1}{n}(x_n-\bar{x}_{last})\end{align}$$</span> ä¸Šè¿°å½¢å¼çš„åœ¨åº”ç”¨ä¸­çš„ä¼˜ç‚¹ä¸»è¦æ˜¯:</p><ul><li>ä¸éœ€è¦å‚¨å­˜å…¨éƒ¨çš„æµ‹é‡å€¼ï¼Œåªéœ€è¦ä¿å­˜å½“å‰æ¬¡æ•°ä¸å¹³å‡å€¼å³å¯(int +float)ã€‚</li><li>è®¡ç®—æ¬¡æ•°å°‘ï¼Œæœ€åçš„å½¢å¼åªéœ€è®¡ç®—ä¸¤æ¬¡åŠ æ³•ä¸ä¸€ä¸ªé™¤æ³•ã€‚</li></ul><p>å½“ç„¶ï¼Œå‰æ–‡æåˆ°è¿‡ä»»ä½•æ”¹è¿›éƒ½å°†å¼•å…¥æ–°çš„ç¼ºç‚¹ï¼š -è®¡ç®—æœºçš„floatç±»å‹æ˜¯ä¸å¯é çš„ï¼Œæ¯æ¬¡è¿­ä»£éƒ½ä¼šå¸¦æ¥è¯¯å·®ã€‚ -ä¸æœ€å¼€å§‹å°å­¦ç”Ÿéƒ½ä¼šçš„å½¢å¼ç›¸æ¯”é€’æ¨å½¢å¼æ›´éš¾äº†ä¸€äº›ã€‚(å•¥ï¼Ÿä½ è¯´è¿™ç‚¹éš¾åº¦ä¹Ÿç®—ç¼ºç‚¹ï¼Ÿè®°ä½è¿™ä¸ªå½¢å¼ï¼Œä»¥åä½ è¿˜ä¼šè§åˆ°ä»–çš„ğŸ¤­)</p><p>è®©æˆ‘é€‰æ‹©çš„è¯ï¼Œå¤§æ¦‚ç»å¤§å¤šæ•°æƒ…å†µæˆ‘éƒ½ä¼šé€‰æ‹©é€’æ¨å½¢å¼ã€‚å› ä¸ºåœ¨ä½¿ç”¨ç´¯è®¡å¹³å‡æ»¤æ³¢å™¨æ—¶ï¼Œå…¶ç›®çš„å°±æ˜¯æµ‹é‡ä¸€ä¸ªé™æ€æ•°å€¼ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ä¸ä¼˜ç‚¹ç›¸æ¯”è¾ƒï¼Œå…¶ç¼ºç‚¹å‡ ä¹æ˜¯å¯ä»¥å¿½ç•¥çš„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> è´å¶æ–¯æ»¤æ³¢å™¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ»¤æ³¢å™¨ </tag>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python ç¯å¢ƒç®¡ç†</title>
      <link href="/2025/09/01/python%E7%8E%AF%E5%A2%83%E7%AE%A1%E7%90%86/"/>
      <url>/2025/09/01/python%E7%8E%AF%E5%A2%83%E7%AE%A1%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="python-å¤šç¯å¢ƒå®‰è£…">1. python å¤šç¯å¢ƒå®‰è£…</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt update</span><br><span class="line"><span class="built_in">sudo</span> apt install software-properties-common<span class="comment"># å¿…è¦çš„æ”¯æŒåŒ…</span></span><br><span class="line"><span class="built_in">sudo</span> add-apt-repository ppa:deadsnakes/ppa<span class="comment"># Deadsnakes PPAï¼ˆä¸€ä¸ªéå¸¸å¥½ç”¨çš„ç¬¬ä¸‰æ–¹è½¯ä»¶æºï¼‰</span></span><br><span class="line"><span class="built_in">sudo</span> apt update</span><br><span class="line"><span class="built_in">sudo</span> apt install python3.11<span class="comment"># å®‰è£…æŒ‡å®šç‰ˆæœ¬è§£é‡Šå™¨</span></span><br></pre></td></tr></table></figure><h2 id="venv-è™šæ‹Ÿç¯å¢ƒ">2. venv è™šæ‹Ÿç¯å¢ƒ</h2><p>venv æ˜¯ python3è‡ªå¸¦è™šæ‹Ÿç¯å¢ƒåŒ…ã€‚ä½¿ç”¨ååˆ†ç®€å•ï¼Œä½†æ˜¯ç¼ºå°‘ä¸€äº›è¾ƒä¸ºå¤æ‚çš„åŠŸèƒ½æ”¯æŒã€‚ï¼ˆå¦‚ä½¿ç”¨å…¨å±€ç¯å¢ƒä¸å­˜åœ¨çš„è§£é‡Šå™¨åˆå§‹åŒ–è™šæ‹Ÿç¯å¢ƒï¼‰### 2.1 è™šæ‹Ÿç¯å¢ƒçš„åˆ›å»º <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m venv .venv</span><br></pre></td></tr></table></figure></p><h3 id="è™šæ‹Ÿç¯å¢ƒçš„æ¿€æ´»">2.2 è™šæ‹Ÿç¯å¢ƒçš„æ¿€æ´»</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> .venv/bin/activate</span><br></pre></td></tr></table></figure><table><tr><th colspan="3">è™šæ‹Ÿç¯å¢ƒæ¿€æ´»æŒ‡ä»¤</th></tr ><tr><td>å¹³å°</td><td>Shell</td><td>ç”¨äºæ¿€æ´»è™šæ‹Ÿç¯å¢ƒçš„å‘½ä»¤</td></tr ><tr><td rowspan="5">POSIX</td></tr><tr><td>bash/zsh</td><td>source .venv/bin/activate</td></tr><tr><td>csh/tcsh</td><td>source .venv/bin/activate.fish</td></tr><tr><td>pwsh</td><td>source .venv/bin/activate.csh</td></tr><tr><td>bash/zsh</td><td>.venv/bin/Activate.ps1</td></tr><tr><td rowspan="3">Windows</td></tr><tr><td>cmd</td><td>.venv.bat</td></tr><tr><td>PowerShell</td><td>.venv.ps1</td></tr></table><h3 id="è™šæ‹Ÿç¯å¢ƒçš„é€€å‡º">2.3 è™šæ‹Ÿç¯å¢ƒçš„é€€å‡º</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deactivate</span><br></pre></td></tr></table></figure><h3 id="å®‰è£…ä¾èµ–å¯é€‰">2.4 å®‰è£…ä¾èµ–(å¯é€‰)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -r requirements.txt</span><br></pre></td></tr></table></figure><h2 id="virtualenv-è™šæ‹Ÿç¯å¢ƒ">3. virtualenv è™šæ‹Ÿç¯å¢ƒ</h2><h3 id="å®‰è£…">å®‰è£…</h3><p>å®‰è£…åˆ°å…¨å±€ç¯å¢ƒä¸­ <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install virtualenv --break-system-packages</span><br></pre></td></tr></table></figure></p><h3 id="å…¶ä»–æ“ä½œ">å…¶ä»–æ“ä½œ</h3><p>ä¸ venv ç±»ä¼¼è¿™é‡Œä¸å†èµ˜è¿°ã€‚è¿™é‡Œè¯´ä¸€ä¸‹ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬è§£é‡Šå™¨åˆå§‹åŒ–è™šæ‹Ÿç¯å¢ƒ<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">virtualenv .venv -p python3.11</span><br></pre></td></tr></table></figure></p><h3 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h3><blockquote><p>https://docs.python.org/zh-cn/3.12/library/venv.html</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> venv </tag>
            
            <tag> è™šæ‹Ÿç¯å¢ƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è™šæ‹Ÿç£ç›˜åˆ›å»ºä¸æŒ‚è½½</title>
      <link href="/2025/08/31/%E8%99%9A%E6%8B%9F%E7%A3%81%E7%9B%98%E5%88%B6%E4%BD%9C/"/>
      <url>/2025/08/31/%E8%99%9A%E6%8B%9F%E7%A3%81%E7%9B%98%E5%88%B6%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<h4 id="ç¯å¢ƒwsl-ubuntu-24.04-lts"><strong><em>ç¯å¢ƒï¼šWSL-Ubuntu 24.04LTS</em></strong></h4><h2 id="åˆ›å»ºç©ºæ–‡ä»¶">1. åˆ›å»ºç©ºæ–‡ä»¶</h2><p>æ‰§è¡Œä¸‹è¿°å‘½ä»¤å°†åœ¨å·¥ä½œç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªå¤§å°ä¸º SIZE[Mb] ç©ºæ–‡ä»¶<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=/dev/zero of=&lt;filename&gt; bs=1024 count=SIZE</span><br></pre></td></tr></table></figure></p><h2 id="æ ¼å¼åŒ–æ˜ åƒæ–‡ä»¶">2. æ ¼å¼åŒ–æ˜ åƒæ–‡ä»¶</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install dosfstools <span class="comment">#å®‰è£… fat çš„æ ¼å¼åŒ–å·¥å…·</span></span><br><span class="line">mkfs.vfat &lt;filename&gt; <span class="comment">#æ ¼å¼åŒ–è¯¥æ–‡ä»¶ä¸º fat æ–‡ä»¶ç³»ç»Ÿ</span></span><br><span class="line">mount -o loop &lt;filename&gt; /mnt <span class="comment">#æŒ‚è½½æ–‡ä»¶</span></span><br></pre></td></tr></table></figure><p>å¦‚æœå‡ºç°ç±»ä¼¼é”™è¯¯ï¼š mount: /mnt/sdcard/: failed to setup loop devicefor /home/reglucis/project/YueShell/Middleware/VirtualFlash/sdcard.vfs.è®°å¾— sudoâ€¦â€¦ğŸ˜“</p><h2 id="ä½¿ç”¨">3. ä½¿ç”¨</h2><p>ç°åœ¨åº”è¯¥å°±å¯ä»¥åœ¨ /mnt æ–‡ä»¶å¤¹è®¿é—®è¿™ä¸€è™šæ‹Ÿç£ç›˜äº†ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ windowsçš„æ–‡ä»¶èµ„æºç®¡ç†å™¨è®¿é—®ã€‚ ä»£ç å±‚é¢åˆ™å¯ä»¥ä½¿ç”¨ virtualDisk + FatFsæ¥è®¿é—®è¯¥ç£ç›˜ã€‚ ç±»ä¼¼çš„ï¼Œä¹Ÿå¯ä»¥å°†å…¶ä»–æ–‡ä»¶ç³»ç»Ÿæ˜ åƒä¼ è¾“è‡³æœ¬åœ°è®¡ç®—æœºæ¥åŠ è½½ã€‚&gt; æœ‰äº†è¿™ä¸€é¡¹æŠ€æœ¯ï¼Œå¼€å‘è°ƒè¯•æ–‡ä»¶ç³»ç»Ÿç®€å•æ–¹ä¾¿äº†ä¸å°‘ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> è™šæ‹Ÿç£ç›˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FileSystem </tag>
            
            <tag> FatFs </tag>
            
            <tag> WSL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo æ–°å»ºæ–‡ç« </title>
      <link href="/2025/08/30/Hexo%E6%96%B0%E5%BB%BA%E6%96%87%E7%AB%A0/"/>
      <url>/2025/08/30/Hexo%E6%96%B0%E5%BB%BA%E6%96%87%E7%AB%A0/</url>
      
        <content type="html"><![CDATA[<h2 id="å‡†å¤‡å·¥ä½œ">å‡†å¤‡å·¥ä½œ</h2><h3 id="åˆ›å»ºåˆ†ç±»é€‰é¡¹">åˆ›å»ºâ€œåˆ†ç±»â€é€‰é¡¹</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page categories</span><br></pre></td></tr></table></figure><p>æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶ä¿®æ”¹ <figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: æ–‡ç« åˆ†ç±»</span><br><span class="line"><span class="section">date: 2017-05-27 13:47:40</span></span><br><span class="line"><span class="section">---</span></span><br><span class="line"></span><br><span class="line">&lt;ä¿®æ”¹ä¸º&gt;</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">title: æ–‡ç« åˆ†ç±»</span><br><span class="line">date: 2017-05-27 13:47:40</span><br><span class="line"><span class="section">type: &quot;categories&quot;</span></span><br><span class="line"><span class="section">---</span></span><br></pre></td></tr></table></figure></p><h3 id="åˆ›å»ºæ ‡ç­¾é€‰é¡¹">åˆ›å»ºâ€œæ ‡ç­¾â€é€‰é¡¹</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page tags</span><br></pre></td></tr></table></figure><p>æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶ä¿®æ”¹ <figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: tags</span><br><span class="line"><span class="section">date: 2025-08-30 22:39:50</span></span><br><span class="line"><span class="section">---</span></span><br><span class="line"></span><br><span class="line">&lt;ä¿®æ”¹ä¸º&gt;</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">title: tags</span><br><span class="line">date: 2025-08-30 22:39:50</span><br><span class="line"><span class="section">type: &quot;tags&quot;</span></span><br><span class="line"><span class="section">---</span></span><br></pre></td></tr></table></figure></p><h2 id="å¼€å§‹-hero-çš„ç¬¬ä¸€ç¯‡æ–‡ç« ">å¼€å§‹ Hero çš„ç¬¬ä¸€ç¯‡æ–‡ç« </h2><h3 id="æ–°å»ºæ–‡ç« ">æ–°å»ºæ–‡ç« </h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new <span class="string">&quot;æ ‡é¢˜&quot;</span></span><br></pre></td></tr></table></figure><p>æ‰“å¼€æ–‡ä»¶åå¯ä»¥å…ˆçœ‹åˆ°å¦‚ä¸‹å†…å®¹ &gt; title: æ ‡é¢˜ &gt; date: 2025-08-3022:06:13 &gt; tags:</p><h3 id="æ·»åŠ åˆ†ç±»">æ·»åŠ åˆ†ç±»</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">categories: </span><br><span class="line"><span class="bullet">-</span> aaaa</span><br></pre></td></tr></table></figure><h3 id="æ·»åŠ æ ‡ç­¾">æ·»åŠ æ ‡ç­¾</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tags: </span><br><span class="line"><span class="bullet">-</span> aaaa</span><br><span class="line"><span class="bullet">-</span> bbbb</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Github_page + Hexo å»ºç«‹ä¸ªäººåšå®¢</title>
      <link href="/2025/08/30/%E5%BB%BA%E7%AB%99/"/>
      <url>/2025/08/30/%E5%BB%BA%E7%AB%99/</url>
      
        <content type="html"><![CDATA[<h2 id="github-page-ç›¸å…³é…ç½®">1. Github page ç›¸å…³é…ç½®</h2><p>è¯¦è§ github æ–‡æ¡£ &gt; https://docs.github.com/en/pages/quickstart</p><h2 id="å®‰è£…-node.js">2. å®‰è£… Node.js</h2><p><em>ç¯å¢ƒï¼šWSL-Ubuntu 24.04 LTS</em> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£… nvm #</span></span><br><span class="line"><span class="built_in">sudo</span> apt-get install curl</span><br><span class="line">curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/master/install.sh | bash</span><br><span class="line"><span class="comment">## (é‡å¯)</span></span><br><span class="line"><span class="comment"># å®‰è£… Node.js LTS ç‰ˆæœ¬ #</span></span><br><span class="line">nvm install --lts</span><br><span class="line">node --version<span class="comment">## éªŒè¯ node </span></span><br><span class="line">npm version<span class="comment">## éªŒè¯ npm </span></span><br></pre></td></tr></table></figure> &gt;https://learn.microsoft.com/zh-cn/windows/dev-environment/javascript/nodejs-on-wsl</p><h2 id="éƒ¨ç½²-hexo-åŠå…¶æ’ä»¶">3. éƒ¨ç½² Hexo åŠå…¶æ’ä»¶</h2><h3 id="å®‰è£…-hexo">3.1 å®‰è£… Hexo</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-cli -g</span><br><span class="line">hexo version<span class="comment">## éªŒè¯</span></span><br></pre></td></tr></table></figure><h3 id="åˆå§‹åŒ–-hexo-ä»“åº“åŠå®‰è£…æ’ä»¶">3.2 åˆå§‹åŒ– Hexo ä»“åº“åŠå®‰è£…æ’ä»¶</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hexo init &lt;your-folder-name&gt;<span class="comment"># å°†æ–‡ä»¶å¤¹åæ›¿æ¢ä¸ºä½ çš„ï¼Œä¾‹å¦‚ hexo init reglucis.github.io</span></span><br><span class="line"><span class="built_in">cd</span> &lt;your-folder-name&gt;</span><br><span class="line">npm install</span><br><span class="line">npm install hexo-deployer-git save<span class="comment"># å®‰è£…æ’ä»¶ hexo-deployer-git (ä½¿ç”¨ GitHub Pages åŠŸèƒ½éœ€è¦)</span></span><br></pre></td></tr></table></figure><p>å®‰è£…å¥½åå¯åœ¨æœ¬åœ°å¯åŠ¨æœåŠ¡å™¨ï¼Œé¢„è§ˆç½‘ç«™ <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo server -o</span><br></pre></td></tr></table></figure>å‡ºç°ä¸‹è¿°çŠ¶æ€å³ä¸ºæˆåŠŸã€‚ <img src="pic/PixPin_2025-08-30_20-05-18.png"alt="å›¾ç‰‡" /></p><h2 id="è®¾ç½®éƒ¨ç½²ä»“åº“å’Œåˆ†æ”¯">4. è®¾ç½®éƒ¨ç½²ä»“åº“å’Œåˆ†æ”¯</h2><p>æ‰“å¼€ä»“åº“æ ¹ç›®å½•çš„ _config.yml <figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/one-command-deployment</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ï¼ˆä¿®æ”¹ä¸ºï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="comment"># rebo å¡«å†™ä½ è‡ªå·±ä»“åº“çš„ ssh è¿æ¥</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">git@github.com:Reglucis/Reglucis.github.io.git</span></span><br><span class="line">  <span class="comment"># branch è¦ä¸ä½ åœ¨ä»“åº“è®¾ç½®é¡µæŒ‡å®šçš„åˆ†æ”¯ç›¸åŒ</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">main</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></p><h2 id="ç”Ÿæˆé™æ€ç½‘é¡µå¹¶å‘å¸ƒ">4. ç”Ÿæˆé™æ€ç½‘é¡µå¹¶å‘å¸ƒ</h2><p>ç”Ÿæˆé™æ€ç½‘é¡µæ–‡ä»¶ <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo generate</span><br></pre></td></tr></table></figure> <em>ç”Ÿæˆåï¼Œé™æ€ç½‘é¡µä¿å­˜åœ¨ publicæ–‡ä»¶å¤¹ä¸­.</em> æ¨é€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo deploy</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Github </tag>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
